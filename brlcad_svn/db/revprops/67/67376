K 10
svn:author
V 10
starseeker
K 8
svn:date
V 27
2016-03-18T18:06:09.911124Z
K 7
svn:log
V 906
need second opinion on this, but it looks like two flaws in the bu_file_delete pipeline.  First one is in the check for the remove return code - 0 is returned when the file is successfully deleted, and -1 on error according to the man page.  If the while loop is looking for ret == 0 to continue trying to delete, ret should be set to 1 after a successful remove in order to exit the loop.  The second issue appears to be in bu_file_exists - if fd is passed in to be assigned, the return code is *always* successful (1) even if open is in fact trying to open a file that does not exist (fd ends up getting -1, but bu_file_exists returns 1 - implying the file is there.)  Instead, do the fd set if it is requested and continue on to the actual 'does it exist on the filesystem' test without returning 1 - that way fd is set according to open *and* the return code correctly reflects whether the file exists.
END
