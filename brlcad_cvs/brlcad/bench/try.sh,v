head	14.8;
access;
symbols
	rel-7-10-4:14.8
	STABLE:14.8.0.2
	stable-branch:14.4
	rel-7-10-2:14.8
	rel-7-10-0:14.8
	rel-7-8-4:14.7
	rel-7-8-2:14.7
	rel-7-8-0:14.7
	trimnurbs-branch:14.7.0.2
	help:14.7
	temp_tag:14.6
	bobWinPort-20051223-freeze:14.5
	postmerge-20051223-bobWinPort:14.6
	premerge-20051223-bobWinPort:14.6
	rel-7-6-6:14.6
	rel-7-6-4:14.6
	rel-7-6-2:14.5
	rel-7-6-branch:14.5.0.4
	rel-7-6-0:14.5
	rel-7-4-2:14.4.2.1
	rel-7-4-branch:14.4.0.2
	bobWinPort:14.5.0.2
	rel-7-4-0:14.4
	rel-7-2-6:14.4
	rel-7-2-4:14.4
	rel-7-2-2:14.4
	rel-7-2-0:14.4
	rel-7-0-4:14.2
	rel-7-0-2:14.2
	rel-7-0-1:14.2
	opensource-post:14.2
	opensource-pre:1.9
	rel-7-0-branch:1.9.0.2
	rel-7-0:1.9
	ansi-20040405-merged:1.7
	postmerge-20040405-ansi:1.7
	premerge-20040404-ansi:1.7
	postmerge-autoconf:1.7
	autoconf-freeze:1.7
	premerge-autoconf:1.7
	ansi-20040316-freeze:1.7
	postmerge-20040315-windows:1.7
	premerge-20040315-windows:1.7
	windows-20040315-freeze:1.7
	autoconf-20031203:1.7
	autoconf-20031202:1.7
	autoconf-branch:1.7.0.14
	phong-branch:1.7.0.12
	photonmap-branch:1.7.0.10
	rel-6-1-DP:1.7
	windows-branch:1.7.0.8
	rel-6-0-2:1.7
	ansi-branch:1.7.0.6
	rel-6-0-1-branch:1.7.0.4
	hartley-6-0-post:1.7
	hartley-6-0-pre:1.7
	rel-6-0-1:1.7
	rel-6-0:1.7
	rel-5-4:1.7
	offsite-5-3-pre:1.7
	rel-5-3:1.7
	rel-5-2:1.7
	rel-5-1-branch:1.7.0.2
	rel-5-1:1.7
	rel-5-0:1.7
	rel-5-0-beta:1.7
	rel-4-5:1.5
	ctj-4-5-post:1.5
	ctj-4-5-pre:1.5
	rel-4-4:1.4
	rel-4-0:1.3
	rel-3-5:1.3
	rel-3-0:1.1;
locks; strict;
comment	@# @;


14.8
date	2007.01.20.14.36.40;	author brlcad;	state Exp;
branches;
next	14.7;

14.7
date	2006.01.18.06.46.10;	author brlcad;	state Exp;
branches;
next	14.6;

14.6
date	2005.10.23.04.24.41;	author brlcad;	state Exp;
branches;
next	14.5;

14.5
date	2005.07.16.23.31.30;	author brlcad;	state Exp;
branches
	14.5.4.1;
next	14.4;

14.4
date	2005.02.21.18.04.09;	author brlcad;	state Exp;
branches
	14.4.2.1;
next	14.3;

14.3
date	2005.01.30.20.30.09;	author brlcad;	state Exp;
branches;
next	14.2;

14.2
date	2004.12.17.21.16.11;	author morrison;	state Exp;
branches;
next	14.1;

14.1
date	2004.11.16.19.42.08;	author morrison;	state Exp;
branches;
next	1.9;

1.9
date	2004.08.02.15.49.23;	author morrison;	state Exp;
branches;
next	1.8;

1.8
date	2004.06.21.19.44.24;	author morrison;	state Exp;
branches;
next	1.7;

1.7
date	99.05.20.05.19.22;	author mike;	state Exp;
branches;
next	1.6;

1.6
date	98.12.31.08.15.18;	author morrison;	state Exp;
branches;
next	1.5;

1.5
date	97.01.08.01.02.45;	author mike;	state Exp;
branches;
next	1.4;

1.4
date	94.09.22.04.03.08;	author mike;	state Exp;
branches;
next	1.3;

1.3
date	89.04.29.02.55.09;	author mike;	state Exp;
branches;
next	1.2;

1.2
date	89.04.29.02.51.49;	author mike;	state Exp;
branches;
next	1.1;

1.1
date	88.10.01.06.57.52;	author mike;	state Exp;
branches;
next	;

14.4.2.1
date	2005.08.16.21.03.44;	author brlcad;	state Exp;
branches;
next	;

14.5.4.1
date	2005.11.13.13.46.08;	author brlcad;	state Exp;
branches;
next	;


desc
@Version of benchmark script that sends image to current framebuffer
@


14.8
log
@update copyright to 2007
@
text
@#!/bin/sh
#                          T R Y . S H
# BRL-CAD
#
# Copyright (c) 2004-2007 United States Government as represented by
# the U.S. Army Research Laboratory.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the above copyright
# notice, this list of conditions and the following disclaimer.
#
# 2. Redistributions in binary form must reproduce the above
# copyright notice, this list of conditions and the following
# disclaimer in the documentation and/or other materials provided
# with the distribution.
#
# 3. The name of the author may not be used to endorse or promote
# products derived from this software without specific prior written
# permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
# OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
# NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
###
# A Shell script to run the BRL-CAD Benchmark, with output going to
# a framebuffer rather than to a file.
#
# Authors -
#  Mike Muuss
#  Christopher Sean Morrison
#
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.7 2006/01/18 06:46:10 brlcad Exp $ (BRL)

# Ensure /bin/sh
export PATH || (echo "This isn't sh."; sh $0 $*; kill $$)
path_to_this=`dirname $0`

# force locale setting to C so things like date output as expected
LC_ALL=C

TIMEFRAME=1 ; export TIMEFRAME
MAXTIME=1 ; export MAXTIME

ARGS="-F/dev/Xl $*"

if test -f "$path_to_this/run.sh"  ; then
    $path_to_this/run.sh $ARGS
elif test -f "$path_to_this/benchmark"  ; then
    $path_to_this/benchmark $ARGS
elif test -f "/usr/brlcad/bin/benchmark"  ; then
    /usr/brlcad/bin/benchmark $ARGS
fi


# Local Variables:
# mode: sh
# tab-width: 8
# sh-indentation: 4
# sh-basic-offset: 4
# indent-tabs-mode: t
# End:
# ex: shiftwidth=4 tabstop=8
@


14.7
log
@update copyright to 2006
@
text
@d5 1
a5 1
# Copyright (c) 2004-2006 United States Government as represented by
d44 1
a44 1
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.6 2005/10/23 04:24:41 brlcad Exp $ (BRL)
@


14.6
log
@trailing ws
@
text
@d5 1
a5 1
# Copyright (C) 2004-2005 United States Government as represented by
d44 1
a44 1
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.5 2005/07/16 23:31:30 brlcad Exp $ (BRL)
@


14.5
log
@completely rewrite try.sh so that it basically calls the main run.sh script with the X framebuffer option, making sure that only one frame per test is displayed.
@
text
@d15 1
a15 1
# 2. Redistributions in binary form must reproduce the above 
d44 1
a44 1
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.4 2005/02/21 18:04:09 brlcad Exp $ (BRL)
@


14.5.4.1
log
@merge changes from HEAD aka rel-7-6-4 to the rel-7-6-branch just in case someone peeks a gander or tries to continue/build the branch
@
text
@d15 1
a15 1
# 2. Redistributions in binary form must reproduce the above
d44 1
a44 1
#  @@(#)$Header$ (BRL)
@


14.4
log
@force locale setting to C so things like date output as expected
@
text
@d37 8
a44 3
# A Shell script to run the BRL-CAD Benchmark Test,
# with output going to the current framebuffer, rather than a file.
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.3 2005/01/30 20:30:09 brlcad Exp $ (BRL)
d48 1
a48 1
path_to_run_sh=`dirname $0`
d53 2
a54 2
# sets MACHINE, UNIXTYPE, HAS_TCP
eval `machinetype.sh -b 2> /dev/null`	
d56 1
a56 70
if test "x$MACHINE" = "x" ; then
  echo Looking for machinetype.sh...
  eval `$path_to_run_sh/../sh/machinetype.sh -b 2> /dev/null`
  if test "x$MACHINE" = "x" ; then
    echo WARNING: could not find machinetype.sh
    # try _something_, linux is pretty popular
    MACHINE="li"
  else
    echo ...found local machinetype.sh
  fi
fi

echo Looking for RT...
# find the raytracer
# RT environment variable overrides
if test "x${RT}" = "x" ; then
  # see if we find the rt binary
  if test -x "$path_to_run_sh/../src/rt" ; then
    echo ...found $path_to_run_sh/../src/rt/rt
    RT="$path_to_run_sh/../src/rt/rt"
    LD_LIBRARY_PATH="$path_to_run_sh/../src/rt:$LD_LIBRARY_PATH"
  fi
else
  echo ...using $RT from RT environment variable setting
fi

echo Looking for geometry database directory...
# find geometry database directory if we do not already know where it is
# DB environment variable overrides
if test "x${DB}" = "x" ; then
  if test -f "$path_to_run_sh/../db/sphflake.g" ; then
    echo ...found $path_to_run_sh/../db
    DB="$path_to_run_sh/../db"
  fi
else
  echo ...using $DB from DB environment variable setting
fi

echo Checking for pixel comparison utility...
# find pixel comparison utility
# CMP environment variable overrides
if test "x${CMP}" = "x" ; then
  if test -x $path_to_run_sh/pixcmp ; then
    echo ...found $path_to_run_sh/pixcmp
    CMP="$path_to_run_sh/pixcmp"
  else
    if test -f "$path_to_run_sh/pixcmp.c" ; then
      echo ...need to build pixcmp

      for compiler in $CC gcc cc ; do
	CC=$compiler

	$CC "$path_to_run_sh/pixcmp.c" >& /dev/null
	if $? = 0 ; then
	  break
	fi
	if test -f "$path_to_run_sh/pixcmp" ; then
	  break;
	fi
      done
      
      if test -f "$path_to_run_sh/pixcmp" ; then
        echo ...built pixcmp with $CC
        CMP="$path_to_run_sh/pixcmp"
      fi
    fi
  fi
else
  echo ...using $CMP from CMP environment variable setting
fi
d58 6
a63 6
# Alliant NFS hack
if test "x${MACHINE}" = "xfx" ; then
  cp ${RT} /tmp/rt
  cp ${CMP} /tmp/pixcmp
  RT=/tmp/rt
  CMP=/tmp/pixcmp
a65 114
# print results or choke
if test "x${RT}" = "x" ; then
  echo "ERROR:  Could not find the BRL-CAD raytracer"
  exit 1
else
  echo "Using [$RT] for RT"
fi
if test "x${DB}" = "x" ; then
  echo "ERROR:  Could not find the BRL-CAD database directory"
  exit 1
else
  echo "Using [$DB] for DB"
fi
if test "x${CMP}" = "x" ; then
  echo "ERROR:  Could not find the BRL-CAD pixel comparison utility"
  exit 1
else
  echo "Using [$CMP] for CMP"
fi
export LD_LIBRARY_PATH

echo 

# Run the tests

echo +++++ moss

time $RT -B -M -s512 $* \
	$DB/moss.g all.g \
	<< EOF
viewsize 1.572026215e+02;
eye_pt 6.379990387e+01 3.271768951e+01 3.366661453e+01;
viewrot -5.735764503e-01 8.191520572e-01 0.000000000e+00 
0.000000000e+00 -3.461886346e-01 -2.424038798e-01 9.063078165e-01 
0.000000000e+00 7.424039245e-01 5.198368430e-01 4.226182699e-01 
0.000000000e+00 0.000000000e+00 0.000000000e+00 0.000000000e+00 
1.000000000e+00 ;
start 0;
end;
EOF

echo +++++ world

time $RT -B -M -s512 $* \
	$DB/world.g all.g \
	<< EOF
viewsize 1.572026215e+02;
eye_pt 6.379990387e+01 3.271768951e+01 3.366661453e+01;
viewrot -5.735764503e-01 8.191520572e-01 0.000000000e+00
0.000000000e+00 -3.461886346e-01 -2.424038798e-01 9.063078165e-01 
0.000000000e+00 7.424039245e-01 5.198368430e-01 4.226182699e-01 
0.000000000e+00 0.000000000e+00 0.000000000e+00 0.000000000e+00 
1.000000000e+00 ;
start 0;
end;
EOF

echo +++++ star

time $RT -B -M -s512 $* \
	$DB/star.g all \
	<<EOF
viewsize 2.500000000e+05;
eye_pt 2.102677960e+05 8.455500000e+04 2.934714650e+04;
viewrot -6.733560560e-01 6.130643360e-01 4.132114880e-01 0.000000000e+00 
5.539599410e-01 4.823888300e-02 8.311441420e-01 0.000000000e+00 
4.896120540e-01 7.885590550e-01 -3.720948210e-01 0.000000000e+00 
0.000000000e+00 0.000000000e+00 0.000000000e+00 1.000000000e+00 ;
start 0;
end;
EOF

echo +++++ bldg391

time $RT -B -M -s512 $* \
	$DB/bldg391.g all.g \
	<<EOF
viewsize 1.800000000e+03;
eye_pt 6.345012207e+02 8.633251343e+02 8.310771484e+02;
viewrot -5.735764503e-01 8.191520572e-01 0.000000000e+00 
0.000000000e+00 -3.461886346e-01 -2.424038798e-01 9.063078165e-01 
0.000000000e+00 7.424039245e-01 5.198368430e-01 4.226182699e-01 
0.000000000e+00 0.000000000e+00 0.000000000e+00 0.000000000e+00 
1.000000000e+00 ;
start 0;
end;
EOF

echo +++++ m35

time $RT -B -M -s512 $* \
	$DB/m35.g all.g \
	<< EOF
viewsize 6.787387985e+03;
eye_pt 3.974533127e+03 1.503320754e+03 2.874633221e+03;
viewrot -5.527838919e-01 8.332423558e-01 1.171090926e-02 0.000000000e+00 
-4.815587087e-01 -3.308784486e-01 8.115544728e-01 0.000000000e+00 
6.800964482e-01 4.429747496e-01 5.841593895e-01 0.000000000e+00 
0.000000000e+00 0.000000000e+00 0.000000000e+00 1.000000000e+00 ;
start 0;
end;
EOF

echo +++++ sphflake

time $RT -B -M -s512 $* \
	$DB/sphflake.g scene.r \
	<< EOF
viewsize 2.556283261452611e+04;
orientation 4.406810841785839e-01 4.005093234738861e-01 5.226451688385938e-01 6.101102288499644e-01;
eye_pt 2.418500583758302e+04 -3.328563644344796e+03 8.489926952850350e+03;
start 0;
end;
EOF
@


14.4.2.1
log
@merge in changes through Aug10 for 7.4.2 release
@
text
@d37 3
a39 8
# A Shell script to run the BRL-CAD Benchmark, with output going to
# a framebuffer rather than to a file.
#
# Authors -
#  Mike Muuss
#  Christopher Sean Morrison
#
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.5 2005/07/16 23:31:30 brlcad Exp $ (BRL)
d43 1
a43 1
path_to_this=`dirname $0`
d48 2
a49 2
TIMEFRAME=1 ; export TIMEFRAME
MAXTIME=1 ; export MAXTIME
d51 70
a120 1
ARGS="-F/dev/Xl $*"
d122 6
a127 6
if test -f "$path_to_this/run.sh"  ; then
    $path_to_this/run.sh $ARGS
elif test -f "$path_to_this/benchmark"  ; then
    $path_to_this/benchmark $ARGS
elif test -f "/usr/brlcad/bin/benchmark"  ; then
    /usr/brlcad/bin/benchmark $ARGS
d130 114
@


14.3
log
@update copyright to 2005
@
text
@d39 1
a39 1
#  @@(#)$Header: /cvsroot/brlcad/brlcad/bench/try.sh,v 14.2 2004/12/17 21:16:11 morrison Exp $ (BRL)
d45 3
@


14.2
log
@assignment of copyright and BSD license
@
text
@d5 2
a6 2
# Copyright (c) 2004 United States Government as represented by the
# U.S. Army Research Laboratory.
d39 1
a39 1
#  @@(#)$Header: /cvs/brlcad/bench/try.sh,v 14.1 2004/11/16 19:42:08 morrison Exp $ (BRL)
@


14.1
log
@dawn of a new revision.  it shall be numbered 14 to match release 7.  begin the convergence by adding emacs/vi local variable footer blocks to encourage consistent formatting.
@
text
@d2 35
d39 1
a39 1
#  @@(#)$Header: /cvs/brlcad/bench/try.sh,v 1.9 2004/08/02 15:49:23 morrison Exp $ (BRL)
@


1.9
log
@use the improved logic so it actually works.
@
text
@d4 1
a4 1
#  @@(#)$Header: /cvs/brlcad/bench/try.sh,v 1.8 2004/06/21 19:44:24 morrison Exp $ (BRL)
d207 8
a214 8
# Local Variables: ***
# mode: sh ***
# tab-width: 8 ***
# sh-indentation: 2 ***
# sh-basic-offset: 2 ***
# indent-tabs-mode: t ***
# End: ***
# ex: shiftwidth=2 tabstop=8
@


1.8
log
@M-x indent region formatting and style consistency
@
text
@d4 1
a4 1
#  @@(#)$Header: /cvs/brlcad/bench/try.sh,v 1.7 1999/05/20 05:19:22 mike Exp $ (BRL)
d8 1
d10 61
a70 11
eval `machinetype.sh -b`	# sets MACHINE, UNIXTYPE, HAS_TCP
if test -f ../.rt.$MACHINE/rt
then
	RT=../.rt.$MACHINE/rt
	DB=../.db.$MACHINE
	LD_LIBRARY_PATH=../.libbu.$MACHINE:../.libbn.$MACHINE:../.librt.$MACHINE:../.libfb.$MACHINE:../.libpkg.$MACHINE:../.libsysv.$MACHINE:$LD_LIBRARY_PATH
else
	if test ! -f ../rt/rt
	then
		echo "Can't find RT"
		exit 1
d72 10
a81 3
	RT=../rt/rt
	DB=../db
	LD_LIBRARY_PATH=../libbu:../libbn:../librt:../libfb:../libpkg:../libsysv:$LD_LIBRARY_PATH
a82 1
export LD_LIBRARY_PATH
d84 6
a89 4
CMP=./pixcmp
if test ! -f $CMP
then
	cake pixcmp
d92 18
a109 7
# Alliant NFS hack
if test x${MACHINE} = xfx
then
	cp ${RT} /tmp/rt
	cp ${CMP} /tmp/pixcmp
	RT=/tmp/rt
	CMP=/tmp/pixcmp
d111 3
@


1.7
log
@
Didn't have right region for sphereflake
@
text
@d4 1
a4 1
#  @@(#)$Header: /c/CVS/brlcad/bench/try.sh,v 1.6 1998/12/31 08:15:18 morrison Exp $ (BRL)
d134 8
@


1.6
log
@updated the benchmark tools to run the benchmark for
the sphere flake
@
text
@d4 1
a4 1
#  @@(#)$Header: /c/CVS/brlcad/bench/try.sh,v 1.5 1997/01/08 01:02:45 mike Exp $ (BRL)
d125 1
a125 1
	$DB/sphflake.g all.g \
@


1.5
log
@Added libbu and libbn
@
text
@d4 1
a4 1
#  @@(#)$Header: /m/cad/bench/RCS/try.sh,v 1.4 1994/09/22 04:03:08 mike Exp mike $ (BRL)
d121 13
@


1.4
log
@Set LD_LIBRARY_PATH to work around bug in SGI Irix 5 shared library support.
@
text
@d4 1
a4 1
#  @@(#)$Header: /m/cad/bench/RCS/try.sh,v 1.3 89/04/29 02:55:09 mike Exp Locker: mike $ (BRL)
d14 1
a14 1
	LD_LIBRARY_PATH=../.librt.$MACHINE:../.libfb.$MACHINE:../.libpkg.$MACHINE:../.libsysv.$MACHINE:$LD_LIBRARY_PATH
d23 1
a23 1
	LD_LIBRARY_PATH=../librt:../libfb:../libpkg:../libsysv:$LD_LIBRARY_PATH
@


1.3
log
@Updated for Alliant, etc.
@
text
@d4 1
a4 1
#  @@(#)$Header: try.sh,v 1.2 89/04/29 02:51:49 mike Locked $ (BRL)
d14 1
d16 1
a16 1
	if test -f ../rt/rt
a17 3
		RT=../rt/rt
		DB=../db
	else
d21 3
d25 1
@


1.2
log
@Added m35
@
text
@d4 1
a4 1
#  @@(#)$Header: try.sh,v 1.1 88/10/01 06:57:52 mike Locked $ (BRL)
d7 1
a7 1
export PATH || (echo "This isn't sh.  Feeding myself to sh."; sh $0 $*; kill $$)
d9 2
a10 2
MTYPE=`machinetype.sh`
if test -f ../.rt.$MTYPE/rt
d12 2
a13 2
	RT=../.rt.$MTYPE/rt
	DB=../.db.$MTYPE
d25 15
a40 1
set -x
d42 2
d58 1
d65 1
a65 1
viewrot -5.735764503e-01 8.191520572e-01 0.000000000e+00 
d74 2
d89 2
d104 2
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
#  @@(#)$Header: run,v 1.2 88/10/01 06:56:28 kermit Exp $ (BRL)
d80 13
@
