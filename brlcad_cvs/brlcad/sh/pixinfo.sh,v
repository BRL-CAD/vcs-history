head	14.7;
access;
symbols
	rel-7-10-4:14.7
	STABLE:14.7.0.2
	stable-branch:14.3
	rel-7-10-2:14.7
	rel-7-10-0:14.7
	rel-7-8-4:14.5
	rel-7-8-2:14.5
	rel-7-8-0:14.5
	trimnurbs-branch:14.5.0.2
	help:14.5
	temp_tag:14.4
	bobWinPort-20051223-freeze:14.3
	postmerge-20051223-bobWinPort:14.4
	premerge-20051223-bobWinPort:14.4
	rel-7-6-6:14.4
	rel-7-6-4:14.4
	rel-7-6-2:14.3
	rel-7-6-branch:14.3.0.6
	rel-7-6-0:14.3
	rel-7-4-2:14.3
	rel-7-4-branch:14.3.0.4
	bobWinPort:14.3.0.2
	rel-7-4-0:14.3
	rel-7-2-6:14.3
	rel-7-2-4:14.3
	rel-7-2-2:14.3
	rel-7-2-0:14.3
	rel-7-0-4:14.2
	rel-7-0-2:14.2
	rel-7-0-1:14.2
	opensource-post:14.2
	opensource-pre:11.3
	rel-7-0-branch:11.3.0.16
	rel-7-0:11.3
	ansi-20040405-merged:11.3
	postmerge-20040405-ansi:11.3
	premerge-20040404-ansi:11.3
	postmerge-autoconf:11.3
	autoconf-freeze:11.3
	premerge-autoconf:11.3
	postmerge-20040315-windows:11.3
	premerge-20040315-windows:11.3
	windows-20040315-freeze:11.3
	autoconf-20031203:11.3
	autoconf-20031202:11.3
	autoconf-branch:11.3.0.14
	phong-branch:11.3.0.12
	photonmap-branch:11.3.0.10
	rel-6-1-DP:11.3
	windows-branch:11.3.0.8
	rel-6-0-2:11.3
	ansi-branch:11.3.0.6
	rel-6-0-1-branch:11.3.0.4
	hartley-6-0-post:11.3
	hartley-6-0-pre:11.3
	rel-6-0-1:11.3
	rel-6-0:11.3
	rel-5-4:11.3
	offsite-5-3-pre:11.3
	rel-5-3:11.3
	rel-5-2:11.3
	rel-5-1-branch:11.3.0.2
	rel-5-1:11.3
	rel-5-0:11.3
	rel-5-0-beta:11.3
	rel-4-5:11.2
	ctj-4-5-post:11.2
	ctj-4-5-pre:11.2
	rel-4-4:11.1;
locks; strict;
comment	@# @;


14.7
date	2007.01.26.23.32.26;	author brlcad;	state Exp;
branches;
next	14.6;

14.6
date	2007.01.20.13.57.25;	author brlcad;	state Exp;
branches;
next	14.5;

14.5
date	2006.01.18.06.46.11;	author brlcad;	state Exp;
branches;
next	14.4;

14.4
date	2005.10.22.17.36.02;	author brlcad;	state Exp;
branches;
next	14.3;

14.3
date	2005.01.30.20.30.13;	author brlcad;	state Exp;
branches
	14.3.6.1;
next	14.2;

14.2
date	2004.12.17.21.01.05;	author morrison;	state Exp;
branches;
next	14.1;

14.1
date	2004.11.16.19.42.12;	author morrison;	state Exp;
branches;
next	11.3;

11.3
date	98.08.21.18.50.51;	author mike;	state Exp;
branches;
next	11.2;

11.2
date	95.12.15.06.21.18;	author mike;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.09.43.52;	author mike;	state Rel4_4;
branches;
next	1.10;

1.10
date	94.10.19.15.10.24;	author mike;	state Exp;
branches;
next	1.9;

1.9
date	94.10.18.17.17.53;	author mike;	state Exp;
branches;
next	1.8;

1.8
date	94.10.18.17.12.58;	author mike;	state Exp;
branches;
next	1.7;

1.7
date	93.03.12.03.39.05;	author mike;	state Exp;
branches;
next	1.6;

1.6
date	93.03.03.01.25.07;	author mike;	state Exp;
branches;
next	1.5;

1.5
date	92.10.27.22.32.53;	author mike;	state Exp;
branches;
next	1.4;

1.4
date	92.10.27.22.19.21;	author mike;	state Exp;
branches;
next	1.3;

1.3
date	92.09.15.18.30.14;	author mike;	state Exp;
branches;
next	1.2;

1.2
date	92.09.12.06.54.12;	author mike;	state Exp;
branches;
next	1.1;

1.1
date	92.09.12.06.28.52;	author mike;	state Exp;
branches;
next	;

14.3.6.1
date	2005.11.13.13.46.11;	author brlcad;	state Exp;
branches;
next	;


desc
@pixinfo.sh
Extracts info about an image file, as Shell parameters
@


14.7
log
@ws
@
text
@#!/bin/sh
#                      P I X I N F O . S H
# BRL-CAD
#
# Copyright (c) 2004-2007 United States Government as represented by
# the U.S. Army Research Laboratory.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the above copyright
# notice, this list of conditions and the following disclaimer.
#
# 2. Redistributions in binary form must reproduce the above
# copyright notice, this list of conditions and the following
# disclaimer in the documentation and/or other materials provided
# with the distribution.
#
# 3. The name of the author may not be used to endorse or promote
# products derived from this software without specific prior written
# permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
# OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
# NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
###
#
# Given the name of an image file, extract the base name,
# the suffix, and the dimensions.
#
#  e.g.:
#       data-w123-n456.pix
#       stuff.rle
#
#  The output of this script is one line, suitable for use in a
#  Bourne-shell accent-grave form, like this:
#
#       eval `pixinfo.sh $FILE`         # Sets BASE, SUFFIX, WIDTH, HEIGHT
#
#  -Mike Muuss, BRL, 11-Sept-92.
#
#  $Header: /cvsroot/brlcad/brlcad/sh/pixinfo.sh,v 14.6 2007/01/20 13:57:25 brlcad Exp $

if test "$1" = ""
then
	echo "Usage: pixinfo.sh filename"
	echo "  gives /bin/sh definitions for BASE SUFFIX WIDTH HEIGHT"
	exit 1
fi

FILE="$1"

# Change dangerous shell characters to more harmless versions.
# This primarily affects the returned BASE string.
# LHS is added in a second step, in case there is no dot at all.
eval `basename "$FILE" | tr '&;$!=' '+,---' | \
	sed -e 's/\\(.*\\)\\.\\(.*\\)/\\1;SUFFIX=\\2;/' -e 's/^/LHS=/' `

# First, see if size is encoded in the name.
BASE=
case "$SUFFIX" in
pix|bw)
	eval `echo $LHS|sed \
-e 's/\\(.*\\)-w\\([0-9]*\\)-n\\([0-9]*\\)/;BASE=\\1;WIDTH=\\2;HEIGHT=\\3;/' \
-e 's/^/GOOP=/' `
	# if BASE is not set, then the file name is not of this form,
	# and GOOP will have the full string in it.
	;;
esac

if test "$BASE" = ""
then
	BASE="$LHS"
fi

# Second, see if some program can tell us more about this file,
# usually giving -w -n style info.
ARGS=""
case "$SUFFIX" in
pix)
	eval `pixautosize -b 3 -f $FILE`;;      # Sets WIDTH, HEIGHT
bw)
	eval `pixautosize -b 1 -f $FILE`;;      # Sets WIDTH, HEIGHT
dpix)
	eval `pixautosize -b 24 -f $FILE`;;     # Sets WIDTH, HEIGHT
dbw)
	eval `pixautosize -b 8 -f $FILE`;;      # Sets WIDTH, HEIGHT
yuv)
	eval `pixautosize -b 2 -f $FILE`;;      # Sets WIDTH, HEIGHT
png)
	eval `png-fb -H $FILE`;;                # Sets WIDTH, HEIGHT
jpg|jpeg)
	ARGS=`jpeg-fb -h $FILE` ;;
rle)
	ARGS=`rle-pix -H $FILE` ;;
gif)
	ARGS=`gif2fb -h $FILE 2>&1 ` ;;
pr|ras)
	ARGS=`sun-pix -h $FILE` ;;
"")
	# No suffix given, this is a problem.
	ARGS="-w0 -n0"
	SUFFIX=unknown ;;
*)
	#  Suffix not recognized, just act innocent.
	#  Calling routine may know what to do anyway, and just wants
	#  the BASE and SUFFIX strings
	ARGS="-w0 -n0" ;;
esac

set -- `getopt hs:S:w:n:W:N: $ARGS`
while :
do
	case $1 in
	-h)
		WIDTH=1024; HEIGHT=1024;;
	-s|-S)
		WIDTH=$2; HEIGHT=$2; shift;;
	-w|-W)
		WIDTH=$2; shift;;
	-n|-N)
		HEIGHT=$2; shift;;
	--)
		break;
	esac
	shift
done

echo "BASE=$BASE; SUFFIX=$SUFFIX; WIDTH=$WIDTH; HEIGHT=$HEIGHT"
exit 0

# Local Variables:
# mode: sh
# tab-width: 8
# sh-indentation: 4
# sh-basic-offset: 4
# indent-tabs-mode: t
# End:
# ex: shiftwidth=4 tabstop=8
@


14.6
log
@update copyright to 2007
@
text
@d42 2
a43 2
#	data-w123-n456.pix
#	stuff.rle
d48 1
a48 1
#	eval `pixinfo.sh $FILE`		# Sets BASE, SUFFIX, WIDTH, HEIGHT
d52 1
a52 1
#  $Header: /cvsroot/brlcad/brlcad/sh/pixinfo.sh,v 14.5 2006/01/18 06:46:11 brlcad Exp $
d57 1
a57 1
	echo "	gives /bin/sh definitions for BASE SUFFIX WIDTH HEIGHT"
d91 1
a91 1
	eval `pixautosize -b 3 -f $FILE`;;	# Sets WIDTH, HEIGHT
d93 1
a93 1
	eval `pixautosize -b 1 -f $FILE`;;	# Sets WIDTH, HEIGHT
d95 1
a95 1
	eval `pixautosize -b 24 -f $FILE`;;	# Sets WIDTH, HEIGHT
d97 1
a97 1
	eval `pixautosize -b 8 -f $FILE`;;	# Sets WIDTH, HEIGHT
d99 1
a99 1
	eval `pixautosize -b 2 -f $FILE`;;	# Sets WIDTH, HEIGHT
d101 1
a101 1
	eval `png-fb -H $FILE`;;		# Sets WIDTH, HEIGHT
@


14.5
log
@update copyright to 2006
@
text
@d5 1
a5 1
# Copyright (c) 2004-2006 United States Government as represented by
d52 1
a52 1
#  $Header: /cvsroot/brlcad/brlcad/sh/pixinfo.sh,v 14.4 2005/10/22 17:36:02 brlcad Exp $
@


14.4
log
@ws
@
text
@d5 1
a5 1
# Copyright (C) 2004-2005 United States Government as represented by
d52 1
a52 1
#  $Header: /cvsroot/brlcad/brlcad/sh/pixinfo.sh,v 14.3 2005/01/30 20:30:13 brlcad Exp $
@


14.3
log
@update copyright to 2005
@
text
@d15 1
a15 1
# 2. Redistributions in binary form must reproduce the above 
d52 1
a52 1
#  $Header: /cvsroot/brlcad/brlcad/sh/pixinfo.sh,v 14.2 2004/12/17 21:01:05 morrison Exp $
@


14.3.6.1
log
@merge changes from HEAD aka rel-7-6-4 to the rel-7-6-branch just in case someone peeks a gander or tries to continue/build the branch
@
text
@d15 1
a15 1
# 2. Redistributions in binary form must reproduce the above
d52 1
a52 1
#  $Header$
@


14.2
log
@assignment of copyright and BSD license
@
text
@d5 2
a6 2
# Copyright (c) 2004 United States Government as represented by the
# U.S. Army Research Laboratory.
d52 1
a52 1
#  $Header: /cvs/brlcad/sh/pixinfo.sh,v 14.1 2004/11/16 19:42:12 morrison Exp $
@


14.1
log
@dawn of a new revision.  it shall be numbered 14 to match release 7.  begin the convergence by adding emacs/vi local variable footer blocks to encourage consistent formatting.
@
text
@d2 35
a36 1
#			P I X I N F O . S H
d52 1
a52 1
#  $Header: /cvs/brlcad/sh/pixinfo.sh,v 11.3 1998/08/21 18:50:51 mike Exp $
@


11.3
log
@Added support for PNG
@
text
@d18 1
a18 1
#  $Header: /c/CVS/brlcad/sh/pixinfo.sh,v 11.2 1995/12/15 06:21:18 mike Exp $
d107 9
@


11.2
log
@Added .yuv
@
text
@d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 11.1 1995/01/04 09:43:52 mike Rel4_4 mike $
d66 2
@


11.1
log
@Release_4.4
@
text
@d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.10 94/10/19 15:10:24 mike Exp $
d64 2
@


1.10
log
@Slightly more careful shell programming
@
text
@d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.9 94/10/18 17:17:53 mike Exp Locker: mike $
@


1.9
log
@Added dangerous character protection
@
text
@d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.8 94/10/18 17:12:58 mike Exp Locker: mike $
d27 1
a27 1
FILE=$1
d31 2
a32 1
eval `basename $FILE| tr '&;$!=' '+,---' | \
d78 2
a79 1
	#  Calling routine may know what to do anyway.
@


1.8
log
@Dropped 1x2 form of file size info.
Now depends on pixautosize to crack the size out of the file name.
That's a much more robust way of extracting it.
@
text
@d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.7 93/03/12 03:39:05 mike Exp Locker: mike $
d29 4
a32 1
eval `basename $FILE|sed -e 's/\\(.*\\)\\.\\(.*\\)/\\1;SUFFIX=\\2;/' -e 's/^/LHS=/' `
@


1.7
log
@If suffix is not recognized, just act innocent and report it.
The calling routine will presumably have a switch statement.
@
text
@a8 1
#	data-123x456.pix
d18 1
a18 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.6 93/03/03 01:25:07 mike Exp Locker: mike $
a35 1
-e 's/\\(.*\\)-\\([0-9]*\\)x\\([0-9]*\\)/;BASE=\\1;WIDTH=\\2;HEIGHT=\\3;/'   \
d43 1
a43 2
# if that was enough, print and quit, else work some more.
if test "$BASE" != ""
d45 1
a45 2
	echo "BASE=$BASE; SUFFIX=$SUFFIX; WIDTH=$WIDTH; HEIGHT=$HEIGHT"
	exit 0
a49 1
BASE=$LHS
@


1.6
log
@Added ".ras" suffix
@
text
@d19 1
a19 1
#  $Header: /m/cad/RCS/pixinfo.sh,v 1.5 92/10/27 22:32:53 mike Exp Locker: mike $
d73 2
a74 1
*)
d77 4
@


1.5
log
@Added support for Sun pixrect (.pr) files.
@
text
@d19 1
a19 1
#  $Header: /d/mike/bin/RCS/pixinfo.sh,v 1.4 92/10/27 22:19:21 mike Exp Locker: mike $
d71 1
a71 1
pr)
@


1.4
log
@Added use of pixautosize program,
to determine "standard" sizes of .pix, .bw, .dpix, .dbw files.
@
text
@d19 1
a19 1
#  $Header: /d/mike/bin/RCS/pixinfo.sh,v 1.3 92/09/15 18:30:14 mike Exp Locker: mike $
d71 2
@


1.3
log
@Improved comment
@
text
@d19 1
a19 1
#  $Header: /d/mike/bin/RCS/pixinfo.sh,v 1.2 92/09/12 06:54:12 mike Exp Locker: mike $
d37 2
a38 2
-e 's/\\(.*\\)-\\(.*\\)x\\(.*\\)/;BASE=\\1;WIDTH=\\2;HEIGHT=\\3;/'   \
-e 's/\\(.*\\)-w\\(.*\\)-n\\(.*\\)/;BASE=\\1;WIDTH=\\2;HEIGHT=\\3;/' \
d55 1
d57 8
a64 6
pix|bw)
	# XXX Need to run a new autosize program on these guys.
	# fall through
	ARGS="-w0 -n0"
	SUFFIX=unknown_pix
	;;
@


1.2
log
@Bug fix
@
text
@d13 1
a13 1
#  Bourne-shell accent-grave form.
d15 2
d19 1
a19 1
#  $Header: /d/mike/bin/RCS/pixinfo.sh,v 1.1 92/09/12 06:28:52 mike Exp Locker: mike $
@


1.1
log
@Initial revision
@
text
@d17 1
a17 1
#  $Header: sgisnap.sh,v 9.1 89/05/19 05:43:30 mike Rel3_5 $
d28 1
a28 1
eval `basename $FILE|sed -e 's/.*\\.\\(.*\\)/;SUFFIX=\\1;/' -e 's/^/LHS=/' `
@
