head	11.3;
access;
symbols
	ansi-20040405-merged:11.1.6.1
	postmerge-20040405-ansi:11.2
	premerge-20040404-ansi:11.1
	postmerge-autoconf:11.1
	autoconf-freeze:11.1
	premerge-autoconf:11.1
	postmerge-20040315-windows:11.1
	premerge-20040315-windows:11.1
	windows-20040315-freeze:11.1
	autoconf-20031203:11.1
	autoconf-20031202:11.1
	autoconf-branch:11.1.0.14
	phong-branch:11.1.0.12
	photonmap-branch:11.1.0.10
	rel-6-1-DP:11.1
	windows-branch:11.1.0.8
	rel-6-0-2:11.1
	ansi-branch:11.1.0.6
	rel-6-0-1-branch:11.1.0.4
	hartley-6-0-post:11.1
	hartley-6-0-pre:11.1
	rel-6-0-1:11.1
	rel-6-0:11.1
	rel-5-4:11.1
	offsite-5-3-pre:11.1
	rel-5-3:11.1
	rel-5-2:11.1
	rel-5-1-branch:11.1.0.2
	rel-5-1:11.1
	rel-5-0:11.1
	rel-5-0-beta:11.1
	rel-4-5:11.1
	ctj-4-5-post:11.1
	ctj-4-5-pre:11.1
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:1.7
	rel-3-0:1.5;
locks; strict;
comment	@# @;


11.3
date	2004.05.13.14.10.21;	author morrison;	state dead;
branches;
next	11.2;

11.2
date	2004.04.05.05.45.59;	author morrison;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.09.43.45;	author mike;	state Rel4_4;
branches
	11.1.6.1;
next	10.3;

10.3
date	95.01.04.07.20.38;	author mike;	state Exp;
branches;
next	10.2;

10.2
date	92.03.17.23.18.01;	author mike;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.35.04;	author mike;	state Rel4_0;
branches;
next	1.12;

1.12
date	91.07.19.01.48.34;	author mike;	state Exp;
branches;
next	1.11;

1.11
date	91.07.02.05.39.39;	author mike;	state Exp;
branches;
next	1.10;

1.10
date	90.05.13.13.04.40;	author mike;	state Exp;
branches;
next	1.9;

1.9
date	90.05.13.12.35.56;	author mike;	state Exp;
branches;
next	1.8;

1.8
date	89.12.28.13.25.57;	author mike;	state Exp;
branches;
next	1.7;

1.7
date	89.05.18.23.59.00;	author mike;	state Exp;
branches;
next	1.6;

1.6
date	89.04.21.22.10.00;	author mike;	state Exp;
branches;
next	1.5;

1.5
date	88.09.10.05.01.36;	author mike;	state Exp;
branches;
next	1.4;

1.4
date	88.09.02.06.15.04;	author mike;	state Exp;
branches;
next	1.3;

1.3
date	88.09.02.06.13.28;	author mike;	state Exp;
branches;
next	1.2;

1.2
date	88.09.02.06.12.21;	author mike;	state Exp;
branches;
next	1.1;

1.1
date	88.09.02.05.59.25;	author mike;	state Exp;
branches;
next	;

11.1.6.1
date	2003.02.11.04.09.46;	author morrison;	state Exp;
branches;
next	;


desc
@Shell script to update file "version.c"
@


11.3
log
@vers.c is now generated from vers.sh
@
text
@#!/bin/sh
#			N E W V E R S . S H
#
# Update the "version" file, and create a new "vers.c" from it.
# May be run in any (first-level) subdirectory of the source tree.
#
#  Optional args:
#	variable name to put version string in (default="version")
#	title
#
# @@(#)$Header: /c/CVS/brlcad/sh/newvers.sh,v 11.2 2004/04/05 05:45:59 morrison Exp $ (BRL)

if test $# -gt 0
then
	VARIABLE="$1"
	shift
else
	VARIABLE="version"
fi

if test $# -gt 0
then
	TITLE="$*"
else
	TITLE="Graphics Editor (MGED)"
fi

if test -x ./machinetype.sh
then
	eval `./machinetype.sh -b`
else
	MTYPE_SH="`dirname $0`/machinetype.sh"
	if test -x $MTYPE_SH
	then
		eval `$MTYPE_SH -b`
	else
		eval `machinetype.sh -b`	# sets MACHINE, UNIXTYPE, etc
	fi
fi

# Obtain RELEASE, RCS_REVISION, and REL_DATE
if test -r ../gen.sh
then
	# XXX The following line causes DEC Alpha's /bin/sh to dump core.
	eval `grep '^RELEASE=' ../gen.sh`
	##RELEASE=4.4;	RCS_REVISION=11;	# Uncomment for Alpha workaround.
else
	GEN_SH="`dirname $0`/../gen.sh"
	if test -r $GEN_SH
	then
		eval `grep '^RELEASE=' $GEN_SH`
	else
		RELEASE='??.??'
	fi
fi

DIR=`pwd`
if test x$DIR = x; then DIR="/unknown"; fi

if test ! -w version
then
	rm -f version; echo 0 > version; chmod 664 version
fi

awk '{version = $1 + 1; };END{printf "%d\n", version > "version"; }' < version

VERSION=`cat version`
DATE=`date`
PATH=$PATH:/usr/ucb:/usr/bsd
export PATH
if test x$UNIXTYPE = xBSD -o -f /usr/ucb/hostname -o -f /usr/bsd/hostname
then
	HOST=`hostname`
else
	HOST=`uname -n`
fi

if test "$USER" = ""
then
	USER="$LOGNAME"
fi

rm -f vers.c
cat << EOF > vers.c
char ${VARIABLE}[] = "\\
@@(#) BRL-CAD Release ${RELEASE}   ${TITLE}\n\\
    ${DATE}, Compilation ${VERSION}\n\\
    ${USER}@@${HOST}:${DIR}\n";
EOF
@


11.2
log
@merge of ansi-6-0-branch into head
@
text
@d11 1
a11 1
# @@(#)$Header$ (BRL)
@


11.1
log
@Release_4.4
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 10.3 95/01/04 07:20:38 mike Exp $ (BRL)
d28 12
a39 1
eval `machinetype.sh -b`	# sets MACHINE, UNIXTYPE, etc
d48 7
a54 1
	RELEASE='??.??'
@


11.1.6.1
log
@removed dependancy of having machinetype.sh in the path and gen.sh to be in ../ -- now the script may be called from anywhere and the proper files should be found (if not, prior behavior remains)
@
text
@d11 1
a11 1
# @@(#)$Header: /c/CVS/brlcad/sh/newvers.sh,v 11.1 1995/01/04 09:43:45 mike Rel4_4 $ (BRL)
d28 1
a28 12
if test -x ./machinetype.sh
then
	eval `./machinetype.sh -b`
else
	MTYPE_SH="`dirname $0`/machinetype.sh"
	if test -x $MTYPE_SH
	then
		eval `$MTYPE_SH -b`
	else
		eval `machinetype.sh -b`	# sets MACHINE, UNIXTYPE, etc
	fi
fi
d37 1
a37 7
	GEN_SH="`dirname $0`/../gen.sh"
	if test -r $GEN_SH
	then
		eval `grep '^RELEASE=' $GEN_SH`
	else
		RELEASE='??.??'
	fi
@


10.3
log
@Oddly, the DEC Alpha machine's /bin/sh core dumps on an eval of a grep.
Include a workaround to ease the pain of Alpha users.
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 10.2 92/03/17 23:18:01 mike Exp Locker: mike $ (BRL)
@


10.2
log
@Improved checking for "hostname" program.
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 10.1 91/10/12 06:35:04 mike Rel4_0 Locker: mike $ (BRL)
d33 1
d35 1
@


10.1
log
@Release_4.0
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 1.12 91/07/19 01:48:34 mike Exp $ (BRL)
d50 3
a52 1
if test x$UNIXTYPE = xBSD -o x$MACHINE = x4d
@


1.12
log
@IBM insists on an extra semicolon
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 1.11 91/07/02 05:39:39 mike Exp $ (BRL)
@


1.11
log
@SysV foolishness
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 1.10 90/05/13 13:04:40 mike Exp $ (BRL)
d46 1
a46 2
awk '	{	version = $1 + 1; }\
END	{	printf "%d\n", version > "version"; }' < version
@


1.10
log
@Decreased indentation back to 4 spaces.
@
text
@d11 1
a11 1
# @@(#)$Header: /m/cad/RCS/newvers.sh,v 1.9 90/05/13 12:35:56 mike Exp $ (BRL)
d56 5
@


1.9
log
@Made more generic.
@
text
@d2 1
a2 1
#			mged/newvers.sh
d5 1
d11 1
a11 1
#	@@(#)$Header: /m/cad/mged/RCS/newvers.sh,v 1.8 89/12/28 13:25:57 mike Exp $ (BRL)
d62 2
a63 2
	${DATE}, Compilation ${VERSION}\n\\
	${USER}@@${HOST}:${DIR}\n";
@


1.8
log
@Changed to run machinetype.sh only once.
Now gets release number from ../gen.sh
@
text
@d6 5
a10 1
#	@@(#)$Header: newvers.sh,v 1.7 89/05/18 23:59:00 mike Locked $ (BRL)
d12 15
d38 1
a38 1
if test x$DIR = x; then DIR=".mged.$MACHINE"; fi
d40 5
a44 2
if test ! -r version ; then echo 0 > version; fi
touch version
d46 1
a46 2
END	{	printf "char version[] = \"@@(#) BRL-CAD Release '$RELEASE' Graphics Editor (MGED) Compilation %d", version > "vers.c";\
		printf "%d\n", version > "version"; }' < version
d48 3
a50 2
# The ECHO command operates differently between BSD and SYSV
if test x$UNIXTYPE = xBSD
d52 1
a52 1
	/bin/echo '\n    '`date`'\n    '$USER'@@'`hostname`':'$DIR'\n";' >> vers.c
d54 1
a54 1
	echo '\\n    '`date`'\\n    '$USER'@@'`uname -n`':'$DIR'\\n";' >> vers.c
d56 8
@


1.7
log
@Marked release 3.5
@
text
@d6 1
a6 1
#	@@(#)$Header: newvers.sh,v 1.6 89/04/21 22:10:00 mike Locked $ (BRL)
d8 13
a21 2
DIR=`pwd`
if test x$DIR = x; then DIR="mged.`machinetype.sh`"; fi
d24 1
a24 1
END	{	printf "char version[] = \"@@(#) BRL-CAD Release 3.5 Graphics Editor (MGED) Compilation %d", version > "vers.c";\
d26 3
a28 1
if test x`machinetype.sh -s` = xBSD
@


1.6
log
@Updated release number
@
text
@d6 1
a6 1
#	@@(#)$Header: newvers.sh,v 1.5 88/09/10 05:01:36 mike Locked $ (BRL)
d13 1
a13 1
END	{	printf "char version[] = \"@@(#) BRL-CAD Release 3.1 Graphics Editor (MGED) Compilation %d", version > "vers.c";\
@


1.5
log
@Horrid bug
@
text
@d6 1
a6 1
#	@@(#)$Header: newvers.sh,v 1.4 88/09/02 06:15:04 mike Locked $ (BRL)
d13 1
a13 1
END	{	printf "char version[] = \"@@(#) BRL-CAD Release 3.0 Graphics Editor (MGED) Compilation %d", version > "vers.c";\
@


1.4
log
@Changed from "version" to "compilation"
@
text
@d6 1
a6 1
#	@@(#)$Header: newvers.sh,v 1.3 88/09/02 06:13:28 mike Locked $ (BRL)
d15 1
a15 1
if test x`machinetype.sh -s` = BSD
@


1.3
log
@Added BRL-CAD Release number.
@
text
@d6 1
a6 1
#	@@(#)$Header: newvers.sh,v 1.2 88/09/02 06:12:21 mike Locked $ (BRL)
d13 1
a13 1
END	{	printf "char version[] = \"@@(#) BRL-CAD Release 3.0 Graphics Editor (MGED) Version 2.%d", version > "vers.c";\
@


1.2
log
@This version works on both BSD and SYSV machines.
@
text
@d6 1
a6 1
#	@@(#)$Header$ (BRL)
d13 1
a13 1
END	{	printf "char version[] = \"@@(#) BRL Graphics Editor (MGED) Version 2.%d", version > "vers.c";\
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
#			newvers.sh
d4 3
a6 1
# This version for 4.2BSD
d15 6
a20 1
/bin/echo '\n    '`date`'\n    '$USER'@@'`hostname`':'$DIR'\n";' >> vers.c
@
