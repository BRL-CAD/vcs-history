head	11.4;
access;
symbols
	ansi-20040405-merged:11.3
	premerge-autoconf:11.3
	ansi-20040316-freeze:11.3
	postmerge-20040315-windows:11.3
	premerge-20040315-windows:11.3
	windows-20040315-freeze:11.3
	autoconf-20031203:11.3
	autoconf-20031202:11.3
	phong-branch:11.3.0.12
	photonmap-branch:11.3.0.10
	rel-6-1-DP:11.3
	windows-branch:11.3.0.8
	rel-6-0-2:11.3
	ansi-branch:11.3.0.6
	rel-6-0-1-branch:11.3.0.4
	hartley-6-0-post:11.3
	hartley-6-0-pre:11.3
	rel-6-0-1:11.3
	rel-6-0:11.3
	rel-5-4:11.3
	offsite-5-3-pre:11.3
	rel-5-3:11.3
	rel-5-2:11.3
	rel-5-1-branch:11.3.0.2
	rel-5-1:11.3
	rel-5-0:11.3
	rel-5-0-beta:11.3
	rel-4-5:11.3
	ctj-4-5-post:11.3
	ctj-4-5-pre:11.3
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:9.1
	rel-3-0:8.1
	AUTOCONF:11.3.0.14;
locks; strict;


11.4
date	2004.03.18.18.15.13;	author erikg;	state dead;
branches;
next	11.3;

11.3
date	97.05.06.17.32.49;	author mike;	state Exp;
branches
	11.3.14.1;
next	11.2;

11.2
date	96.11.12.15.58.01;	author jra;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.09.43.30;	author mike;	state Rel4_4;
branches
	11.1.1.1;
next	10.9;

10.9
date	94.10.14.15.22.32;	author mike;	state Exp;
branches;
next	10.8;

10.8
date	94.09.28.21.44.54;	author mike;	state Exp;
branches;
next	10.7;

10.7
date	94.09.22.02.28.52;	author mike;	state Exp;
branches;
next	10.6;

10.6
date	94.08.24.22.48.20;	author mike;	state Exp;
branches;
next	10.5;

10.5
date	94.08.24.21.53.28;	author mike;	state Exp;
branches;
next	10.4;

10.4
date	94.08.24.21.48.59;	author mike;	state Exp;
branches;
next	10.3;

10.3
date	94.08.22.15.10.23;	author mike;	state Exp;
branches;
next	10.2;

10.2
date	94.07.12.20.02.56;	author mike;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.34.56;	author mike;	state Rel4_0;
branches;
next	9.5;

9.5
date	91.09.17.03.39.37;	author mike;	state Exp;
branches;
next	9.4;

9.4
date	91.07.23.16.26.55;	author mike;	state Exp;
branches;
next	9.3;

9.3
date	90.10.04.22.29.12;	author mike;	state Exp;
branches;
next	9.2;

9.2
date	90.10.04.21.30.10;	author mike;	state Exp;
branches;
next	9.1;

9.1
date	89.05.19.05.43.21;	author mike;	state Rel3_5;
branches;
next	8.2;

8.2
date	89.05.17.03.00.22;	author mike;	state Exp;
branches;
next	8.1;

8.1
date	88.10.05.00.23.10;	author mike;	state Rel3_0;
branches;
next	1.2;

1.2
date	88.10.01.06.51.44;	author mike;	state Exp;
branches;
next	1.1;

1.1
date	88.05.16.01.25.23;	author mike;	state Exp;
branches;
next	;

11.1.1.1
date	98.01.29.06.15.07;	author mike;	state Rel4_5;
branches;
next	;

11.3.14.1
date	2004.03.18.18.08.49;	author erikg;	state dead;
branches;
next	;


desc
@Cakefile include for building libraries of object modules
@


11.4
log
@merge of AUTOCONF branch in to HEAD
@
text
@/*
 *			C A K E F I L E . L I B
 *
 *  Cakefile for building a single library archive.
 *  Symbol PRODUCTS should be name of a single library
 *
 *  Author -
 *	Michael John Muuss
 *  
 *  Source -
 *	SECAD/VLD Computing Consortium, Bldg 394
 *	The U. S. Army Ballistic Research Laboratory
 *	Aberdeen Proving Ground, Maryland  21005-5066
 *  
 *  Distribution Status -
 *	Public Domain, Distribution Unlimitied.
 *
 *  $Header: /cvs/brlcad/Cakefile.lib,v 11.3 1997/05/06 17:32:49 mike Exp $
 */

#ifndef PRODUCTS
#	include "Symbol PRODUCTS required to make library"
#endif
#ifndef SRCDIR
#	include "Symbol SRCDIR required"
#endif
#ifndef OBJ
#	include "Symbol OBJ required"
#endif
#ifndef VERSION_VARIABLE
#	include "Symbol VERSION_VARIABLE required"
#endif
#ifndef LIBRARY_TITLE
#	include "Symbol LIBRARY_TITLE required"
#endif

#ifndef EXTRA_OBJ
#	define	EXTRA_OBJ	/**/
#endif

#ifndef EXTRA_SETUP
#	define	EXTRA_SETUP	/**/
#endif

#ifndef EXTRA_OBJ_NO_DEPENDENCY
#	define EXTRA_OBJ_NO_DEPENDENCY	/**/
#endif

#ifndef LIB_FLAGS
#	define LIB_FLAGS	/**/
#endif

#if !defined(BUILD_LIBRARY)
PRODUCTS::	EXTRA_OBJ OBJ
	newvers.sh VERSION_VARIABLE LIBRARY_TITLE
	CC CFLAGS -c vers.c
	rm -f PRODUCTS; EXTRA_SETUP
	AR r PRODUCTS OBJ EXTRA_OBJ EXTRA_OBJ_NO_DEPENDENCY vers.o
	RANLIB PRODUCTS

	/* If RANLIB is specified, be sure it is run when installing libraries */
#	define AFTERINSTALL	RANLIB
#else
	/* Shared library support.
	 * Can't list SHARED_PRODUCT in 'rm' command, or will get wrong version number.
	 * (Cake won't re-run the LIBVERS shell script)
	 * If non-null, LIBVERS will start with a leading dot.
	 * Note that the RM command zaps anything starting with PRODUCTS.
	 * Note that if you have shared libraries, you better have symlinks.
	 */
#	define	SHARED_PRODUCT	PRODUCTS''[[LIBVERS]]
PRODUCTS&::	EXTRA_OBJ OBJ
	newvers.sh VERSION_VARIABLE LIBRARY_TITLE
	CC CFLAGS -c vers.c
	rm -f PRODUCTS*; EXTRA_SETUP
	BUILD_LIBRARY SHARED_PRODUCT OBJ EXTRA_OBJ EXTRA_OBJ_NO_DEPENDENCY vers.o
	sharedliblink.sh SHARED_PRODUCT

	/* Use this opportunity to build the symlink on install */
#	define AFTERINSTALL	sharedliblink.sh
#endif

%.o&:	SRCDIR,,%,o			if exist ../SRCDIR/%.c

%9,,%,o&:	../%9/%.c HDR_DEP9	if exist ../%9/%.c
	CC CFLAGS LIB_FLAGS -c ../%9/%.c

/* Override the modes for the library */
#undef	BINDIR
#undef	BINPERM
#define	BINDIR	LIBDIR
#define	BINPERM	LIBPERM
@


11.3
log
@Scripts now live in $BINDIR, not in source tree
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 11.2 1996/11/12 15:58:01 jra Exp mike $
@


11.3.14.1
log
@merge from head
@
text
@d18 1
a18 1
 *  $Header: /cvs/brlcad/Cakefile.lib,v 11.3 1997/05/06 17:32:49 mike Exp $
@


11.2
log
@Added LIB_FLAGS to CC line for library specific flags.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 11.1 1995/01/04 09:43:30 mike Rel4_4 jra $
d55 1
a55 1
	../newvers.sh VERSION_VARIABLE LIBRARY_TITLE
d73 1
a73 1
	../newvers.sh VERSION_VARIABLE LIBRARY_TITLE
d77 1
a77 1
	../sharedliblink.sh SHARED_PRODUCT
d80 1
a80 1
#	define AFTERINSTALL	../sharedliblink.sh
@


11.1
log
@Release_4.4
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.9 94/10/14 15:22:32 mike Exp $
d49 4
d86 1
a86 1
	CC CFLAGS -c ../%9/%.c
@


11.1.1.1
log
@Release_4.5
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 11.1 95/01/04 09:43:30 mike Rel4_4 $
a48 4
#ifndef RM_BEFORE_BUILD
#	define RM_BEFORE_BUILD	/**/
#endif

d53 2
a54 2
	rm -f PRODUCTS RM_BEFORE_BUILD; EXTRA_SETUP
	AR r PRODUCTS \*.o
d71 2
a72 2
	rm -f PRODUCTS* RM_BEFORE_BUILD; EXTRA_SETUP
	BUILD_LIBRARY SHARED_PRODUCT \*.o
@


10.9
log
@Added numbered and relocatable shared library support to SunOS 5.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.8 94/09/28 21:44:54 mike Exp Locker: mike $
@


10.8
log
@Regardless of shared library support, EVERY library is now required
to have a version variable, and a library title string.
newvers.sh is run every time the library is built.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.7 94/09/22 02:28:52 mike Exp Locker: mike $
d56 3
d65 1
d73 4
a88 3

/* If RANLIB is specified, be sure it is run when installing libraries */
#define AFTERINSTALL	RANLIB
@


10.7
log
@GDurf fix to execute LIBVERS as script
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.6 1994/08/24 22:48:20 mike Exp gdurf $
d30 6
d51 2
d54 1
a54 1
	AR r PRODUCTS OBJ EXTRA_OBJ EXTRA_OBJ_NO_DEPENDENCY
d57 6
a62 5
/* Shared library support.  "EXTRA_SETUP" increments version number. */
/* Can't list SHARED_PRODUCT in 'rm' command, or will get wrong version number.
 * (Cake won't re-run the LIBVERS shell script)
 * If non-null, LIBVERS will start with a leading dot.
 */
d65 2
d68 1
a68 1
	BUILD_LIBRARY SHARED_PRODUCT OBJ EXTRA_OBJ EXTRA_OBJ_NO_DEPENDENCY
@


10.6
log
@Shared libraries are conditional on BUILD_LIBRARY, not LIBVERS.
That's always defined now.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.5 94/08/24 21:53:28 mike Exp Locker: mike $
d54 1
a54 1
#	define	SHARED_PRODUCT	PRODUCTS''LIBVERS
@


10.5
log
@Removed SGI dependency.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.4 94/08/24 21:48:59 mike Exp Locker: mike $
d43 1
a43 1
#if !defined(LIBVERS)
@


10.4
log
@LIBVERS now includes the dot.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.3 94/08/22 15:10:23 mike Exp Locker: mike $
d52 1
a53 3
#if defined(__CAKE__irix5)
#	define	SHARED_PRODUCT	PRODUCTS
#else
a54 1
#endif
@


10.3
log
@Shared libraries on SGI are brain damaged
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.2 94/07/12 20:02:56 mike Exp Locker: mike $
d56 1
a56 1
#	define	SHARED_PRODUCT	PRODUCTS.LIBVERS
@


10.2
log
@Initial support for shared libraries, at least on the Sun-4.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 10.1 91/10/12 06:34:56 mike Rel4_0 Locker: mike $
d53 5
a57 1
#define	SHARED_PRODUCT	PRODUCTS.LIBVERS
@


10.1
log
@Release_4.0
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 9.5 91/09/17 03:39:37 mike Exp $
d43 1
d48 10
@


9.5
log
@Changed from using %9 stuff to HDR_DEP9, to get it all down onto 1 line,
to keep ANSI machines from messing up.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 9.4 91/07/23 16:26:55 mike Exp $
@


9.4
log
@Added EXTRA_OBJ_NO_DEPENDENCY
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 9.3 90/10/04 22:29:12 mike Exp $
d50 1
a50 2
%9,,%,o&:	../%9/%.c [[cakeinclude -i INCDIR -s ../%9 ../%9/%.c]] \
					if exist ../%9/%.c
@


9.3
log
@According to the documentation, the "u" option to AR is a modifier
to be applied to the "r" command, rather than a real command in
it's own right.  While this has worked fine for a decade or more,
it broke with SGI Release 3.3.1, sigh.
Might as well be standard.
@
text
@d18 1
a18 1
 *  $Header: /m/cad/RCS/Cakefile.lib,v 9.2 90/10/04 21:30:10 mike Exp $
d39 4
d45 1
a45 1
	AR r PRODUCTS OBJ EXTRA_OBJ
@


9.2
log
@Changed from cakeinclude.sh to cakeinclude program
@
text
@d18 1
a18 1
 *  $Header$
d41 1
a41 1
	AR u PRODUCTS OBJ EXTRA_OBJ
@


9.1
log
@Release_3.5
@
text
@d6 13
d46 1
a46 1
%9,,%,o&:	../%9/%.c [[cakeinclude.sh ../%9/%.c INCDIR ../%9]] \
@


8.2
log
@On "install" target, be sure to run RANLIB.
@
text
@@


8.1
log
@Release_3.0
@
text
@d42 3
@


1.2
log
@Used defines for AR,
OBJ go before EXTRA_OBJ
@
text
@@


1.1
log
@Initial revision
@
text
@d28 1
a28 1
	ar uv PRODUCTS EXTRA_OBJ OBJ
@
