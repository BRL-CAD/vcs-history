head	11.3;
access;
symbols
	ansi-20040405-merged:11.2
	postmerge-20040405-ansi:11.2
	premerge-20040404-ansi:11.2
	postmerge-autoconf:11.2
	autoconf-freeze:11.2
	premerge-autoconf:11.2
	ansi-20040316-freeze:11.2
	postmerge-20040315-windows:11.2
	premerge-20040315-windows:11.2
	windows-20040315-freeze:11.2
	autoconf-20031203:11.2
	autoconf-20031202:11.2
	autoconf-branch:11.2.0.14
	phong-branch:11.2.0.12
	photonmap-branch:11.2.0.10
	rel-6-1-DP:11.2
	windows-branch:11.2.0.8
	rel-6-0-2:11.2
	ansi-branch:11.2.0.6
	rel-6-0-1-branch:11.2.0.4
	hartley-6-0-post:11.2
	hartley-6-0-pre:11.2
	rel-6-0-1:11.2
	rel-6-0:11.2
	rel-5-4:11.2
	offsite-5-3-pre:11.2
	rel-5-3:11.2
	rel-5-2:11.2
	rel-5-1-branch:11.2.0.2
	rel-5-1:11.2
	rel-5-0:11.1
	rel-5-0-beta:11.1
	rel-4-5:11.1
	ctj-4-5-post:11.1
	ctj-4-5-pre:11.1
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:9.1;
locks; strict;
comment	@ * @;


11.3
date	2004.05.21.18.07.30;	author morrison;	state dead;
branches;
next	11.2;

11.2
date	99.12.18.00.47.20;	author mike;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.09.56.25;	author mike;	state Rel4_4;
branches;
next	10.1;

10.1
date	91.10.12.06.40.08;	author mike;	state Rel4_0;
branches;
next	9.1;

9.1
date	89.05.19.05.55.59;	author mike;	state Rel3_5;
branches;
next	1.1;

1.1
date	89.04.27.02.12.47;	author mike;	state Exp;
branches;
next	;


desc
@Fixed point math package.
@


11.3
log
@moved to src/
@
text
@/*
 *			F I X P T . H
 *
 *  Data structures and macros for dealing with integer-based
 *  fixed point math.
 *
 *  These macros use integer instructions for
 *  a special "fixed point" format.
 *  The fractional part is stored in 28-bit integer form,
 *  to prevent roundoff errors.
 *
 *  Author -
 *	Michael John Muuss
 *  
 *  Source -
 *	SECAD/VLD Computing Consortium, Bldg 394
 *	The U. S. Army Ballistic Research Laboratory
 *	Aberdeen Proving Ground, Maryland  21005
 *  
 *  Distribution Status -
 *	Public Domain, Distribution Unlimited
 *
 *  $Header: /n/xoff/cvs/brlcad/librt/fixpt.h,v 11.2 1999/12/18 00:47:20 mike Exp $
 */

#ifndef FIXPT_H
#define FIXPT_H seen

#define	FIXPT_SCALE	((1<<28)-1)
struct fixpt  {
	int	i;
	int	f;		/* Ranges 0 to FIXPT_SCALE-1 */
};

#define FIXPT_FLOAT( fp, fl )	{ \
	register double d = fl; \
	fp.f = (d - (fp.i = (int)d)) * FIXPT_SCALE; \
	FIXPT_NORMALIZE(fp); }

#define FLOAT_FIXPT( fp )  ( fp.i + ((double)fp.f)/FIXPT_SCALE )

#define FIXPT_NORMALIZE(fp)	{ \
	if( fp.f < 0 )  { \
		do {  \
			fp.i--; \
			fp.f += FIXPT_SCALE; \
		} while( fp.f < 0 ); \
	} else if( fp.f >= FIXPT_SCALE )  { \
		do { \
			fp.i++; \
			fp.f -= FIXPT_SCALE; \
		} while( fp.f >= FIXPT_SCALE ); \
	} }

#define FIXPT_ROUND(fp)		{ \
	if( fp.f > FIXPT_SCALE/2 )  { \
		if( fp.i >= 0 ) fp.i++; \
		else fp.i--; \
	}  fp.f = 0; }

#define FIXPT_ADD2( o, a, b )	{\
	o.i = a.i + b.i; \
	o.f = a.f + b.f; \
	FIXPT_NORMALIZE(o); }

#define PR_FIX( str, fp )	bu_log("%s = %2d+x%8.8x\n", str, fp.i, fp.f )

#define PR_FIX2( str, fp )	bu_log("%s = (%2d+x%8.8x,%2d+x%8.8x)\n", \
				str, fp[0].i, fp[0].f, fp[1].i, fp[1].f )

#endif /* FIXPT_H */
@


11.2
log
@
Changed rt_log to bu_log
@
text
@d23 1
a23 1
 *  $Header: /c/CVS/brlcad/librt/fixpt.h,v 11.1 1995/01/04 09:56:25 mike Rel4_4 $
@


11.1
log
@Release_4.4
@
text
@d23 1
a23 1
 *  $Header: /m/cad/librt/RCS/fixpt.h,v 10.1 91/10/12 06:40:08 mike Rel4_0 $
d66 1
a66 1
#define PR_FIX( str, fp )	rt_log("%s = %2d+x%8.8x\n", str, fp.i, fp.f )
d68 1
a68 1
#define PR_FIX2( str, fp )	rt_log("%s = (%2d+x%8.8x,%2d+x%8.8x)\n", \
@


10.1
log
@Release_4.0
@
text
@d23 1
a23 1
 *  $Header: fixpt.h,v 9.1 89/05/19 05:55:59 mike Rel3_5 $
@


9.1
log
@Release_3.5
@
text
@d23 1
a23 1
 *  $Header: fixpt.h,v 1.1 89/04/27 02:12:47 mike Exp $
@


1.1
log
@Initial revision
@
text
@d23 1
a23 1
 *  $Header: /cad/d/mike/cad/h/RCS/raytrace.h,v 1.3 88/10/25 22:51:42 mike Exp $
@
