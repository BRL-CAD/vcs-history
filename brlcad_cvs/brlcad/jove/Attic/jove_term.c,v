head	11.9;
access;
symbols
	ansi-20040405-merged:11.7
	postmerge-20040405-ansi:11.7
	premerge-20040404-ansi:11.7
	postmerge-autoconf:11.7
	autoconf-freeze:11.7
	premerge-autoconf:11.7
	ansi-20040316-freeze:11.7
	postmerge-20040315-windows:11.7
	premerge-20040315-windows:11.7
	windows-20040315-freeze:11.7
	autoconf-20031203:11.7
	autoconf-20031202:11.7
	autoconf-branch:11.7.0.12
	phong-branch:11.7.0.10
	photonmap-branch:11.7.0.8
	rel-6-1-DP:11.7
	windows-branch:11.7.0.6
	rel-6-0-2:11.7
	ansi-branch:11.7.0.4
	rel-6-0-1-branch:11.7.0.2
	hartley-6-0-post:11.7
	hartley-6-0-pre:11.7
	rel-6-0-1:11.7
	rel-6-0:11.7
	rel-5-4:11.5
	offsite-5-3-pre:11.6
	rel-5-3:11.5
	rel-5-2:11.5
	rel-5-1-branch:11.5.0.2
	rel-5-1:11.5
	rel-5-0:11.5
	rel-5-0-beta:11.5
	rel-4-5:11.5
	ctj-4-5-post:11.3
	ctj-4-5-pre:11.3
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:2.3
	rel-3-0:2.3
	rel-2-3:2.2
	rel-2-0:2.2
	rel-1-24:2.2
	rel-1-20:2.1
	rel-1-10:2.1
	rt-2:2.1
	rt:1.2;
locks; strict;
comment	@ * @;


11.9
date	2004.05.21.17.48.34;	author morrison;	state dead;
branches;
next	11.8;

11.8
date	2004.05.10.15.30.43;	author erikg;	state Exp;
branches;
next	11.7;

11.7
date	2001.10.15.19.58.03;	author morrison;	state Exp;
branches;
next	11.6;

11.6
date	2000.08.24.23.12.24;	author mike;	state Exp;
branches;
next	11.5;

11.5
date	97.07.16.02.37.42;	author mike;	state Exp;
branches;
next	11.4;

11.4
date	97.07.16.02.31.25;	author mike;	state Exp;
branches;
next	11.3;

11.3
date	97.01.03.17.42.17;	author jra;	state Exp;
branches;
next	11.2;

11.2
date	95.06.21.03.45.25;	author gwyn;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.10.35.24;	author mike;	state Rel4_4;
branches;
next	10.3;

10.3
date	93.12.10.06.43.37;	author mike;	state Exp;
branches;
next	10.2;

10.2
date	93.10.26.05.43.27;	author mike;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.54.06;	author mike;	state Rel4_0;
branches;
next	2.6;

2.6
date	91.08.30.20.24.18;	author mike;	state Exp;
branches;
next	2.5;

2.5
date	91.08.30.17.54.40;	author mike;	state Exp;
branches;
next	2.4;

2.4
date	91.08.30.17.49.16;	author mike;	state Exp;
branches;
next	2.3;

2.3
date	88.03.10.05.25.30;	author phil;	state Exp;
branches;
next	2.2;

2.2
date	87.04.14.21.58.07;	author dpk;	state BRL;
branches;
next	2.1;

2.1
date	85.05.14.01.44.34;	author dpk;	state Exp;
branches;
next	2.0;

2.0
date	84.12.26.16.50.32;	author dpk;	state Exp;
branches;
next	1.5;

1.5
date	84.11.07.20.57.18;	author dpk;	state Exp;
branches;
next	1.4;

1.4
date	84.10.03.21.51.40;	author dpk;	state Exp;
branches;
next	1.3;

1.3
date	84.10.03.21.48.13;	author dpk;	state Exp;
branches;
next	1.2;

1.2
date	83.12.16.00.09.50;	author dpk;	state BRL;
branches;
next	1.1;

1.1
date	83.12.16.00.09.47;	author dpk;	state Exp;
branches;
next	;


desc
@Jove is an EMACS like screen editor which will fit on 11's and Vaxen
@


11.9
log
@moved to src/other/jove/
@
text
@/*
 *			J O V E _ T E R M . C
 *
 * $Revision: 11.8 $
 *
 * $Log: jove_term.c,v $
 * Revision 11.8  2004/05/10 15:30:43  erikg
 * change conf.h to a wrapped config.h
 *
 * Revision 11.7  2001/10/15 19:58:03  morrison
 * Added "Darwin on Power Macintosh" support (finally)
 *
 * Revision 11.6  2000/08/24 23:12:24  mike
 *
 * lint, RCSid
 *
 * Revision 11.5  1997/07/16  02:37:42  mike
 * Modern tgetstr() requires null-terminated 2-char string;
 * the third and subsequent characters are significant.
 *
 * Revision 11.4  1997/07/16  02:31:25  mike
 * Changed from HAS_TERMIOS to HAVE_TERMIOS_H
 *
 * Revision 11.3  1997/01/03  17:42:17  jra
 * Mods for Irix 6.2
 *
 * Revision 11.2  1995/06/21  03:45:25  gwyn
 * Eliminated trailing blanks.
 * Don't assume SYS5 implies TAB3.
 * Removed redundant declaration of sprint().
 *
 * Revision 11.1  95/01/04  10:35:24  mike
 * Release_4.4
 *
 * Revision 10.3  93/12/10  06:43:37  mike
 * More POSIX foolishness, this time with the baud rate.
 * Can only use symbolic values like B9600, not numbers.
 *
 * Revision 10.2  93/10/26  05:43:27  mike
 * POSIX and termios
 *
 * Revision 10.1  91/10/12  06:54:06  mike
 * Release_4.0
 *
 * Revision 2.6  91/08/30  20:24:18  mike
 * global var "ospeed" clashed with some library on the Stardent.
 *
 * Revision 2.5  91/08/30  17:54:40  mike
 * Changed #include directives to distinguish between local and system header
 * files.
 *
 * Revision 2.4  91/08/30  17:49:16  mike
 * Paul Stay mods for ANSI C
 *
 * Revision 2.3  88/03/10  05:25:30  phil
 * ignore ll if li != winsize
 *
 * Revision 2.2  87/04/14  21:58:07  dpk
 * Added TERMINFO fix for sys5.  Strips %p# strings.
 *
 * Revision 2.1  85/05/14  01:44:34  dpk
 * Added changes to support System V (conditional on SYS5)
 *
 * Revision 2.0  84/12/26  16:50:32  dpk
 * Version as sent to Berkeley 26 December 84
 *
 * Revision 1.5  84/11/07  20:57:18  dpk
 * Changed  code that handles initializing of scrolling regions.
 * The implied default of newline for  scroll up is not supported.
 *
 * Revision 1.4  84/10/03  21:51:40  dpk
 * Added code to disable use of scrolling regions if you dont have
 * both SR and SF (and CS for that matter).
 *
 * Revision 1.3  84/10/03  21:48:13  dpk
 * Numerous bug fixes/enhancements.
 *
 * Revision 1.2  83/12/16  00:09:50  dpk
 * Added distinctive RCS header
 *
 */
#ifndef lint
static const char RCSid[] = "@@(#)$Header: /n/xoff/cvs/brlcad/jove/jove_term.c,v 11.8 2004/05/10 15:30:43 erikg Exp $";
#endif

/*
   Jonathan Payne at Lincoln-Sudbury Regional High School 5-25-83

   jove_term.c

   Gets the termcap information and complains if there are not enough
   of the basic features on the particular terminal. */

#ifdef HAVE_CONFIG_H
# include "config.h"
#endif


#include "./jove.h"

#if HAVE_TERMIOS_H
#  if !defined(_XOPEN_SOURCE)
#	define _XOPEN_SOURCE 1	/* to get TAB3, etc */
#  endif
# include <termios.h>
#else
# ifndef SYS5
#  include <sgtty.h>
# else
#  include <termio.h>
# endif
#endif

/* Termcap definitions */

char	*UP,	/* Move cursor up */
	*CS,	/* Change scrolling */
	*SO,	/* Start standout */
	*SE,	/* End standout */
	*CM,	/* The cursor motion string */
	*CL,	/* Clear screen */
	*CE,	/* Clear to end of line */
	*HO,	/* Home cursor */
	*AL,	/* Add line (insert line) */
	*DL,	/* Delete line */
	*VS,	/* Visual start */
	*VE,	/* Visual end */
	*KS,	/* Keypad transmit start */
	*KE,	/* Keypad transmit end */
	*TI,	/* Cursor addressing start */
	*TE,	/* Cursor addressing end */
	*IC,	/* Insert char	*/
	*DC,	/* Delete char	*/
	*IM,	/* Insert mode */
	*EI,	/* End insert mode */
	*LL,	/* Move to last line, first column of screen */
	*BC,	/* Back space */
	*M_AL,	/* Meta Add line (takes arg) */
	*M_DL,	/* Meta Delete line (takes arg) */
	*M_IC,	/* Meta Insert Char (takes arg) */
	*M_DC,	/* Meta Delete Char (takes arg) */
	*SF,	/* Scroll forward (up, for scrolling regions) */
	*SR,	/* Scroll reverse (down, for scrolling regions) */
	*VB;	/* Visual bell (e.g. a flash) */

int	LI_termcap;	/* LI as given in termcap - to see if ll makes sense */
int	LI,		/* Number of lines */
	CO,		/* Number of columns */
	TABS,		/* Whether we are in tabs mode */
	SG,		/* Number of magic cookies left by SO and SE */
	XS,		/* Wether standout is braindamaged */
	UpLen,		/* Length of the UP string */
	HomeLen,	/* Length of Home string */
	LowerLen;	/* Length of lower string */

int	BG;		/* Are we on a bitgraph? */

int jove_ospeed;

char	tspace[256];

/* The ordering of ts and meas must agree !! */
char	*ts="vsvealdlcssosecmclcehoupbcicimdceillsfsrvbksketiteALDLICDC";
char	**meas[] = {
	&VS, &VE, &AL, &DL, &CS, &SO, &SE,
	&CM, &CL, &CE, &HO, &UP, &BC, &IC, &IM,
	&DC, &EI, &LL, &SF, &SR, &VB, &KS, &KE,
	&TI, &TE, &M_AL, &M_DL, &M_IC, &M_DC, 0
};

void
TermError(str)
char	*str;
{
	char	*cp;

	cp = sprint("Termcap error: %s.\n", str);
	if (write(1, cp, strlen(cp)));
	exit(1);
}

void
getTERM()
{
	char	*getenv();
#if HAVE_TERMIOS_H
	struct termios	tty;
#else
# ifndef SYS5
	struct sgttyb tty;
# else
	struct termio tty;
# endif
#endif	/* HAVE_TERMIOS_H */
	char	termbuf[32],
		*termname,
		*termp = tspace,
		tbuff[1024];
	int	i;

#if HAVE_TERMIOS_H
	if (tcgetattr( 0, &tty ) < 0 )
#else
# ifdef SYS5
	if (ioctl (0, TCGETA, &tty))
# else
	if (gtty(0, &tty))
# endif
#endif	/* HAVE_TERMIOS_H */
		TermError("ioctl fails");

#if HAVE_TERMIOS_H
#	if defined(TAB3)
		TABS = !((tty.c_oflag & TAB3) == TAB3);
#	else
		TABS = 0;
#	endif
	jove_ospeed = cfgetospeed( &tty );
#else
# ifdef SYS5
#	if defined(TAB3)
		TABS = !((tty.c_oflag & TAB3) == TAB3);
#	else
		TABS = 0;
#	endif
	jove_ospeed = tty.c_cflag & CBAUD;
# else
	TABS = !(tty.sg_flags & XTABS);
	jove_ospeed = tty.sg_ospeed;
# endif
#endif	/* HAVE_TERMIOS_H */

	termname = getenv("TERM");
	if (termname == 0 || *termname == 0) {
		static char *msg = "Enter terminal name: ";

		write(1, msg, strlen(msg));	/* Buffered IO not setup yet */
		if ((i = read(0, termbuf, sizeof(termbuf))) < 0)
			TermError("");
		termbuf[i-1] = 0;	/* Zonk the newline */
		if (termbuf[0] == 0)
			TermError("");

		termname = termbuf;
	}

	BG = strcmp(termname, "bg") == 0;	/* Kludge to help out bg scroll */

	if (tgetent(tbuff, termname) < 1)
		TermError("terminal type unknown");

	if ((CO = tgetnum("co")) == -1)
		TermError("columns?");

	if ((LI = tgetnum("li")) == -1)
		TermError("lines?");
	LI_termcap = LI;			/* save this for comparison to winsize */

	if ((SG = tgetnum("sg")) == -1)
		SG = 0;			/* Used for mode line only */

	if ((XS = tgetflag("xs")) == -1)
		XS = 0;			/* Used for mode line only */

	for (i = 0; meas[i]; i++) {
		char	str[8];

		str[0] = ts[0];
		str[1] = ts[1];
		str[2] = '\0';
		*(meas[i]) = (char *)tgetstr(str, &termp);
		ts += 2;
	}

	if (M_AL) TERMINFOfix(M_AL);
	if (M_DL) TERMINFOfix(M_DL);
	if (M_IC) TERMINFOfix(M_IC);
	if (M_DC) TERMINFOfix(M_DC);

	if (XS)
		SO = SE = 0;

	if (CS && !SR)
		CS = SR = SF = 0;

	if (CS && !SF)
		SF = "\n";

	disp_opt_init();
}

#include <ctype.h>
/* Find TERMINFO %p# strings in the string and kill them */
/* This is a SYS5 bug fix.   -DPK- */
void
TERMINFOfix(cp)
char *cp;
{
	while (*cp) {
		if (cp[0]=='%' && cp[1]=='p' && isdigit(cp[2]))
			strcpy(cp, cp+3);
		else
			cp++;
	}
}

/*
   Deals with output to the terminal, setting up the amount of characters
   to be buffered depending on the output baud rate.  Why it's in a
   separate file I don't know ...
 */

IOBUF	termout;

void
outc(c)
register int	c;
{
	outchar(c);
}

/* Put a string with padding */

void
putpad(str, lines)
char	*str;
{
	tputs(str, lines, outc);
}

/* Flush the output, and check for more characters.  If there are
 * some, then return to main, to process them, aborting redisplay.
 */

void
flushout(x, p)
IOBUF	*p;
{
	register int	n;

	CheckTime = 1;
	if ((n = p->io_ptr - p->io_base) > 0) {
		ignore(write(p->io_file, p->io_base, n));
		if (p == &termout) {
			CheckTime = BufSize;
			p->io_cnt = BufSize;
		} else
			p->io_cnt = BSIZ;
		p->io_ptr = p->io_base;
	}
	if (x >= 0)
		Putc(x, p);
}

/* Determine the number of characters to buffer at each
   baud rate.  The lower the number, the quicker the
   response when new input arrives.  Of course the lower
   the number, the more prone the program is to stop in
   output.  Decide what matters most to you.
   This sets the int BufSize to the right number or chars,
   allocates the buffer, and initiaizes `termout'.  */

void
settout()
{
	static int speeds[] = {
		30,	/* 0	0 baud, assume network connection */
		1,	/* 50	*/
		1,	/* 75	*/
		1,	/* 110	*/
		1,	/* 134	*/
		1,	/* 150	*/
		1,	/* 200	*/
		1,	/* 300	*/
		1,	/* 600	*/
		5,	/* 1200 */
		15,	/* 1800	*/
		35,	/* 2400	*/
		100,	/* 4800	*/
		200,	/* 9600	*/
		150,	/* EXTA	(7200?) */
		200	/* EXTB (19.2?) */
	};
	int	val;

#if !HAVE_TERMIOS_H
	val = speeds[jove_ospeed & 0xF];
#else
	/* In POSIX, this is a vendor-specific code, not a useful number. */
	switch(jove_ospeed)  {
	case B0:
		val = 30;
		break;
	case B50:
	case B75:
	case B110:
	case B134:
	case B150:
	case B200:
	case B300:
	case B600:
		val = 1;
		break;
	case B1200:
		val = 5;
		break;
	case B1800:
		val = 15;
		break;
	case B2400:
		val = 35;
		break;
	case B4800:
		val = 100;
		break;
	default:
	case B9600:
		val = 200;
		break;
	case B19200:
		val = 400;
		break;
	case B38400:
		val = 800;
		break;
	}
#endif
	BufSize = val * max(LI / 24, 1);
	if( BufSize < 1 )  BufSize = 1;
	CheckTime = BufSize;
	termout.io_cnt = BufSize;
	termout.io_base = termout.io_ptr = emalloc(BufSize);
	termout.io_flag = 0;
	termout.io_file = 1;	/* Standard output */
}
@


11.8
log
@change conf.h to a wrapped config.h
@
text
@d4 1
a4 1
 * $Revision: 11.7 $
d7 3
d83 1
a83 1
static const char RCSid[] = "@@(#)$Header: /cvs/brlcad/jove/jove_term.c,v 11.7 2001/10/15 19:58:03 morrison Exp $";
@


11.7
log
@Added "Darwin on Power Macintosh" support (finally)
@
text
@d4 1
a4 1
 * $Revision: 11.6 $
d7 3
d80 1
a80 1
static const char RCSid[] = "@@(#)$Header: /c/CVS/brlcad/jove/jove_term.c,v 11.6 2000/08/24 23:12:24 mike Exp $";
d91 5
a95 1
#include "conf.h"
@


11.6
log
@
lint, RCSid
@
text
@d4 1
a4 1
 * $Revision: 11.5 $
d7 4
d77 1
a77 1
static const char RCSid[] = "@@(#)$Header: /c/CVS/brlcad/jove/jove_term.c,v 11.5 1997/07/16 02:37:42 mike Exp $";
d88 1
@


11.5
log
@Modern tgetstr() requires null-terminated 2-char string;
the third and subsequent characters are significant.
@
text
@d4 1
a4 1
 * $Revision: 11.4 $
d7 4
d73 1
a73 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 11.4 1997/07/16 02:31:25 mike Exp $";
@


11.4
log
@Changed from HAS_TERMIOS to HAVE_TERMIOS_H
@
text
@d4 1
a4 1
 * $Revision: 11.3 $
d7 3
d69 1
a69 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 11.3 1997/01/03 17:42:17 jra Exp mike $";
d247 6
a252 1
		*(meas[i]) = (char *)tgetstr(ts,&termp);
@


11.3
log
@Mods for Irix 6.2
@
text
@d4 1
a4 1
 * $Revision: 11.2 $
d7 3
d66 1
a66 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 11.2 1995/06/21 03:45:25 gwyn Exp jra $";
d79 1
a79 1
#if HAS_TERMIOS
d164 1
a164 1
#if HAS_TERMIOS
d172 1
a172 1
#endif	/* HAS_TERMIOS */
d179 1
a179 1
#if HAS_TERMIOS
d187 1
a187 1
#endif	/* HAS_TERMIOS */
d190 1
a190 1
#if HAS_TERMIOS
d209 1
a209 1
#endif	/* HAS_TERMIOS */
d247 1
a247 1
#ifdef SYS5
d252 1
a252 1
#endif
a264 1
#ifdef SYS5
d279 1
a279 1
#endif
d359 1
a359 1
#if !HAS_TERMIOS
@


11.2
log
@Eliminated trailing blanks.
Don't assume SYS5 implies TAB3.
Removed redundant declaration of sprint().
@
text
@d4 1
a4 1
 * $Revision: 11.1 $
d6 6
a11 1
 * $Log:	jove_term.c,v $
d63 1
a63 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 11.1 95/01/04 10:35:24 mike Rel4_4 $";
d146 1
d157 1
d266 1
d286 1
d295 1
d306 1
d334 1
@


11.1
log
@Release_4.4
@
text
@d2 1
a2 1
 *			J O V E _ T E R M . C 
d4 1
a4 1
 * $Revision: 10.3 $
d7 3
d13 1
a13 1
 * 
d16 1
a16 1
 * 
d19 1
a19 1
 * 
d22 1
a22 1
 * 
d26 1
a26 1
 * 
d29 1
a29 1
 * 
d32 1
a32 1
 * 
d35 1
a35 1
 * 
d38 1
a38 1
 * 
d41 1
a41 1
 * 
d45 1
a45 1
 * 
d49 1
a49 1
 * 
d52 1
a52 1
 * 
d55 1
a55 1
 * 
d58 1
a58 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 10.3 93/12/10 06:43:37 mike Exp $";
a139 1
char	*sprint();
d154 1
a154 1
#if defined(HAS_TERMIOS)
d169 1
a169 1
#if defined(HAS_TERMIOS)
d179 2
a180 1
#if defined(HAS_TERMIOS)
d189 5
a193 1
	TABS = !((tty.c_oflag & TAB3) == TAB3);
d272 1
a272 1
   to be buffered depending on the output baud rate.  Why it's in a 
d341 1
a341 1
		200	/* EXT	(19.2?) */
d345 1
a345 1
#if !defined(HAS_TERMIOS)
@


10.3
log
@More POSIX foolishness, this time with the baud rate.
Can only use symbolic values like B9600, not numbers.
@
text
@d4 1
a4 1
 * $Revision: 10.2 $
d7 4
d55 1
a55 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 10.2 93/10/26 05:43:27 mike Exp Locker: mike $";
@


10.2
log
@POSIX and termios
@
text
@d4 1
a4 1
 * $Revision: 10.1 $
d7 3
d51 1
a51 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 10.1 91/10/12 06:54:06 mike Rel4_0 Locker: mike $";
d332 1
d334 46
a379 1
	termout.io_cnt = BufSize = CheckTime = speeds[jove_ospeed] * max(LI / 24, 1);
@


10.1
log
@Release_4.0
@
text
@d4 1
a4 1
 * $Revision: 2.6 $
d7 3
d48 1
a48 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 2.6 91/08/30 20:24:18 mike Exp $";
d60 6
a65 2
#ifndef SYS5
#include <sgtty.h>
d67 5
a71 1
#include <termio.h>
d145 4
a148 1
#ifndef SYS5
d150 1
a150 1
#else
d152 2
a153 1
#endif
d160 4
a163 1
#ifdef SYS5
d165 1
a165 1
#else
d167 2
a168 1
#endif
d170 9
a178 1
#ifdef SYS5
d181 1
a181 1
#else
d184 2
a185 1
#endif
@


2.6
log
@global var "ospeed" clashed with some library on the Stardent.
@
text
@d4 1
a4 1
 * $Revision: 2.5 $
d7 3
d45 1
a45 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 2.5 91/08/30 17:54:40 mike Exp $";
@


2.5
log
@Changed #include directives to distinguish between local and system header
files.
@
text
@d4 1
a4 1
 * $Revision: 2.4 $
d7 4
d42 1
a42 1
static char RCSid[] = "@@(#)$Header: /m/cad/jove/RCS/jove_term.c,v 2.4 91/08/30 17:49:16 mike Exp $";
d104 1
a104 1
int ospeed;
d150 1
a150 1
	ospeed = tty.c_cflag & CBAUD;
d153 1
a153 1
	ospeed = tty.sg_ospeed;
d299 1
a299 1
	termout.io_cnt = BufSize = CheckTime = speeds[ospeed] * max(LI / 24, 1);
@


2.4
log
@Paul Stay mods for ANSI C
@
text
@d4 1
a4 1
 * $Revision: 2.3 $
d7 3
d38 1
a38 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 2.3 88/03/10 05:25:30 phil Exp $";
d49 1
a49 1
#include "jove.h"
@


2.3
log
@ignore ll if li != winsize
@
text
@d4 1
a4 1
 * $Revision: 2.2 $
d7 3
d35 1
a35 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 2.2 87/04/14 21:58:07 phil Locked $";
d51 1
a51 1
#endif SYS5
d128 1
a128 1
#endif SYS5
d139 1
a139 1
#endif SYS5
d147 1
a147 1
#endif SYS5
d190 1
a190 1
#endif SYS5				
d217 1
a217 1
#endif SYS5				
@


2.2
log
@Added TERMINFO fix for sys5.  Strips %p# strings.
@
text
@d4 1
a4 1
 * $Revision: 2.1 $
d7 3
d32 1
a32 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 2.1 85/05/14 01:44:34 dpk Locked $";
d82 1
d170 1
@


2.1
log
@Added changes to support System V (conditional on SYS5)
@
text
@d4 1
a4 1
 * $Revision: 2.0 $
d7 3
d29 1
a29 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 2.0 84/12/26 16:50:32 dpk Exp $";
d177 6
d195 15
@


2.0
log
@Version as sent to Berkeley 26 December 84
@
text
@d4 1
a4 1
 * $Revision: 1.5 $
d7 3
d26 1
a26 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 1.5 84/11/07 20:57:18 dpk Exp $";
d38 1
d40 3
d114 1
d116 3
d125 3
d129 1
d131 4
d137 1
@


1.5
log
@Changed  code that handles initializing of scrolling regions.
The implied default of newline for  scroll up is not supported.
@
text
@d4 1
a4 1
 * $Revision: 1.4 $
d7 4
d23 1
a23 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 1.4 84/10/03 21:51:40 dpk Exp $";
@


1.4
log
@Added code to disable use of scrolling regions if you dont have
both SR and SF (and CS for that matter).
@
text
@d4 1
a4 1
 * $Revision: 1.3 $
d7 4
d19 1
a19 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 1.3 84/10/03 21:48:13 dpk Exp $";
d153 1
a153 1
	if (! (CS && SR && SF))		/* We really need all three! */
d155 3
@


1.3
log
@Numerous bug fixes/enhancements.
@
text
@d4 1
a4 1
 * $Revision: 1.2 $
d7 3
d15 1
a15 1
static char RCSid[] = "@@(#)$Header: jove_term.c,v 1.2 83/12/16 00:09:50 dpk BRL $";
d148 4
@


1.2
log
@Added distinctive RCS header
@
text
@d4 1
a4 1
 * $Revision$
d6 4
a9 1
 * $Log$
d12 1
a12 1
static char RCSid[] = "@@(#)$Header$";
d28 1
a28 1
char	*UP,	/* Scroll reverse, or up */
d36 1
a36 1
	*AL,	/* Addline (insert line) */
a37 1
	*IS,	/* Initial start */
d40 4
d50 7
a56 2
	*SR,
	*VB;
d61 2
d71 1
a71 1
char	tspace[128];
d73 4
a76 2
char **meas[] = {
	&VS, &VE, &IS, &AL, &DL, &CS, &SO, &SE,
d78 2
a79 1
	&DC, &EI, &LL, &SR, &VB, 0
a80 7

gets(buf)
char	*buf;
{
	buf[read(0, buf, 12) - 1] = 0;
}	

d88 1
a88 1
	cp = sprint("Termcap error: %s\n", str);
d97 2
a98 3
	char	*ts="vsveisaldlcssosecmclcehoupbcicimdceillsrvb";
	char	termbuf[13],
		*termname = 0,
d100 1
a100 1
		tbuff[BUFSIZ];
d109 7
a115 3
	if (termname == 0) {
		putstr("Enter terminal name: ");
		gets(termbuf);
d125 1
a125 1
		TermError("terminal type?");
d133 6
d143 3
a145 5
#ifdef Lossage
/* You can decide whether you want this ... */
	if (!CE || !UP)
		TermError("Your terminal sucks!");
#endif
d151 2
a152 1
   separate file I don't know ... */
d186 1
a186 1
			p->io_cnt = BUFSIZ;
d215 5
a219 5
		30,	/* 2400	*/
		60,	/* 4800	*/
		120,	/* 9600	*/
		100,	/* EXTA	(7200?) */
		120	/* EXT	(19.2?) */
@


1.1
log
@Original 4.2 Distribution Source
@
text
@d2 11
@
