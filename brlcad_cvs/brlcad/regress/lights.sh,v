head	14.10;
access;
symbols
	rel-7-10-4:14.8
	STABLE:14.8.0.2
	stable-branch:14.1
	rel-7-10-2:14.8
	rel-7-10-0:14.7
	rel-7-8-4:14.7
	rel-7-8-2:14.7
	rel-7-8-0:14.5
	trimnurbs-branch:14.5.0.4
	help:14.5
	temp_tag:14.5
	bobWinPort-20051223-freeze:14.2
	postmerge-20051223-bobWinPort:14.5
	premerge-20051223-bobWinPort:14.5
	rel-7-6-6:14.5
	rel-7-6-4:14.5
	rel-7-6-2:14.5
	rel-7-6-branch:14.5.0.2
	rel-7-6-0:14.5
	rel-7-4-2:14.2
	rel-7-4-branch:14.2.0.4
	bobWinPort:14.2.0.2
	rel-7-4-0:14.2
	rel-7-2-6:14.2
	rel-7-2-4:14.2
	rel-7-2-2:14.1
	rel-7-2-0:14.1
	rel-7-0-4:14.1
	rel-7-0-2:14.1
	rel-7-0-1:14.1
	opensource-post:14.1
	opensource-pre:1.3
	rel-7-0-branch:1.3.0.2
	rel-7-0:1.3;
locks; strict;
comment	@# @;


14.10
date	2007.10.22.04.36.20;	author brlcad;	state Exp;
branches;
next	14.9;

14.9
date	2007.10.14.05.31.15;	author brlcad;	state Exp;
branches;
next	14.8;

14.8
date	2007.06.03.06.32.53;	author brlcad;	state Exp;
branches;
next	14.7;

14.7
date	2006.04.20.21.45.09;	author lbutler;	state Exp;
branches;
next	14.6;

14.6
date	2006.04.20.15.19.53;	author lbutler;	state Exp;
branches;
next	14.5;

14.5
date	2005.08.25.18.40.45;	author lbutler;	state Exp;
branches;
next	14.4;

14.4
date	2005.08.25.15.56.14;	author lbutler;	state Exp;
branches;
next	14.3;

14.3
date	2005.08.25.04.18.31;	author lbutler;	state Exp;
branches;
next	14.2;

14.2
date	2005.05.09.20.03.11;	author lbutler;	state Exp;
branches;
next	14.1;

14.1
date	2004.11.16.19.42.11;	author morrison;	state Exp;
branches;
next	1.3;

1.3
date	2004.10.26.20.33.32;	author butler;	state Exp;
branches;
next	1.2;

1.2
date	2004.10.19.17.55.07;	author butler;	state Exp;
branches;
next	1.1;

1.1
date	2004.10.19.15.27.58;	author butler;	state Exp;
branches;
next	;


desc
@@


14.10
log
@more consistent echo output
@
text
@#!/bin/sh

LD_LIBRARY_PATH=../src/other/tcl/unix:../src/other/tk/unix:$$LD_LIBRARY_PATH
DYLD_LIBRARY_PATH=../src/other/tcl/unix:../src/other/tk/unix:$$DYLD_LIBRARY_PATH
export LD_LIBRARY_PATH DYLD_LIBRARY_PATH

rm -f lights.pix

cat > lights.asc <<EOF
title {Untitled BRL-CAD Database}
units mm
put {local} ell V {-4 -4 4} A {0.5 0 0} B {0 0.5 0} C {0 0 0.5}
put {infinite} ell V {-4 4 4} A {0.5 0 0} B {0 0.5 0} C {0 0 0.5}
put {plate.s} arb8 V1 {-30 -30 -1} V2 {30 -30 -1} V3 {30 30 -1} V4 {-30 30 -1} V5 {-30 -30 0} V6 {30 -30 0} V7 {30 30 0} V8 {-30 30 0}
put {pole2.s} tgc V {9 2.5 1} H {0 0 10} A {0 -0.25 0} B {0.25 0 0} C {0 -0.25 0} D {0.25 0 0}
put {pole1.s} tgc V {-11 2.5 1} H {0 0 10} A {0 -0.25 0} B {0.25 0 0} C {0 -0.25 0} D {0.25 0 0}
put {ball2.s} ell V {10 0 5} A {2 0 0} B {0 2 0} C {0 0 2}
put {ball1.s} ell V {-10 0 5} A {2 0 0} B {0 2 0} C {0 0 2}
put {shadow_objs.r} comb region yes tree {u {u {l ball1.s} {l pole1.s}} {u {l ball2.s} {l pole2.s}}}
attr set {shadow_objs.r} {region} {R} {los} {100} {material_id} {1} {region_id} {1001}
put {plate.r} comb region yes tree {l plate.s}
attr set {plate.r} {region} {R} {los} {100} {material_id} {1} {region_id} {1000}
put {infinite.r} comb region yes tree {l infinite}
attr set {infinite.r} {region} {R} {los} {100} {material_id} {1} {region_id} {1002} {oshader} {light {i 1 v 0}} {rgb} {255/255/255}
put {local.r} comb region yes tree {l local}
attr set {local.r} {region} {R} {rgb} {255/255/255} {oshader} {light {s 4  pt {-4.46848 -4.09864 4.1442} pt {-3.55149 -4.11535 4.18852} pt {-4.41469 -4.27933 4.00234} pt {-3.62755 -4.33234 4.02878} pt {-4.09301 -4.44478 3.79139} pt {-4.10851 -3.55786 3.79328} pt {-3.63361 -4.2739 3.79817} pt {-3.62019 -3.74156 3.80263} pt {-4.432 -3.88231 4.22254} pt {-3.59094 -3.85892 4.25053} pt {-3.85797 -4.45142 3.83861} pt {-3.84812 -3.55582 3.82785} pt {-4.16269 -4.30592 4.36048} pt {-3.84629 -4.30072 4.3687} pt {-4.3644 -3.65806 3.98285} pt {-3.67668 -3.61863 3.99506} pt {-4.38028 -3.92574 4.31602} pt {-3.62451 -3.93287 4.32327} pt {-4.36414 -3.6574 4.00475} pt {-3.66174 -3.63259 4.02432} pt {-4.27269 -3.6819 3.72714} pt {-3.71379 -3.68422 3.73853} pt {-4.38155 -3.67804 4.02765} pt {-3.60849 -3.68903 3.99648} pt {-4.41137 -4.15778 3.76362} pt {-3.59758 -4.17667 3.76157}}} {region_id} {1003} {material_id} {1} {los} {100}
put {all.g} comb region no tree {u {u {l infinite.r} {l local.r}} {u {l plate.r} {l shadow_objs.r}}}
EOF

../src/conv/asc2g lights.asc lights.g
rm -f lights.asc

echo rendering lights...
../src/rt/rt -M -B -p30 -o lights.pix lights.g 'all.g' 2> lights.log <<EOF
viewsize 1.600000000000000e+02;
orientation 0.000000000000000e+00 0.000000000000000e+00 0.000000000000000e+00 1.000000000000000e+00;
eye_pt 0.000000000000000e+00 0.000000000000000e+00 7.950000000000000e+01;
start 0; clean;
end;

EOF

../src/conv/asc2pix < $1/regress/lights_ref.asc  > lights_ref.pix
../src/util/pixdiff lights.pix lights_ref.pix > lights_diff.pix 2>> lights.log
NUMBER_WRONG=`tr , '\012' < lights.log | awk '/many/ {print $1}'`
echo "lights.pix $NUMBER_WRONG off by many"

if [ X$NUMBER_WRONG = X0 ] ; then
    echo "-> lights.sh succeeded"
else
    echo "-> lights.sh FAILED"
fi

exit $NUMBER_WRONG

# Local Variables:
# mode: sh
# tab-width: 8
# sh-indentation: 4
# sh-basic-offset: 4
# indent-tabs-mode: t
# End:
# ex: shiftwidth=4 tabstop=8
@


14.9
log
@emphasize the result if it's a failure
@
text
@d33 1
a33 1
/bin/echo rendering lights...
d46 1
a46 1
/bin/echo lights.pix $NUMBER_WRONG off by many
d49 1
a49 1
    /bin/echo '-> lights.sh succeeded'
d51 1
a51 1
    /bin/echo '-> lights.sh FAILED'
@


14.8
log
@set the ld_library_path so the binaries invoked by the test can find the tcl/tk libraries.
@
text
@d51 1
a51 1
    /bin/echo '-> lights.sh failed'
@


14.7
log
@Fixed various sh/csh syntax errrors.
@
text
@d3 4
@


14.6
log
@Updates to make it easier to check the status of a regression test.  Each test
now reports its notion of whether it succeeded or failed.
@
text
@d44 1
a44 1
if [ $NUMBER_WRONG == 0 ] ; then
d48 1
a48 1
endif
@


14.5
log
@Getting the nightly tests to work.
Making the scripts report an exit code when things go wrong.
@
text
@d42 7
a48 1
/bin/echo -n lights.pix $NUMBER_WRONG off by many
@


14.4
log
@No longer pass 2 arguments to script.  Had to change $2 to $1
@
text
@d41 4
a44 2
/bin/echo -n lights.pix
tr , '\012' < lights.log | grep many
@


14.3
log
@updates so that regression tests run against build tree, not install dir.
Can now be run from build dir other than in source tree.
@
text
@d39 1
a39 1
../src/conv/asc2pix < $2/regress/lights_ref.asc  > lights_ref.pix
@


14.2
log
@Updates for running regression test from remote directory when build tree
and source tree are different.

Added nightly.sh and main.sh which are the foundation for the nightly runs.
More to come in these two.
@
text
@a2 3
BIN=$1/bin
export BIN

d26 1
a26 1
$BIN/asc2g lights.asc lights.g
d30 1
a30 1
$BIN/rt -M -B -p30 -o lights.pix lights.g 'all.g' 2> lights.log <<EOF
d39 2
a40 2
$BIN/asc2pix < $2/regress/lights_ref.asc  > lights_ref.pix
$BIN/pixdiff lights.pix lights_ref.pix > lights_diff.pix 2>> lights.log
@


14.1
log
@dawn of a new revision.  it shall be numbered 14 to match release 7.  begin the convergence by adding emacs/vi local variable footer blocks to encourage consistent formatting.
@
text
@d33 1
a33 1
$BIN/rt -M -B -p30 -o lights.pix $2/regress/lights.g 'all.g' 2> lights.log <<EOF
@


1.3
log
@updated to the regression tests
@
text
@d46 9
@


1.2
log
@improvements to the light test
@
text
@d32 2
a33 1
$BIN/rt -M -B -p30 -o lights.pix lights.g 'all.g' 2> lights.log <<EOF
d43 3
a45 1
$BIN/pixdiff lights.pix lights_ref.pix > lights_diff.pix
@


1.1
log
@Added test to make sure lights (area and infinite) are behaving properly
@
text
@d8 21
d30 1
d32 2
a33 7
$BIN/rt -M -B \
 -o lights.pix \
 lights.g\
 'all.g' \
 2> lights.log\
 <<EOF
viewsize 6.000000000000000e+01;
d35 1
a35 1
eye_pt 0.000000000000000e+00 0.000000000000000e+00 2.950000000000000e+01;
d41 1
a41 1
$BIN/asc2pix < lights_ref.asc  > lights_ref.pix
@

