head	11.7;
access;
symbols
	ansi-20040405-merged:11.4.2.1
	postmerge-20040405-ansi:11.5
	premerge-20040404-ansi:11.4
	postmerge-autoconf:11.4
	autoconf-freeze:11.4
	premerge-autoconf:11.4
	ansi-20040316-freeze:11.4.2.1
	postmerge-20040315-windows:11.4
	premerge-20040315-windows:11.4
	windows-20040315-freeze:11.4
	autoconf-20031203:11.4
	autoconf-20031202:11.4
	autoconf-branch:11.4.0.10
	phong-branch:11.4.0.8
	photonmap-branch:11.4.0.6
	rel-6-1-DP:11.4
	windows-branch:11.4.0.4
	rel-6-0-2:11.2
	ansi-branch:11.4.0.2
	rel-6-0-1-branch:11.2.0.2
	hartley-6-0-post:11.3
	hartley-6-0-pre:11.2
	rel-6-0-1:11.2
	rel-6-0:11.2
	rel-5-4:11.1
	offsite-5-3-pre:11.1
	rel-5-3:11.1
	rel-5-2:11.1
	rel-5-1-branch:11.1.0.2
	rel-5-1:11.1
	rel-5-0:11.1
	rel-5-0-beta:11.1
	rel-4-5:11.1
	ctj-4-5-post:11.1
	ctj-4-5-pre:11.1
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:9.1
	rel-3-0:8.1
	rel-2-3:7.1
	rel-2-0:5.1
	rel-1-24:5.1
	rel-1-20:4.5
	rel-1-10:4.1;
locks; strict;
comment	@ * @;


11.7
date	2004.05.24.04.13.10;	author morrison;	state dead;
branches;
next	11.6;

11.6
date	2004.05.10.15.30.42;	author erikg;	state Exp;
branches;
next	11.5;

11.5
date	2004.04.05.07.52.17;	author morrison;	state Exp;
branches;
next	11.4;

11.4
date	2002.08.20.17.07.27;	author jra;	state Exp;
branches
	11.4.2.1;
next	11.3;

11.3
date	2002.08.15.20.54.40;	author hartley;	state Exp;
branches;
next	11.2;

11.2
date	2001.08.09.17.45.24;	author jra;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.10.13.47;	author mike;	state Rel4_4;
branches;
next	10.3;

10.3
date	94.08.23.19.46.47;	author gdurf;	state Exp;
branches;
next	10.2;

10.2
date	91.12.13.10.58.32;	author moss;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.49.34;	author mike;	state Rel4_0;
branches;
next	9.2;

9.2
date	90.11.26.11.16.58;	author moss;	state Exp;
branches;
next	9.1;

9.1
date	89.05.19.06.12.03;	author mike;	state Rel3_5;
branches;
next	8.5;

8.5
date	89.03.17.17.07.15;	author moss;	state Exp;
branches;
next	8.4;

8.4
date	89.03.07.09.09.48;	author moss;	state Exp;
branches;
next	8.3;

8.3
date	88.10.07.07.30.51;	author stay;	state Exp;
branches;
next	8.2;

8.2
date	88.10.06.05.02.32;	author mike;	state Rel3_0;
branches;
next	8.1;

8.1
date	88.10.05.00.44.59;	author mike;	state Rel3_0;
branches;
next	7.4;

7.4
date	88.10.04.20.09.31;	author moss;	state Exp;
branches;
next	7.3;

7.3
date	88.09.16.02.33.45;	author mike;	state Exp;
branches;
next	7.2;

7.2
date	88.03.25.12.18.16;	author gwyn;	state Exp;
branches;
next	7.1;

7.1
date	87.11.03.00.10.23;	author mike;	state Rel;
branches;
next	6.1;

6.1
date	87.07.11.08.13.51;	author mike;	state Rel;
branches;
next	5.1;

5.1
date	87.06.24.22.44.53;	author mike;	state Rel;
branches;
next	4.6;

4.6
date	87.06.22.14.51.21;	author moss;	state Exp;
branches;
next	4.5;

4.5
date	87.02.13.00.52.09;	author mike;	state Exp;
branches;
next	4.4;

4.4
date	87.01.05.17.05.45;	author moss;	state Exp;
branches;
next	4.3;

4.3
date	87.01.02.10.47.55;	author mike;	state Rel1;
branches;
next	4.2;

4.2
date	86.12.30.17.46.38;	author mike;	state Rel1;
branches;
next	4.1;

4.1
date	86.12.29.02.51.21;	author mike;	state Rel1;
branches;
next	1.4;

1.4
date	86.12.28.23.43.17;	author mike;	state Exp;
branches;
next	1.3;

1.3
date	86.12.26.22.36.30;	author mike;	state Exp;
branches;
next	1.2;

1.2
date	86.11.12.23.04.01;	author mike;	state Exp;
branches;
next	1.1;

1.1
date	86.11.10.23.10.32;	author mike;	state Exp;
branches;
next	;

11.4.2.1
date	2002.09.19.18.00.49;	author morrison;	state Exp;
branches;
next	;


desc
@Gary Moss' Original Version
@


11.7
log
@moved to src/fbed/
@
text
@/*
	SCCS id:	@@(#) empty.c	2.3
	Modified: 	1/5/87 at 16:52:54
	Retrieved: 	1/5/87 at 16:58:01
	SCCS archive:	/vld/moss/src/fbed/s.empty.c

	Author:		Gary S. Moss
			U. S. Army Ballistic Research Laboratory
			Aberdeen Proving Ground
			Maryland 21005-5066
			(301)278-6651 or DSN 298-6651
*/
#if ! defined( lint )
static const char RCSid[] = "@@(#) empty.c 2.3, modified 1/5/87 at 16:52:54, archive /vld/moss/src/fbed/s.empty.c";
#endif

#ifdef HAVE_CONFIG_H
# include "config.h"
#endif



#include <stdio.h>
#include <sys/time.h>

#include "machine.h"
#include "externs.h"
#include "fb.h"

/*	e m p t y ( )
	Examine file descriptor for input with no time delay.
	Return 1 if input is pending on file descriptor 'fd'.
	Return 0 if no input or error.
 */
int
empty(int fd)
{
#if 0
	if( isSGI )
		return sgi_Empty();
	else
#endif
#if defined( sgi )
		{	static struct timeval	timeout = { 0L, 600L };
			fd_set		readfds;
			register int nfound;
		FD_ZERO( &readfds );
		FD_SET( fd, &readfds );
		nfound = select( fd+1, &readfds, (fd_set *)0, (fd_set *)0, &timeout );
		return nfound == -1 ? 1 : (nfound == 0);
		}
#else
	/* On most machines we aren't supporting the mouse, so no need to
		not block on keyboard input. */
	return 0;
#endif
	}
@


11.6
log
@change conf.h to a wrapped config.h
@
text
@@


11.5
log
@merge of ansi-6-0-branch into HEAD
@
text
@d17 5
a21 1
#include "conf.h"
@


11.4
log
@Restoration of entire source tree to Pre-Hartley state
@
text
@d32 2
a33 3
empty( fd )
int fd;
	{
@


11.4.2.1
log
@Initial ANSIfication
@
text
@d32 3
a34 2
empty(int fd)
{
@


11.3
log
@Converted from K&R to ANSI C - RFH
@
text
@d32 3
a34 2
empty(int fd)
{
@


11.2
log
@Lint
@
text
@d32 2
a33 3
empty( fd )
int fd;
	{
@


11.1
log
@Release_4.4
@
text
@d14 1
a14 2
static
char sccsTag[] = "@@(#) empty.c 2.3, modified 1/5/87 at 16:52:54, archive /vld/moss/src/fbed/s.empty.c";
@


10.3
log
@Made includes explicit
@
text
@@


10.2
log
@Fixed fb_Setup() to set global flag (isSGI) when running on an SGI
with graphics.  This fixes the problem of getting a "CPS initialization"
error when running over a remote connection from an SGI.  #ifdef sgi
was used previously throughout the code rather than checking the name
of the device.
@
text
@a16 4
#if defined( BSD ) || defined( CRAY ) || defined( sun )
#	include <sys/types.h>
#	include <sys/time.h>
#endif
d18 1
a18 11
#if defined(sgi)
#	include <bsd/sys/types.h>
#	if !defined(mips) || defined(SGI4D_Rel2)
		/* 3D systems, and Rel2 4D systems. */
#		include <bsd/sys/time.h>
#	else
		/* Rel3 4D systems got it right */
#		include <sys/time.h>
#	endif
#	include "fb.h"
#endif
d20 2
a21 10
#ifdef VLDSYSV
/* BRL SysV under 4.2 */
#define select	_select
struct timeval
	{
	long	tv_sec;		/* seconds */
	long	tv_usec;	/* and microseconds */
	};
#else
#endif
d23 3
a25 12
#ifndef FD_ZERO
/* 4.2 does not define these */
#ifdef CRAY
#define	FD_SET(n, p)	(*p |= (n) == 0 ? 1 : (1 << (n)))
#define FD_ZERO(p)	*p = 0
typedef	long	fd_set;
#else
#define	FD_SET(n, p)	((p)->fds_bits[0] |= (n) == 0 ? 1 : (1 << (n)))
#define FD_ZERO(p)	(p)->fds_bits[0] = 0
/** typedef	struct fd_set { fd_mask	fds_bits[1]; } fd_set; **/
#endif
#endif /* FD_ZERO */
@


10.1
log
@Release_4.0
@
text
@d67 2
a68 3
#if defined( sgi ) && 0
		extern FBIO *fbp;
	if( fbp != FBIO_NULL && strncmp( fbp->if_name, "/dev/sgi", 8 ) == 0 )
@


9.2
log
@Just checking in sources in preparation for release 4.0.
@
text
@@


9.1
log
@Release_3.5
@
text
@d11 1
a11 1
			(301)278-6647 or AV-298-6647
d15 1
a15 1
char	sccsTag[] = "@@(#) empty.c 2.3, modified 1/5/87 at 16:52:54, archive /vld/moss/src/fbed/s.empty.c";
d65 1
a65 1
int	fd;
d68 1
a68 1
		extern FBIO	*fbp;
d70 1
a70 1
		return	sgi_Empty();
d76 1
a76 1
			register int	nfound;
d80 1
a80 1
		return	nfound == -1 ? 1 : (nfound == 0);
d85 1
a85 1
	return	0;
@


8.5
log
@Changed to not do non-blocking reads unless on an IRIS since the only
reason to do polling is when a mouse is supported.
@
text
@@


8.4
log
@Fixed non-comment following #endif directive.
@
text
@d73 1
d82 5
@


8.3
log
@fixed problem with types.h for sgi 4D...
@
text
@d56 1
a56 1
#endif FD_ZERO
@


8.2
log
@SGI moved the files.
Really Release 3.0
@
text
@d23 1
a25 1
#		include <bsd/sys/types.h>
a28 1
#		include <sys/types.h>
@


8.1
log
@Release_3.0
@
text
@d18 2
a19 2
#include <sys/types.h>
#include <sys/time.h>
d22 11
a32 4
#if defined( sgi )
#include <bsd/sys/types.h>
#include <bsd/sys/time.h>
#include "fb.h"
@


7.4
log
@Recent revisions
@
text
@@


7.3
log
@upper-case CRAY
@
text
@d61 1
a61 1
#ifdef sgi
@


7.2
log
@get timeval struct for non-BSD sun also
@
text
@d17 1
a17 1
#if defined( BSD ) || defined( cray ) || defined( sun )
d41 1
a41 1
#ifdef cray
@


7.1
log
@Release 2.3
@
text
@d17 1
a17 1
#if defined( BSD ) || defined( cray )
@


6.1
log
@Release 2.0
@
text
@@


5.1
log
@Release 1.24
@
text
@@


4.6
log
@Cray portability bugs fixed.
@
text
@@


4.5
log
@Release 1.20 -- First Formal Release
@
text
@d17 1
a17 1
#ifdef BSD
d22 6
a27 1
#ifdef SYSV
d37 1
a37 8
/* Regular SysV */
#ifdef sgi
#include <bsd/sys/types.h>
#include <bsd/sys/time.h>
#include "fb.h"
#endif sgi
#endif VLDSYSV
#endif SYSV
d41 5
d49 1
@


4.4
log
@Pulled SGI-specific code out, packaged in sgi_Empty() and placed in sgi_dep.c.
@
text
@@


4.3
log
@BRL Release 1.12
While 4.2 did not define FD_ZERO, it DID define fd_set.
@
text
@d2 3
a4 3
	SCCS id:	@@(#) empty.c	2.2
	Modified: 	12/29/86 at 11:20:00
	Retrieved: 	12/30/86 at 17:01:32
d15 1
a15 1
char	sccsTag[] = "@@(#) empty.c 2.2, modified 12/29/86 at 11:20:00, archive /vld/moss/src/fbed/s.empty.c";
a38 1
/* Not a chance */
d60 1
a60 4
		{	
		winattach();
		return	! qtest();
		}
@


4.2
log
@Latest versions from Moss
@
text
@d46 1
a46 5
#ifndef alliant
typedef	struct fd_set {
	fd_mask	fds_bits[1];
} fd_set;
#endif alliant
@


4.1
log
@BRL CAD Distribution Release 1.10
@
text
@d2 3
a4 3
	SCCS id:	@@(#) empty.c	2.1
	Modified: 	12/9/86 at 15:55:14
	Retrieved: 	12/26/86 at 21:54:00
d15 1
a15 1
char	sccsTag[] = "@@(#) empty.c 2.1, modified 12/9/86 at 15:55:14, archive /vld/moss/src/fbed/s.empty.c";
a16 1

d36 4
a39 2
#endif
#endif
d42 11
d61 1
d63 16
a78 3
	{
	winattach();
	return	! qtest();
a79 9
#else	
	{	static struct timeval	timeout = { 0L, 600L };
		auto long	readfds = 1 << fd;
		register int	nfound;
	readfds = 1<<fd;
	nfound = select( fd+1, &readfds, (fd_set *)0, (fd_set *)0, &timeout );
	return	nfound == -1 ? 1 : (nfound == 0);
	}
#endif
@


1.4
log
@Made portable back to original 4.2 systems.
@
text
@@


1.3
log
@Latest version from Gary Moss
@
text
@d56 1
a56 1
		fd_set		readfds;
d58 1
a58 2
	FD_ZERO( &readfds );
	FD_SET( fd, &readfds );
@


1.2
log
@First version that compiles
@
text
@d2 3
a4 3
	SCCS id:	@@(#) empty.c	1.3
	Last edit: 	8/5/86 at 10:59:26
	Retrieved: 	8/6/86 at 13:35:58
d15 1
a15 1
char	sccsTag[] = "@@(#) empty.c	1.3	last edit 8/5/86 at 10:59:26";
d19 1
d34 3
a36 1
xxx?;
d38 1
d49 6
d56 5
a60 3
		int		readfds = 1 << fd;
		register int	nfound =
			select( fd+1, &readfds, (int *)0, (int *)0, &timeout );
d63 1
@


1.1
log
@Initial revision
@
text
@d17 1
d20 5
a24 1
#else
d31 3
d35 1
@
