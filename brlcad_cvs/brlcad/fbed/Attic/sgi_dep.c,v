head	11.4;
access;
symbols
	ansi-20040405-merged:11.2
	postmerge-20040405-ansi:11.2
	premerge-20040404-ansi:11.2
	postmerge-autoconf:11.2
	autoconf-freeze:11.2
	premerge-autoconf:11.2
	ansi-20040316-freeze:11.2
	postmerge-20040315-windows:11.2
	premerge-20040315-windows:11.2
	windows-20040315-freeze:11.2
	autoconf-20031203:11.2
	autoconf-20031202:11.2
	autoconf-branch:11.2.0.12
	phong-branch:11.2.0.10
	photonmap-branch:11.2.0.8
	rel-6-1-DP:11.2
	windows-branch:11.2.0.6
	rel-6-0-2:11.2
	ansi-branch:11.2.0.4
	rel-6-0-1-branch:11.2.0.2
	hartley-6-0-post:11.2
	hartley-6-0-pre:11.2
	rel-6-0-1:11.2
	rel-6-0:11.2
	rel-5-4:11.1
	offsite-5-3-pre:11.1
	rel-5-3:11.1
	rel-5-2:11.1
	rel-5-1-branch:11.1.0.2
	rel-5-1:11.1
	rel-5-0:11.1
	rel-5-0-beta:11.1
	rel-4-5:11.1
	ctj-4-5-post:11.1
	ctj-4-5-pre:11.1
	rel-4-4:11.1
	rel-4-0:10.1
	rel-3-5:9.1
	rel-3-0:8.1
	rel-2-3:7.1
	rel-2-0:5.1
	rel-1-24:5.1
	rel-1-20:4.4
	rel-1-10:4.1;
locks; strict;
comment	@ * @;


11.4
date	2004.05.24.04.13.10;	author morrison;	state dead;
branches;
next	11.3;

11.3
date	2004.05.10.15.30.42;	author erikg;	state Exp;
branches;
next	11.2;

11.2
date	2001.08.09.17.45.25;	author jra;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.10.13.57;	author mike;	state Rel4_4;
branches;
next	10.4;

10.4
date	94.11.24.02.22.43;	author mike;	state Exp;
branches;
next	10.3;

10.3
date	94.08.23.19.37.38;	author gdurf;	state Exp;
branches;
next	10.2;

10.2
date	91.12.13.10.58.34;	author moss;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.49.42;	author mike;	state Rel4_0;
branches;
next	9.3;

9.3
date	91.07.09.02.53.17;	author mike;	state Exp;
branches;
next	9.2;

9.2
date	90.11.26.11.19.55;	author moss;	state Exp;
branches;
next	9.1;

9.1
date	89.05.19.06.12.22;	author mike;	state Rel3_5;
branches;
next	8.1;

8.1
date	88.10.05.00.50.15;	author mike;	state Rel3_0;
branches;
next	7.1;

7.1
date	87.11.03.00.11.01;	author mike;	state Rel;
branches;
next	6.1;

6.1
date	87.07.11.08.14.32;	author mike;	state Rel;
branches;
next	5.1;

5.1
date	87.06.24.22.45.42;	author mike;	state Rel;
branches;
next	4.4;

4.4
date	87.02.13.00.52.56;	author mike;	state Exp;
branches;
next	4.3;

4.3
date	87.01.05.17.07.43;	author moss;	state Exp;
branches;
next	4.2;

4.2
date	86.12.30.17.47.07;	author mike;	state Rel1;
branches;
next	4.1;

4.1
date	86.12.29.02.52.03;	author mike;	state Rel1;
branches;
next	1.1;

1.1
date	86.12.26.22.37.25;	author mike;	state Exp;
branches;
next	;


desc
@SGI-specific routines
@


11.4
log
@moved to src/fbed/
@
text
@/*
	SCCS id:	@@(#) sgi_dep.c	2.3
	Modified: 	1/5/87 at 16:57:35
	Retrieved: 	1/5/87 at 16:58:20
	SCCS archive:	/vld/moss/src/fbed/s.sgi_dep.c

	Author:		Gary S. Moss
			U. S. Army Ballistic Research Laboratory
			Aberdeen Proving Ground
			Maryland 21005-5066
			(301)278-6651 or DSN 298-6651
*/
#if ! defined( lint )
static const char RCSid[] = "@@(#) sgi_dep.c 2.3, modified 1/5/87 at 16:57:35, archive /vld/moss/src/fbed/s.sgi_dep.c";
#endif

#ifdef HAVE_CONFIG_H
# include "config.h"
#endif



#if HAS_SGIGL

#include <stdio.h>
#include <device.h>

#include "machine.h"
#include "externs.h"
#include "fb.h"

#include "./std.h"
#include "./ascii.h"
#include "./font.h"
#include "./try.h"
#include "./extern.h"

int
sgi_Empty()
	{	short	val;
		long	dev;
	winattach();
	if( qtest() )
		{
		if( (dev = qread( &val )) == KEYBD )
			{
			qenter( (short) dev, val );
			return 0;
			}
		else
			qenter( (short) dev, val );
		}
	return 1;
	}

void
sgi_Init()
	{
	qdevice( KEYBD );
	qdevice( MOUSEX );
	qdevice( MOUSEY );
	}

int
sgi_Getchar()
	{	short	val;
	winattach();
	for( ; ; )
		{	long	dev = qread( &val );
		switch( dev )
			{
		case KEYBD :
			return (int) val;
			}
		}
	}

int
sgi_Mouse_Pos( pointp )
register Point *pointp;
	{	static Point mouse;
		Point image;
		long	ox, oy;
		int change_flag = false;
	if( getbutton( MIDDLEMOUSE ) )
		{
		while( getbutton( MIDDLEMOUSE ) )
			; /* Wait for user to let go. */
		return 1;
		}
	image.p_x = getvaluator( MOUSEX );
	image.p_y = getvaluator( MOUSEY );
	if( image.p_x != mouse.p_x || image.p_y != mouse.p_y )
		mouse = image; /* Only use mouse if position changes. */
	else
		return -1;

	/* Transform screen to image coords. */
	getorigin( &ox, &oy );
	image.p_x -= ox;
	image.p_y -= oy;

	/* Ignore input if mouse is off of image. */
	if(	image.p_x < 0 || image.p_x >= fb_getwidth( fbp )
	   ||	image.p_y < 0 || image.p_y >= fb_getheight( fbp )
		)
		return -1;

	/* Adjust coordinates per windowing and zoom factor. */
	image.p_x = windo_anchor.p_x +
			(image.p_x-image_center.p_x)/zoom_factor;
	image.p_y = windo_anchor.p_y +
			(image.p_y-image_center.p_y)/zoom_factor;

	/* If position indicated by mouse is different than the current
		point position, then update current point. */
	if( image.p_x != pointp->p_x )
		{
		pointp->p_x = image.p_x;
		change_flag = true;
		}
	if( image.p_y != pointp->p_y )
		{
		pointp->p_y = image.p_y;
		change_flag = true;
		}
	return change_flag ? 2 : -1;
	}
#endif
@


11.3
log
@change conf.h to a wrapped config.h
@
text
@@


11.2
log
@Lint
@
text
@d17 5
a21 1
#include "conf.h"
@


11.1
log
@Release_4.4
@
text
@d14 1
a14 2
static
char sccsTag[] = "@@(#) sgi_dep.c 2.3, modified 1/5/87 at 16:57:35, archive /vld/moss/src/fbed/s.sgi_dep.c";
@


10.4
log
@GL
@
text
@@


10.3
log
@Made includes explicit
@
text
@d20 1
a20 1
#if defined(sgi) || defined(__sgi)
@


10.2
log
@Fixed fb_Setup() to set global flag (isSGI) when running on an SGI
with graphics.  This fixes the problem of getting a "CPS initialization"
error when running over a remote connection from an SGI.  #ifdef sgi
was used previously throughout the code rather than checking the name
of the device.
@
text
@d18 2
d21 1
d24 3
d28 5
@


10.1
log
@Release_4.0
@
text
@d52 8
a59 11
	{	extern FBIO *fbp;
	if( fbp != FBIO_NULL && strncmp( fbp->if_name, "/dev/sgi", 8 ) == 0 )
		{	short	val;
		winattach();
		for( ; ; )
			{	long	dev = qread( &val );
			switch( dev )
				{
			case KEYBD :
				return (int) val;
				}
a61 2
	else
		return getchar();
@


9.3
log
@Updated cpp symbol for Irix 4.0 (Cypress)
@
text
@@


9.2
log
@Added some commands: draw-rectangle, fill-bounded-region, print-comment,
	change-region-color, set-tolerance-color-match.
Also, default rectangle is entire window.
Checked in for release 4.0.
@
text
@d18 1
a18 1
#ifdef sgi
@


9.1
log
@Release_3.5
@
text
@d11 1
a11 1
			(301)278-6647 or AV-298-6647
d15 1
a15 1
char	sccsTag[] = "@@(#) sgi_dep.c 2.3, modified 1/5/87 at 16:57:35, archive /vld/moss/src/fbed/s.sgi_dep.c";
d34 1
a34 1
			return	0;
d39 1
a39 1
	return	1;
d52 1
a52 1
	{	extern FBIO	*fbp;
d61 1
a61 1
				return	(int) val;
d66 1
a66 1
		return	getchar();
d71 3
a73 3
register Point	*pointp;
	{	static Point	mouse;
		Point	image;
d75 1
a75 1
		int	change_flag = false;
d79 2
a80 2
			; /* Wait for user to let go.			*/
		return	1;
d85 1
a85 1
		mouse = image; /* Only use mouse if position changes.	*/
d87 1
a87 1
		return	-1;
d89 1
a89 1
	/* Transform screen to image coords.				*/
d94 1
a94 1
	/* Ignore input if mouse is off of image.			*/
d98 1
a98 1
		return	-1;
d100 1
a100 1
	/* Adjust coordinates per windowing and zoom factor.		*/
d107 1
a107 1
		point position, then update current point.		*/
d118 1
a118 1
	return	change_flag ? 2 : -1;
@


8.1
log
@Release_3.0
@
text
@@


7.1
log
@Release 2.3
@
text
@@


6.1
log
@Release 2.0
@
text
@@


5.1
log
@Release 1.24
@
text
@@


4.4
log
@Release 1.20 -- First Formal Release
@
text
@@


4.3
log
@Added support for mouse in cursor movement and point picking.
@
text
@@


4.2
log
@Latest versions from Moss
@
text
@d2 3
a4 3
	SCCS id:	@@(#) sgi_dep.c	2.2
	Modified: 	12/29/86 at 11:20:24
	Retrieved: 	12/30/86 at 17:02:29
d15 1
a15 1
char	sccsTag[] = "@@(#) sgi_dep.c 2.2, modified 12/29/86 at 11:20:24, archive /vld/moss/src/fbed/s.sgi_dep.c";
d17 1
d19 1
d22 20
d46 2
d56 8
a63 3
		while( qread( &val ) != KEYBD )
			;
		return	(int) val;
d67 52
@


4.1
log
@BRL CAD Distribution Release 1.10
@
text
@d2 3
a4 3
	SCCS id:	@@(#) sgi_dep.c	2.1
	Modified: 	12/9/86 at 15:58:22
	Retrieved: 	12/26/86 at 21:54:43
d15 1
a15 1
char	sccsTag[] = "@@(#) sgi_dep.c 2.1, modified 12/9/86 at 15:58:22, archive /vld/moss/src/fbed/s.sgi_dep.c";
d19 1
d28 10
a37 5
	{	short	val;
	winattach();
	while( qread( &val ) != KEYBD )
		;
	return	(int) val;
@


1.1
log
@Latest version from Gary Moss
@
text
@@
