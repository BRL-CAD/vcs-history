head	14.5;
access;
symbols
	rel-7-10-4:14.4
	STABLE:14.4.0.2
	rel-7-10-2:14.3;
locks; strict;
comment	@ * @;


14.5
date	2007.09.14.15.21.00;	author erikgreenwald;	state Exp;
branches;
next	14.4;

14.4
date	2007.08.18.09.11.09;	author brlcad;	state Exp;
branches;
next	14.3;

14.3
date	2007.05.25.03.16.54;	author brlcad;	state Exp;
branches;
next	14.2;

14.2
date	2007.04.18.04.03.11;	author brlcad;	state Exp;
branches;
next	14.1;

14.1
date	2007.04.16.21.15.35;	author brlcad;	state Exp;
branches;
next	;


desc
@@


14.5
log
@removed trailing whitespace
@
text
@/*                B R L C A D _ V E R S I O N . H
 * BRL-CAD
 *
 * Copyright (c) 2007 United States Government as represented by
 * the U.S. Army Research Laboratory.
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public License
 * version 2.1 as published by the Free Software Foundation.
 *
 * This library is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this file; see the file named COPYING for more
 * information.
 */
/** @@file brlcad_version.h
 *
 * PRIVATE container header for determining compile-time version
 * information about BRL-CAD.
 *
 * External applications should NOT use or include this file.  They
 * should use the library-specific LIBRARY_version() functions.
 * (e.g. bu_version())
 *
 * Author -
 *   Christopher Sean Morrison
 */

#include "common.h"

/* for snprintf */
#include <stdio.h>


/* FIXED VALUES */

/**
 * MAJOR.minor.patch version number
 *
 * should be an unquoted integer
 */
#ifndef BRLCAD_MAJOR
static const int BRLCAD_MAJOR =
#include "conf/MAJOR"
;
#endif

/**
 * major.MINOR.patch version number
 *
 * should be an unquoted integer
 */
#ifndef BRLCAD_MINOR
static const int BRLCAD_MINOR =
#include "conf/MINOR"
;
#endif

/**
 * major.minor.PATCH version number
 *
 * should be an unquoted integer
 */
#ifndef BRLCAD_PATCH
static const int BRLCAD_PATCH =
#include "conf/PATCH"
;
#endif


/* DYNAMIC VALUES */

/**
 * compilation count, updated every time a build pass occurs
 *
 * should be an unquoted integer
 */
#ifndef BRLCAD_COUNT
static const int BRLCAD_COUNT =
#include "conf/COUNT"
;
#endif

/**
 * compilation date, updated every time a build pass occurs
 *
 * should be a quoted value
 */
#ifndef BRLCAD_DATE
static const char BRLCAD_DATE[256] = {
#include "conf/DATE"
};
#endif

/**
 * compilation host, updated every time a build pass occurs
 *
 * should be a quoted value
 */
#ifndef BRLCAD_HOST
static const char BRLCAD_HOST[256] = {
#include "conf/HOST"
};
#endif

/**
 * configured installation path, updated every time a build pass
 * occurs
 *
 * should be a quoted value
 */
#ifndef BRLCAD_PATH
static const char BRLCAD_PATH[256] = {
#include "conf/PATH"
};
#endif

/**
 * compilation user, updated every time a build pass occurs
 *
 * should be a quoted value
 */
#ifndef BRLCAD_USER
static const char BRLCAD_USER[256] = {
#include "conf/USER"
};
#endif


/**
 * provides the version string in MAJOR.MINOR.PATCH triplet form.
 */
static const char *
brlcad_version(void)
{
    static char version[32] = {0};

    if (version[0] == 0) {
	snprintf(version, 32, "%d.%d.%d", BRLCAD_MAJOR, BRLCAD_MINOR, BRLCAD_PATCH);
    }

    return version;
}


/**
 * provides the release identifier details along with basic
 * configuration and compilation information.
 */
static const char *
brlcad_ident(const char *title)
{
    static char version[1024] = {0};
    static char label[64] = {0};

    if (title) {
	snprintf(label, 64, "  %s", title);
    }

    if (version[0] == 0) {
	snprintf(version, 1024,
		 "BRL-CAD Release %s%s\n"
		 "    %s, Compilation %d\n"
		 "    %s@@%s:%s\n",
		 brlcad_version(), label,
		 BRLCAD_DATE, BRLCAD_COUNT,
		 BRLCAD_USER, BRLCAD_HOST, BRLCAD_PATH
		 );
    }

    return version;
}


/*
 * Local Variables:
 * tab-width: 8
 * mode: C
 * c-basic-offset: 4
 * indent-tabs-mode: t
 * End:
 * ex: shiftwidth=4 tabstop=8
 */
@


14.4
log
@quell unused warning
@
text
@d159 1
a159 1
    
d163 1
a163 1
	    
d165 1
a165 1
	snprintf(version, 1024, 
@


14.3
log
@fix horrible, horrible oversight typo that prevents brlcad_version() from working
@
text
@d166 1
a166 1
		 "BRL-CAD Release %d.%d.%d%s\n"
d169 1
a169 1
		 BRLCAD_MAJOR, BRLCAD_MINOR, BRLCAD_PATCH, label,
@


14.2
log
@distinguish between the full release identifier block and just the version number itself via brlcad_ident() and brlcad_version() respectively.
@
text
@d142 1
a142 1
    if (version[0] = 0) {
@


14.1
log
@revamp BRL-CAD's versioning setup.  no longer rely upon the vers.sh script, allowing for a more unified cross-platform configuration.  instead of globals, provide per-library functions that return the version string.  the version numbers are now stored in files in include/conf/.
@
text
@d135 1
a135 2
 * provides the version of BRL-CAD along with basic configuration and
 * compilation details.
d138 19
a156 1
brlcad_version(const char *title) {
d174 1
a178 1

@

