head	14.51;
access;
symbols
	rel-7-10-4:14.48
	STABLE:14.48.0.2
	stable-branch:14.22
	rel-7-10-2:14.48
	rel-7-10-0:14.39
	rel-7-8-4:14.37
	rel-7-8-2:14.36
	rel-7-8-0:14.36
	trimnurbs-branch:14.36.0.2
	help:14.36
	temp_tag:14.34
	bobWinPort-20051223-freeze:14.30
	postmerge-20051223-bobWinPort:14.34
	premerge-20051223-bobWinPort:14.34
	rel-7-6-6:14.34
	rel-7-6-4:14.34
	rel-7-6-2:14.31
	rel-7-6-branch:14.31.0.2
	rel-7-6-0:14.31
	rel-7-4-2:14.29.2.1
	rel-7-4-branch:14.29.0.2
	bobWinPort:14.30.0.2
	rel-7-4-0:14.29
	rel-7-2-6:14.24
	rel-7-2-4:14.22
	rel-7-2-2:14.18
	rel-7-2-0:14.8
	rel-7-0-4:14.1
	rel-7-0-2:14.1
	rel-7-0-1:14.1
	opensource-post:14.1
	opensource-pre:11.24
	rel-7-0-branch:11.24.0.2
	rel-7-0:11.24
	postmerge-20040405-ansi:11.2
	premerge-20040404-ansi:11.2
	postmerge-autoconf:11.1
	autoconf-freeze:1.1.2.19
	autoconf-20031203:1.1.2.3
	autoconf-20031202:1.1.2.3
	autoconf-branch:1.1.0.2;
locks; strict;
comment	@# @;


14.51
date	2007.12.04.19.54.06;	author brlcad;	state Exp;
branches;
next	14.50;

14.50
date	2007.11.20.20.47.03;	author brlcad;	state Exp;
branches;
next	14.49;

14.49
date	2007.10.03.19.35.55;	author brlcad;	state Exp;
branches;
next	14.48;

14.48
date	2007.05.26.14.28.49;	author brlcad;	state Exp;
branches;
next	14.47;

14.47
date	2007.05.20.19.31.11;	author brlcad;	state Exp;
branches;
next	14.46;

14.46
date	2007.05.19.02.27.56;	author brlcad;	state Exp;
branches;
next	14.45;

14.45
date	2007.05.19.01.45.40;	author brlcad;	state Exp;
branches;
next	14.44;

14.44
date	2007.05.19.01.44.23;	author brlcad;	state Exp;
branches;
next	14.43;

14.43
date	2007.04.19.21.38.46;	author erikgreenwald;	state Exp;
branches;
next	14.42;

14.42
date	2007.04.18.03.25.48;	author brlcad;	state Exp;
branches;
next	14.41;

14.41
date	2007.04.17.18.46.24;	author erikgreenwald;	state Exp;
branches;
next	14.40;

14.40
date	2007.04.17.18.43.00;	author erikgreenwald;	state Exp;
branches;
next	14.39;

14.39
date	2007.01.27.01.41.28;	author brlcad;	state Exp;
branches;
next	14.38;

14.38
date	2007.01.20.14.10.40;	author brlcad;	state Exp;
branches;
next	14.37;

14.37
date	2006.08.31.05.54.16;	author lbutler;	state Exp;
branches;
next	14.36;

14.36
date	2006.01.21.00.58.06;	author brlcad;	state Exp;
branches;
next	14.35;

14.35
date	2006.01.18.06.46.09;	author brlcad;	state Exp;
branches;
next	14.34;

14.34
date	2005.11.10.09.58.57;	author brlcad;	state Exp;
branches;
next	14.33;

14.33
date	2005.10.23.04.44.25;	author brlcad;	state Exp;
branches;
next	14.32;

14.32
date	2005.09.16.18.28.19;	author brlcad;	state Exp;
branches;
next	14.31;

14.31
date	2005.08.24.20.37.01;	author lbutler;	state Exp;
branches
	14.31.2.1;
next	14.30;

14.30
date	2005.07.16.19.48.01;	author brlcad;	state Exp;
branches;
next	14.29;

14.29
date	2005.07.06.23.05.13;	author brlcad;	state Exp;
branches
	14.29.2.1;
next	14.28;

14.28
date	2005.06.27.04.26.23;	author brlcad;	state Exp;
branches;
next	14.27;

14.27
date	2005.06.25.15.55.57;	author brlcad;	state Exp;
branches;
next	14.26;

14.26
date	2005.06.24.23.45.17;	author brlcad;	state Exp;
branches;
next	14.25;

14.25
date	2005.06.12.21.21.18;	author brlcad;	state Exp;
branches;
next	14.24;

14.24
date	2005.06.09.02.18.51;	author brlcad;	state Exp;
branches;
next	14.23;

14.23
date	2005.06.07.23.38.37;	author brlcad;	state Exp;
branches;
next	14.22;

14.22
date	2005.04.13.22.25.34;	author brlcad;	state Exp;
branches;
next	14.21;

14.21
date	2005.04.12.04.00.49;	author brlcad;	state Exp;
branches;
next	14.20;

14.20
date	2005.04.10.20.43.11;	author brlcad;	state Exp;
branches;
next	14.19;

14.19
date	2005.04.06.04.08.27;	author brlcad;	state Exp;
branches;
next	14.18;

14.18
date	2005.03.29.06.12.53;	author brlcad;	state Exp;
branches;
next	14.17;

14.17
date	2005.03.29.04.44.35;	author brlcad;	state Exp;
branches;
next	14.16;

14.16
date	2005.03.29.04.41.31;	author brlcad;	state Exp;
branches;
next	14.15;

14.15
date	2005.03.29.04.15.45;	author brlcad;	state Exp;
branches;
next	14.14;

14.14
date	2005.03.21.23.46.09;	author brlcad;	state Exp;
branches;
next	14.13;

14.13
date	2005.03.11.14.15.46;	author brlcad;	state Exp;
branches;
next	14.12;

14.12
date	2005.03.11.05.17.29;	author brlcad;	state Exp;
branches;
next	14.11;

14.11
date	2005.03.01.07.41.25;	author brlcad;	state Exp;
branches;
next	14.10;

14.10
date	2005.02.23.08.21.05;	author brlcad;	state Exp;
branches;
next	14.9;

14.9
date	2005.02.23.06.24.28;	author brlcad;	state Exp;
branches;
next	14.8;

14.8
date	2005.02.22.08.11.10;	author brlcad;	state Exp;
branches;
next	14.7;

14.7
date	2005.02.19.16.08.11;	author brlcad;	state Exp;
branches;
next	14.6;

14.6
date	2005.02.17.23.11.31;	author lbutler;	state Exp;
branches;
next	14.5;

14.5
date	2005.02.11.15.14.46;	author brlcad;	state Exp;
branches;
next	14.4;

14.4
date	2005.02.11.14.59.52;	author brlcad;	state Exp;
branches;
next	14.3;

14.3
date	2005.01.31.06.36.19;	author brlcad;	state Exp;
branches;
next	14.2;

14.2
date	2005.01.30.04.41.44;	author brlcad;	state Exp;
branches;
next	14.1;

14.1
date	2004.11.16.19.42.08;	author morrison;	state Exp;
branches;
next	11.24;

11.24
date	2004.10.29.13.46.26;	author morrison;	state Exp;
branches;
next	11.23;

11.23
date	2004.10.15.19.53.41;	author butler;	state Exp;
branches;
next	11.22;

11.22
date	2004.10.14.20.42.34;	author morrison;	state Exp;
branches;
next	11.21;

11.21
date	2004.10.07.14.52.48;	author morrison;	state Exp;
branches;
next	11.20;

11.20
date	2004.10.07.03.48.14;	author morrison;	state Exp;
branches;
next	11.19;

11.19
date	2004.10.07.00.46.25;	author morrison;	state Exp;
branches;
next	11.18;

11.18
date	2004.10.06.14.31.03;	author morrison;	state Exp;
branches;
next	11.17;

11.17
date	2004.09.24.14.51.28;	author morrison;	state Exp;
branches;
next	11.16;

11.16
date	2004.09.05.06.48.41;	author morrison;	state Exp;
branches;
next	11.15;

11.15
date	2004.07.27.20.46.52;	author morrison;	state Exp;
branches;
next	11.14;

11.14
date	2004.07.27.20.30.58;	author morrison;	state Exp;
branches;
next	11.13;

11.13
date	2004.07.25.10.19.54;	author morrison;	state Exp;
branches;
next	11.12;

11.12
date	2004.07.25.08.17.19;	author morrison;	state Exp;
branches;
next	11.11;

11.11
date	2004.06.22.17.39.42;	author morrison;	state Exp;
branches;
next	11.10;

11.10
date	2004.05.24.17.53.23;	author morrison;	state Exp;
branches;
next	11.9;

11.9
date	2004.05.13.15.20.44;	author morrison;	state Exp;
branches;
next	11.8;

11.8
date	2004.05.12.17.21.30;	author morrison;	state Exp;
branches;
next	11.7;

11.7
date	2004.05.12.04.26.29;	author morrison;	state Exp;
branches;
next	11.6;

11.6
date	2004.05.11.12.17.12;	author morrison;	state Exp;
branches;
next	11.5;

11.5
date	2004.05.07.19.32.26;	author erikg;	state Exp;
branches;
next	11.4;

11.4
date	2004.04.06.18.46.07;	author morrison;	state Exp;
branches;
next	11.3;

11.3
date	2004.04.06.18.40.33;	author morrison;	state Exp;
branches;
next	11.2;

11.2
date	2004.03.31.20.22.45;	author erikg;	state Exp;
branches;
next	11.1;

11.1
date	2004.03.18.18.15.13;	author erikg;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.08.16.57.34;	author erikg;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.10.08.16.57.34;	author erikg;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2003.11.14.19.30.18;	author erikg;	state Exp;
branches;
next	1.1.2.3;

1.1.2.3
date	2003.12.02.19.33.51;	author erikg;	state Exp;
branches;
next	1.1.2.4;

1.1.2.4
date	2003.12.04.16.00.11;	author erikg;	state Exp;
branches;
next	1.1.2.5;

1.1.2.5
date	2003.12.04.19.19.51;	author erikg;	state Exp;
branches;
next	1.1.2.6;

1.1.2.6
date	2003.12.05.18.41.42;	author erikg;	state Exp;
branches;
next	1.1.2.7;

1.1.2.7
date	2003.12.08.21.10.04;	author erikg;	state Exp;
branches;
next	1.1.2.8;

1.1.2.8
date	2003.12.10.18.34.54;	author erikg;	state Exp;
branches;
next	1.1.2.9;

1.1.2.9
date	2003.12.15.20.01.33;	author erikg;	state Exp;
branches;
next	1.1.2.10;

1.1.2.10
date	2003.12.15.20.36.11;	author erikg;	state Exp;
branches;
next	1.1.2.11;

1.1.2.11
date	2003.12.23.16.13.40;	author erikg;	state Exp;
branches;
next	1.1.2.12;

1.1.2.12
date	2003.12.23.21.30.40;	author erikg;	state Exp;
branches;
next	1.1.2.13;

1.1.2.13
date	2003.12.24.19.19.26;	author erikg;	state Exp;
branches;
next	1.1.2.14;

1.1.2.14
date	2003.12.31.18.37.14;	author erikg;	state Exp;
branches;
next	1.1.2.15;

1.1.2.15
date	2004.01.07.18.17.41;	author erikg;	state Exp;
branches;
next	1.1.2.16;

1.1.2.16
date	2004.01.07.21.05.12;	author erikg;	state Exp;
branches;
next	1.1.2.17;

1.1.2.17
date	2004.02.25.15.23.50;	author erikg;	state Exp;
branches;
next	1.1.2.18;

1.1.2.18
date	2004.03.15.14.17.59;	author erikg;	state Exp;
branches;
next	1.1.2.19;

1.1.2.19
date	2004.03.16.13.09.58;	author erikg;	state Exp;
branches;
next	;

14.29.2.1
date	2005.08.16.21.03.44;	author brlcad;	state Exp;
branches;
next	;

14.31.2.1
date	2005.11.13.13.46.08;	author brlcad;	state Exp;
branches;
next	;


desc
@@


14.51
log
@update the helper build scripts to the new version variables now that MAJOR_, MINOR_, and PATCH_ are no longer being individually subst'd.  simplify them to only require a single version number in triplet form instead of separated out individually (only mac make_pkg script needed it broken up anyways).
@
text
@#                     M A K E F I L E . A M
# BRL-CAD
#
# Copyright (c) 2005-2007 United States Government as represented by
# the U.S. Army Research Laboratory.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the above copyright
# notice, this list of conditions and the following disclaimer.
#
# 2. Redistributions in binary form must reproduce the above
# copyright notice, this list of conditions and the following
# disclaimer in the documentation and/or other materials provided
# with the distribution.
#
# 3. The name of the author may not be used to endorse or promote
# products derived from this software without specific prior written
# permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
# OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
# DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
# GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
# NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
###
# $Id: Makefile.am,v 14.50 2007/11/20 20:47:03 brlcad Exp $

AUTOMAKE_OPTIONS = 1.6 dist-zip dist-bzip2
ACLOCAL_AMFLAGS = -I m4

required_dirs = \
	include \
	src

bench_dirs = \
	bench \
	db \
	pix

other_dirs = \
	doc \
	m4 \
	misc \
	regress \
	sh

if ONLY_BENCHMARK
SUBDIRS = \
	$(required_dirs) \
	$(bench_dirs)

else !ONLY_BENCHMARK

if ONLY_RTS
SUBDIRS = \
	$(required_dirs)

else !ONLY_RTS
SUBDIRS = \
	$(required_dirs) \
	$(bench_dirs) \
	$(other_dirs)

endif
# ONLY_RTS

endif
# ONLY_BENCHMARK


DIST_SUBDIRS = \
	$(required_dirs) \
	$(bench_dirs) \
	$(other_dirs)

documentationdir = $(BRLCAD_DATA)

documentation_DATA = \
	AUTHORS \
	COPYING \
	HACKING \
	INSTALL \
	NEWS \
	README

EXTRA_DIST = \
	$(documentation_DATA) \
	BUGS \
	ChangeLog \
	TODO \
	autogen.sh \
	libtool

DISTCLEANFILES = \
	$(CONFIG_CACHE) \
	aclocal.m4 \
	config.log \
	config.status \
	configure \
	install.$(host_triplet).log \
	libtool \
	so_locations


##########################
# packaged distributions #
##########################

$(PACKAGE)-$(BRLCAD_VERSION).tar.gz: dist

# Build a Mac OS X Installer .pkg -- make sure the package resources
# reflect the correct version.  we specifically do not use an autoconf
# template so that the file may be edited without doing a configure
# (which would also cause a need to regenerate the template to keep in
# sync every time it's edited).
$(PACKAGE_NAME)-$(BRLCAD_VERSION).pkg:
	@@if ! test -f "install.$(host_triplet).log" ; then \
	  $(ECHO) ; \
	  $(ECHO) "}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}" ; \
	  $(ECHO) "  WARNING: It seems as though you might not have" ; \
	  $(ECHO) "           installed BRL-CAD yet?" ; \
	  $(ECHO) ; \
	  $(ECHO) "  You should run 'make install' before creating a" ; \
	  $(ECHO) "  binary distribution package.  Trying regardless." ; \
	  $(ECHO) "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{" ; \
	  $(ECHO) ; \
	fi
	@@$(ECHO) "Building an Installer package for Mac OS X"
	@@$(ECHO)
	@@$(ECHO) "Warning: this package target presently assumes that the install directory"
	@@$(ECHO) "         does not contain extra files and comprises a full clean install."
	@@$(ECHO)
	@@if test -f "$(top_srcdir)/misc/macosx/Resources/ReadMe.rtfd/TXT.rtf" ; then \
	  perl -pi -e "s/BRL-CAD [0-9]*\.[0-9]*\.[0-9]/BRL-CAD $(BRLCAD_VERSION)/g" $(top_srcdir)/misc/macosx/Resources/ReadMe.rtfd/TXT.rtf ; \
	fi
	@@if test -f "$(top_srcdir)/misc/macosx/Resources/Welcome.rtfd/TXT.rtf" ; then \
	  perl -pi -e "s/BRL-CAD [0-9]*\.[0-9]*\.[0-9]/BRL-CAD $(BRLCAD_VERSION)/g" $(top_srcdir)/misc/macosx/Resources/Welcome.rtfd/TXT.rtf ; \
	fi
	@@${SH} $(top_srcdir)/sh/make_pkg.sh "$(PACKAGE_NAME)" "$(BRLCAD_VERSION)" "$(DESTDIR)$(prefix)" "$(top_srcdir)/misc/macosx/Resources"

openUp:
	cd misc/macosx && make openUp

$(PACKAGE_NAME)-$(BRLCAD_VERSION).dmg: $(PACKAGE_NAME)-$(BRLCAD_VERSION).pkg openUp
	@@$(ECHO) "Building a Disk Image for Mac OS X"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_dmg.sh "$(PACKAGE_NAME)" "$(BRLCAD_VERSION)" "$(top_srcdir)/misc/macosx/background.png"

# using home is probably not a great choice..
$(PACKAGE)-$(BRLCAD_VERSION).rpm: $(PACKAGE)-$(BRLCAD_VERSION).tar.gz
	@@$(ECHO) "Building binary RPM for RedHat Linux"
	@@$(ECHO)
	@@CP@@ $(PACKAGE)-$(BRLCAD_VERSION).tar.gz ${HOME}/rpm/SOURCES/
	rpmbuild -ba $(top_builddir)/misc/brlcad.spec
	@@CP@@ ${HOME}/rpm/RPMS/i386/$(PACKAGE)-$(BRLCAD_VERSION)-*.i386.rpm .
	@@touch $(PACKAGE)-$(BRLCAD_VERSION).rpm
	@@$(ECHO) "WARNING: Fake make placeholder created as $(PACKAGE)-$(BRLCAD_VERSION).rpm"
	@@$(ECHO)

# using home is probably not a great choice..
$(PACKAGE)-$(BRLCAD_VERSION).src.rpm: $(PACKAGE)-$(BRLCAD_VERSION).tar.gz
	@@$(ECHO) "Building source RPM for RedHat Linux"
	@@CP@@ $(PACKAGE)-$(BRLCAD_VERSION).tar.gz ${HOME}/rpm/SOURCES/
	rpmbuild -ba $(top_builddir)/misc/brlcad.spec
	@@CP@@ ${HOME}/rpm/SRPMS/$(PACKAGE)-$(BRLCAD_VERSION)-*.src.rpm .
	@@touch $(PACKAGE)-$(BRLCAD_VERSION).src.rpm
	@@$(ECHO) "WARNING: Fake make placeholder created as $(PACKAGE)-$(BRLCAD_VERSION).src.rpm"
	@@$(ECHO)

$(PACKAGE)-$(BRLCAD_VERSION).deb:
	@@$(ECHO) "Building a package for Debian Linux"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_deb.sh "$(PACKAGE_NAME)-$(BRLCAD_VERSION)"

$(PACKAGE)-$(BRLCAD_VERSION).bin.zip:
	@@if ! test -f "install.$(host_triplet).log" ; then \
	  $(ECHO) ; \
	  $(ECHO) "}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}" ; \
	  $(ECHO) "  WARNING: It seems as though you might not have" ; \
	  $(ECHO) "           installed BRL-CAD yet?" ; \
	  $(ECHO) ; \
	  $(ECHO) "  You should run 'make install' before creating a" ; \
	  $(ECHO) "  binary distribution package.  Trying regardless." ; \
	  $(ECHO) "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{" ; \
	  $(ECHO) ; \
	fi
	@@$(ECHO) "Building a zip-compressed file archive"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_zip.sh "$(PACKAGE_NAME)-$(BRLCAD_VERSION)"
	@@$(ECHO)
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(BRLCAD_VERSION).bin.zip for $(host_triplet)"

 $(PACKAGE)-$(BRLCAD_VERSION).bin.tar.gz: $(PACKAGE)-$(BRLCAD_VERSION).bin.tar
	@@$(ECHO) "Building a gzip-compressed tape archive"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_tgz.sh "$(PACKAGE_NAME)-$(BRLCAD_VERSION)"
	@@$(ECHO)
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(BRLCAD_VERSION).bin.tar.gz for $(host_triplet)"

 $(PACKAGE)-$(BRLCAD_VERSION).bin.tar.bz2: $(PACKAGE)-$(BRLCAD_VERSION).bin.tar
	@@$(ECHO) "Building a bzip2-compressed tape archive"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_bz2.sh "$(PACKAGE_NAME)-$(BRLCAD_VERSION)"
	@@$(ECHO)
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(BRLCAD_VERSION).bin.tar.bz2 for $(host_triplet)"

 $(PACKAGE)-$(BRLCAD_VERSION).bin.tar:
	@@if ! test -f "install.$(host_triplet).log" ; then \
	  $(ECHO) ; \
	  $(ECHO) "}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}" ; \
	  $(ECHO) "  WARNING: It seems as though you might not have" ; \
	  $(ECHO) "           installed BRL-CAD yet?" ; \
	  $(ECHO) ; \
	  $(ECHO) "  You should run 'make install' before creating a" ; \
	  $(ECHO) "  binary distribution package.  Trying regardless." ; \
	  $(ECHO) "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{" ; \
	  $(ECHO) ; \
	fi
	@@$(ECHO) "Building an uncompressed tape archive"
	@@$(ECHO)
	@@${SH} $(top_srcdir)/sh/make_tar.sh "$(PACKAGE_NAME)" "$(BRLCAD_VERSION)" "$(DESTDIR)$(prefix)"
	@@$(ECHO)
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(BRLCAD_VERSION).bin.tar for $(host_triplet)"


#############
# the rules #
#############

.PHONY : clobber benchmark bench regression regress test pkg dmg rpm deb zip tgz tbz

clobber:
	@@cd bench && make clobber

benchmark: all
	@@cd bench && make run

bench: benchmark

regression: all
	@@cd regress && make regression

dox : misc/Doxyfile misc/doxygen_structure
	doxygen misc/Doxyfile

regress: regression

test: regression

pkg: $(PACKAGE_NAME)-$(BRLCAD_VERSION).pkg
	@@$(ECHO) "Done."

dmg: pkg $(PACKAGE_NAME)-$(BRLCAD_VERSION).dmg
	@@$(ECHO) "Done."

rpm: $(PACKAGE)-$(BRLCAD_VERSION).rpm $(PACKAGE)-$(BRLCAD_VERSION).src.rpm
	@@$(ECHO) "Done."

deb: $(PACKAGE)-$(BRLCAD_VERSION).deb
	@@$(ECHO) "Done."

zip: $(PACKAGE)-$(BRLCAD_VERSION).bin.zip
	@@$(ECHO) "Done."

tgz: $(PACKAGE)-$(BRLCAD_VERSION).bin.tar.gz
	@@$(ECHO) "Done."

bz2: $(PACKAGE)-$(BRLCAD_VERSION).bin.tar.bz2
	@@$(ECHO) "Done."

tar: $(PACKAGE)-$(BRLCAD_VERSION).bin.tar
	@@$(ECHO) "Done."

package:
	@@$(ECHO)
	@@$(ECHO) "To build a BRL-CAD package for distribution, there are various make"
	@@$(ECHO) "targets available for various platforms:"
	@@$(ECHO)
	@@$(ECHO) "  make pkg	-	Builds an Installer package for Mac OS X"
	@@$(ECHO) "  make dmg	-	Builds a Disk Image for Mac OS X"
	@@$(ECHO) "  make rpm	-	Builds source and binary RPM for RedHat Linux"
	@@$(ECHO) "  make deb	-	Builds a package for Debian Linux"
	@@$(ECHO) "  make zip	-	Builds a zip-compressed file archive"
	@@$(ECHO) "  make tgz	-	Builds a gzip-compressed tape archive"
	@@$(ECHO) "  make bz2	-	Builds a bzip2-compressed tape archive"
	@@$(ECHO) "  make tar	-	Builds a uncompressed tape archive"
	@@$(ECHO)

# delete files that should not be in the distribution
dist-hook:
	files="`find . -name Entries -exec grep -v '^D' {} /dev/null \; | sed 's/:\(\/[^\/]*\)\/.*/\1/g' | sed 's/\/CVS\/Entries//g' | grep -v 'brlcad-' | grep -v .cvsignore`" ; \
	missing=0 ; \
	for file in $$files ; do \
		if test ! -f $(distdir)/$$file ; then \
			missing=1 ; \
			echo "MISSING FROM DIST: $$file" ; \
		fi ; \
	done ; \
	if test "x$$missing" = "x1" ; then \
		exit 1 ; \
	fi
	find $(distdir) -type f \( -name '.cvsignore' -or -name 'brlcad_config.h' \) -exec rm -f {} \;
	find $(distdir) -type d \( -name 'CVS' -or -name '.svn' \) -prune -exec rm -rf {} \;


##########################
# summaries and warnings #
##########################

# make sure a dangerous umask will not prevent others from using an
# installed version by checking to make sure the exec mode is set.
# We minimally check only the binary and prefix directories.
install-data-local:
	@@warn_umask=no ; \
	case `ls -ld $(DESTDIR)$(prefix)` in \
	  d????????-*) warn_umask=yes ;; \
	  d?????-???*) warn_umask=yes ;; \
	  d??-??????*) warn_umask=yes ;; \
	esac ; \
	if test "x$$warn_umask" = "xno" ; then \
	  case `ls -ld $(DESTDIR)$(bindir)` in \
	    d????????-*) warn_umask=yes ;; \
	    d?????-???*) warn_umask=yes ;; \
	    d??-??????*) warn_umask=yes ;; \
	  esac ; \
	fi ; \
	if test "x$$warn_umask" = "xyes" ; then \
	    $(ECHO) ; \
	    $(ECHO) "}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}" ; \
	    $(ECHO) "  WARNING: There is no execute permission on the" ; \
	    $(ECHO) "           install directory." ; \
	    $(ECHO) ; \
	    $(ECHO) "  Consider running \"umask 022\" before installing" ; \
	    $(ECHO) "  next time.  You should be able to repair this"; \
	    $(ECHO) "  installation's directory permissions with: " ; \
	    $(ECHO) ; \
	    $(ECHO) "    find $(DESTDIR)$(prefix)/. -type d -exec chmod go+x {} \;" ; \
	    if test -d "$(DESTDIR)$(bindir)" ; then \
	      if test "x$(DESTDIR)$(exec_prefix)/bin" != "x$(DESTDIR)$(bindir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(bindir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(sbindir)" ; then \
	      if test "x$(DESTDIR)$(exec_prefix)/sbin" != "x$(DESTDIR)$(sbindir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(sbindir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(libexecdir)" ; then \
	      if test "x$(DESTDIR)$(exec_prefix)/libexec" != "x$(DESTDIR)$(libexecdir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(libexecdir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(datadir)" ; then \
	      if test "x$(DESTDIR)$(prefix)/share" != "x$(DESTDIR)$(datadir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(prefix)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(libdir)" ; then \
	      if test "x$(DESTDIR)$(exec_prefix)/lib" != "x$(DESTDIR)$(libdir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(libdir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(mandir)" ; then \
	      if test "x$(DESTDIR)$(prefix)/man" != "x$(DESTDIR)$(mandir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(mandir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    if test -d "$(DESTDIR)$(includedir)" ; then \
	      if test "x$(DESTDIR)$(prefix)/include" != "x$(DESTDIR)$(includedir)" ; then \
		$(ECHO) "    find $(DESTDIR)$(includedir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
	    $(ECHO) ; \
	    $(ECHO) "  Do not presume the find example is all that is" ; \
	    $(ECHO) "  needed.  VERIFY THE PERMISSIONS." ; \
	    $(ECHO) "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{" ; \
	    $(ECHO) ; \
	fi ; \
	touch install.$(host_triplet).log ; \
	if test -w install.$(host_triplet).log ; then \
	    LC_ALL=C ; \
	    if test "x$USER" = "x" ; then \
		USER="unknown" ; \
	    fi ; \
	    $(ECHO) "Installed BRL-CAD Release @@BRLCAD_VERSION@@ Build @@CONFIG_DATE@@ by ${USER} to $(DESTDIR)$(prefix) on `date`" >> install.$(host_triplet).log ; \
	fi


# Print out an informative summary.  As just about everything seems to
# end up calling the all-am hook, which in turns calls the all-local
# hook.  The initial target goal is used to print out a custom summary
# message.  If the make being used doesn't set the MAKECMDGOALS
# variable, something generic is printed still.  For a make install,
# print out rule lines according to the size of the installation path
# to emphasize the achievement.
#
all-local:
	@@$(ECHO) "Done."
	@@$(ECHO)
	@@$(ECHO) "BRL-CAD Release @@BRLCAD_VERSION@@, Build @@CONFIG_DATE@@"
	@@$(ECHO)
	@@if test "x$(MAKECMDGOALS)" = "xall-am" -o "x$(.TARGETS)" = "xall-am" -o "x$(MAKECMDGOALS)" = "xfast" -o "x$(.TARGETS)" = "xfast" ; then \
	  $(ECHO) $(ECHO_N) "Elapsed compilation time: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/conf/DATE` ;\
	  $(ECHO) $(ECHO_N) "Elapsed time since configuration: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh @@CONFIG_TIME@@ ;\
	  $(ECHO) "---" ;\
	  $(ECHO) "Run 'make install' to begin installation into $(prefix)" ;\
	  $(ECHO) "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
	elif test "x$(MAKECMDGOALS)" = "xinstall-am" -o "x$(.TARGETS)" = "xinstall-am" ; then \
	  $(ECHO) $(ECHO_N) "Elapsed installation time: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/conf/DATE` ;\
	  $(ECHO) $(ECHO_N) "Elapsed time since configuration: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh @@CONFIG_TIME@@ ;\
	  $(ECHO) "---" ;\
	  $(ECHO) "Run 'make test' to run the BRL-CAD Test Suite" ;\
	  $(ECHO) "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
	  $(ECHO) ;\
	  line1="  BRL-CAD @@BRLCAD_VERSION@@ is now installed into $(prefix)" ;\
	  line2="  Be sure to add $(prefix)/bin to your PATH" ;\
	  separator="`$(ECHO) $$line1 | tr '[a-zA-Z0-9.\-/ ]' '*'`" ;\
	  $(ECHO) "$${separator}****" ;\
	  $(ECHO) "$$line1" ;\
	  $(ECHO) "$$line2" ;\
	  $(ECHO) "$${separator}****" ;\
	elif test "x$(MAKECMDGOALS)" = "x" -a "x$(.TARGETS)" = "x" ; then \
	  $(ECHO) $(ECHO_N) "Elapsed time: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/conf/DATE` ;\
	  $(ECHO) $(ECHO_N) "Elapsed time since configuration: " ;\
	  sh $(top_srcdir)/sh/elapsed.sh @@CONFIG_TIME@@ ;\
	  $(ECHO) "---" ;\
	  $(ECHO) "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
	fi
	@@$(ECHO)


include $(top_srcdir)/misc/Makefile.defs

# Local Variables:
# mode: Makefile
# tab-width: 8
# indent-tabs-mode: t
# End:
# ex: shiftwidth=8 tabstop=8
@


14.50
log
@enhance the dist hook so that it checks whether files listed in CVS are actually included in the source dist that we end  up with.  makes it a heck of a lot easier to ensure that we have all the files that we're supposed to come time to make a source release.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.49 2007/10/03 19:35:55 brlcad Exp $
d119 1
a119 1
$(PACKAGE)-$(VERSION).tar.gz: dist
d126 1
a126 1
$(PACKAGE_NAME)-$(VERSION).pkg:
d144 1
a144 1
	  perl -pi -e "s/BRL-CAD [0-9]*\.[0-9]*\.[0-9]/BRL-CAD $(VERSION)/g" $(top_srcdir)/misc/macosx/Resources/ReadMe.rtfd/TXT.rtf ; \
d147 1
a147 1
	  perl -pi -e "s/BRL-CAD [0-9]*\.[0-9]*\.[0-9]/BRL-CAD $(VERSION)/g" $(top_srcdir)/misc/macosx/Resources/Welcome.rtfd/TXT.rtf ; \
d149 1
a149 1
	@@${SH} $(top_srcdir)/sh/make_pkg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)" "$(top_srcdir)/misc/macosx/Resources"
d154 1
a154 1
$(PACKAGE_NAME)-$(VERSION).dmg: $(PACKAGE_NAME)-$(VERSION).pkg openUp
d157 1
a157 1
	@@${SH} $(top_srcdir)/sh/make_dmg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(top_srcdir)/misc/macosx/background.png"
d160 1
a160 1
$(PACKAGE)-$(VERSION).rpm: $(PACKAGE)-$(VERSION).tar.gz
d163 1
a163 1
	@@CP@@ $(PACKAGE)-$(VERSION).tar.gz ${HOME}/rpm/SOURCES/
d165 3
a167 3
	@@CP@@ ${HOME}/rpm/RPMS/i386/$(PACKAGE)-$(VERSION)-*.i386.rpm .
	@@touch $(PACKAGE)-$(VERSION).rpm
	@@$(ECHO) "WARNING: Fake make placeholder created as $(PACKAGE)-$(VERSION).rpm"
d171 1
a171 1
$(PACKAGE)-$(VERSION).src.rpm: $(PACKAGE)-$(VERSION).tar.gz
d173 1
a173 1
	@@CP@@ $(PACKAGE)-$(VERSION).tar.gz ${HOME}/rpm/SOURCES/
d175 3
a177 3
	@@CP@@ ${HOME}/rpm/SRPMS/$(PACKAGE)-$(VERSION)-*.src.rpm .
	@@touch $(PACKAGE)-$(VERSION).src.rpm
	@@$(ECHO) "WARNING: Fake make placeholder created as $(PACKAGE)-$(VERSION).src.rpm"
d180 1
a180 1
$(PACKAGE)-$(VERSION).deb:
d183 1
a183 1
	@@${SH} $(top_srcdir)/sh/make_deb.sh "$(PACKAGE_NAME)-$(VERSION)"
d185 1
a185 1
$(PACKAGE)-$(VERSION).bin.zip:
d199 1
a199 1
	@@${SH} $(top_srcdir)/sh/make_zip.sh "$(PACKAGE_NAME)-$(VERSION)"
d201 1
a201 1
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(VERSION).bin.zip for $(host_triplet)"
d203 1
a203 1
 $(PACKAGE)-$(VERSION).bin.tar.gz: $(PACKAGE)-$(VERSION).bin.tar
d206 1
a206 1
	@@${SH} $(top_srcdir)/sh/make_tgz.sh "$(PACKAGE_NAME)-$(VERSION)"
d208 1
a208 1
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(VERSION).bin.tar.gz for $(host_triplet)"
d210 1
a210 1
 $(PACKAGE)-$(VERSION).bin.tar.bz2: $(PACKAGE)-$(VERSION).bin.tar
d213 1
a213 1
	@@${SH} $(top_srcdir)/sh/make_bz2.sh "$(PACKAGE_NAME)-$(VERSION)"
d215 1
a215 1
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(VERSION).bin.tar.bz2 for $(host_triplet)"
d217 1
a217 1
 $(PACKAGE)-$(VERSION).bin.tar:
d231 1
a231 1
	@@${SH} $(top_srcdir)/sh/make_tar.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)"
d233 1
a233 1
	@@$(ECHO) "Built $(PACKAGE_NAME)-$(VERSION).bin.tar for $(host_triplet)"
d260 1
a260 1
pkg: $(PACKAGE_NAME)-$(VERSION).pkg
d263 1
a263 1
dmg: pkg $(PACKAGE_NAME)-$(VERSION).dmg
d266 1
a266 1
rpm: $(PACKAGE)-$(VERSION).rpm $(PACKAGE)-$(VERSION).src.rpm
d269 1
a269 1
deb: $(PACKAGE)-$(VERSION).deb
d272 1
a272 1
zip: $(PACKAGE)-$(VERSION).bin.zip
d275 1
a275 1
tgz: $(PACKAGE)-$(VERSION).bin.tar.gz
d278 1
a278 1
bz2: $(PACKAGE)-$(VERSION).bin.tar.bz2
d281 1
a281 1
tar: $(PACKAGE)-$(VERSION).bin.tar
@


14.49
log
@remove the MAINTAINERCLEAN rules, they're never really used regardless of the debate over whether the Makefile.in files belong there or not
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.48 2007/05/26 14:28:49 brlcad Exp $
d301 13
a313 2
	rm -f $(distdir)/include/brlcad_config.h
	rm -rf `find $(distdir) -type d -name CVS`
@


14.48
log
@delegate benchmark rules down to the bench dir so they're only in one place (and so files aren't generated in the top-level), mirroring what regress does.  inform the user when benchmark completes about the clobber rule.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.47 2007/05/20 19:31:11 brlcad Exp $
a113 2
MAINTAINERCLEANFILES = Makefile.in

@


14.47
log
@even more specific, to be sure we only delete benchmark files by iterating over each test.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.46 2007/05/19 02:27:56 brlcad Exp $
d245 1
a245 7
	@@$(ECHO) "About to wipe out all pictures and binary files in this directory"
	@@$(ECHO) "Send SIGINT (type ^C) within 5 seconds to abort"
	@@sleep 5
	@@for i in moss world star bldg391 m35 sphflake ; do \
		echo rm -f $$i.log $$i.pix $$i.log.[0-9]* $$i.pix.[0-9]* ;\
		rm -f $$i.log $$i.pix $$i.log.[0-9]* $$i.pix.[0-9]* ;\
	done
d248 1
a248 1
	${SH} $(top_srcdir)/bench/run.sh
@


14.46
log
@be even more specific on clobber file patterns
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.45 2007/05/19 01:45:40 brlcad Exp $
d248 4
a251 2
	rm -f *.log.[0-9]* *.pix.[0-9]*	# old versions
	rm -f *.log *.pix	# last try
@


14.45
log
@tick tock, 5 secs, boom.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.44 2007/05/19 01:44:23 brlcad Exp $
d248 1
a248 1
	rm -f *.log.* *.pix.*	# old versions
@


14.44
log
@the benchmark itself needs to know how to clean up after itself, but go ahead and add the same support for 'make clobber' to delete the plethora of log and pixfiles generated after a run
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.43 2007/04/19 21:38:46 erikgreenwald Exp $
d246 2
a247 2
	@@$(ECHO) "Send SIGINT (type ^C) within 3 seconds to abort"
	@@sleep 3
@


14.43
log
@include/conf/DATE is generated, so in builddir
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.42 2007/04/18 03:25:48 brlcad Exp $
d242 8
a249 1
.PHONY : benchmark bench regression regress test pkg dmg rpm deb zip tgz tbz
@


14.42
log
@elapsed wants the build date.  this is now stored in include/conf/DATE.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.41 2007/04/17 18:46:24 erikgreenwald Exp $
d402 1
a402 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/conf/DATE` ;\
d410 1
a410 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/conf/DATE` ;\
d426 1
a426 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/conf/DATE` ;\
@


14.41
log
@the brlcad_version.h builddirr/srcdir issue shows up on a couple other lines, too.
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.40 2007/04/17 18:43:00 erikgreenwald Exp $
d402 1
a402 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/brlcad_version.h | grep Compilation` ;\
d410 1
a410 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/brlcad_version.h | grep Compilation` ;\
d426 1
a426 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_srcdir)/include/brlcad_version.h | grep Compilation` ;\
@


14.40
log
@brlcad_version.h is in srcdir, not builddir
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.39 2007/01/27 01:41:28 brlcad Exp $
d410 1
a410 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/brlcad_version.h | grep Compilation` ;\
d426 1
a426 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/brlcad_version.h | grep Compilation` ;\
@


14.39
log
@ws. lots and lots of ws.  see sh/ws.sh for details (cases 'abcdeg').
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.38 2007/01/20 14:10:40 brlcad Exp $
d402 1
a402 1
	  sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/brlcad_version.h | grep Compilation` ;\
@


14.38
log
@update copyright to 2007
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.37 2006/08/31 05:54:16 lbutler Exp $
d338 1
a338 1
	  	$(ECHO) "    find $(DESTDIR)$(bindir)/. -type d -exec chmod go+x {} \;" ; \
d343 1
a343 1
	  	$(ECHO) "    find $(DESTDIR)$(sbindir)/. -type d -exec chmod go+x {} \;" ; \
d348 1
a348 1
	  	$(ECHO) "    find $(DESTDIR)$(libexecdir)/. -type d -exec chmod go+x {} \;" ; \
d353 1
a353 1
	   	$(ECHO) "    find $(DESTDIR)$(prefix)/. -type d -exec chmod go+x {} \;" ; \
d358 1
a358 1
	   	$(ECHO) "    find $(DESTDIR)$(libdir)/. -type d -exec chmod go+x {} \;" ; \
d363 1
a363 1
	   	$(ECHO) "    find $(DESTDIR)$(mandir)/. -type d -exec chmod go+x {} \;" ; \
d368 1
a368 1
	   	$(ECHO) "    find $(DESTDIR)$(includedir)/. -type d -exec chmod go+x {} \;" ; \
@


14.37
log
@added target for producing doxygen run
@
text
@d4 1
a4 1
# Copyright (c) 2005-2006 United States Government as represented by
d36 1
a36 1
# $Id: Makefile.am,v 14.36 2006/01/21 00:58:06 brlcad Exp $
@


14.36
log
@delete any CVS directories from our candidate distribution since we don't want to ship them
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.35 2006/01/18 06:46:09 brlcad Exp $
d252 3
@


14.35
log
@update copyright to 2006
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.34 2005/11/10 09:58:57 brlcad Exp $
a40 5
# this shouldn't be here, but rather in the include directory
# for some reason, putting it there doesn't work
dist-hook:
	rm -f $(distdir)/include/brlcad_config.h

d295 5
d431 1
@


14.34
log
@simplify the summary printing at the end, where a separation line comprised of asterisks is output with a length based on the dynamic length of the 'brl-cad is installed here' line.  the motivation for the change is due to the peculiar difference in the behavior of bsd make vs gnu make.  performing a mathematical expr that evaluates to zero (e.g. expr 3 - 3) causes expr to return a non-zero return value causing bsdmake to think something failed, even though we are in the middle of a special shell rule.  this 'failure' in turn halts a make install, although we are 'done' by this point anyways.  still, the error is annoying and using tr to generate the asterisks line is hopefully sufficiently portable, and it avoids the expr/bsdmakism regardless. may the bsd builds rejoice in unity.
@
text
@d4 1
a4 1
# Copyright (c) 2005 United States Government as represented by
d36 1
a36 1
# $Id: Makefile.am,v 14.33 2005/10/23 04:44:25 brlcad Exp $
@


14.33
log
@trailing ws
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.32 2005/09/16 18:28:19 brlcad Exp $
d416 2
a417 8
	  length="`$(ECHO) $(prefix)@@BRLCAD_VERSION@@ | wc -c`" ;\
	  length="`expr $$length + 34`" ;\
	  separator="" ;\
	  while test $$length -gt 0  ; do \
	    separator="$${separator}***" ;\
	    length="`expr $$length - 3`" ;\
          done ;\
	  $(ECHO) "$$separator" ;\
d420 1
a420 1
	  $(ECHO) "$$separator" ;\
@


14.32
log
@remove the test for $prefix/etc as we do not have/use one
@
text
@d14 1
a14 1
# 2. Redistributions in binary form must reproduce the above 
d36 1
a36 1
# $Id: Makefile.am,v 14.31 2005/08/24 20:37:01 lbutler Exp $
d286 1
a286 1
	@@$(ECHO) 
d289 1
a289 1
	@@$(ECHO) 
d298 1
a298 1
	@@$(ECHO) 
@


14.31
log
@Needed to make sure that brlcad_config.h didn't get stuffed into the dist
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.30 2005/07/16 19:48:01 brlcad Exp $
a352 5
	    if test -d "$(DESTDIR)$(sysconfdir)" ; then \
	      if test "x$(DESTDIR)$(prefix)/etc" != "x$(DESTDIR)$(sysconfdir)" ; then \
	   	$(ECHO) "    find $(DESTDIR)$(sysconfdir)/. -type d -exec chmod go+x {} \;" ; \
	      fi ; \
	    fi ; \
@


14.31.2.1
log
@merge changes from HEAD aka rel-7-6-4 to the rel-7-6-branch just in case someone peeks a gander or tries to continue/build the branch
@
text
@d14 1
a14 1
# 2. Redistributions in binary form must reproduce the above
d36 1
a36 1
# $Id$
d286 1
a286 1
	@@$(ECHO)
d289 1
a289 1
	@@$(ECHO)
d298 1
a298 1
	@@$(ECHO)
d353 5
d421 8
a428 2
	  separator="`$(ECHO) $$line1 | tr '[a-zA-Z0-9.\-/ ]' '*'`" ;\
	  $(ECHO) "$${separator}****" ;\
d431 1
a431 1
	  $(ECHO) "$${separator}****" ;\
@


14.30
log
@report a summary on make fast too
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.29 2005/07/06 23:05:13 brlcad Exp $
d41 5
@


14.29
log
@s/BRLCAD_DATA_DIR/BRLCAD_DATA/
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.28 2005/06/27 04:26:23 brlcad Exp $
d397 1
a397 1
	@@if test "x$(MAKECMDGOALS)" = "xall-am" -o "x$(.TARGETS)" = "xall-am" ; then \
@


14.29.2.1
log
@merge in changes through Aug10 for 7.4.2 release
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.30 2005/07/16 19:48:01 brlcad Exp $
d397 1
a397 1
	@@if test "x$(MAKECMDGOALS)" = "xall-am" -o "x$(.TARGETS)" = "xall-am" -o "x$(MAKECMDGOALS)" = "xfast" -o "x$(.TARGETS)" = "xfast" ; then \
@


14.28
log
@include the AUTHORS, COPYING, HACKING, INSTALL, NEWS, and README files as part of the installation for binary distributions
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.27 2005/06/25 15:55:57 brlcad Exp $
d86 1
a86 1
documentationdir = $(BRLCAD_DATA_DIR)
@


14.27
log
@add a header and footer to the main Makefile.am, bsd license of course
@
text
@d36 1
a36 1
# $Id: Makefile.am,v 14.26 2005/06/24 23:45:17 brlcad Exp $
d86 3
a88 1
EXTRA_DIST = \
a89 1
	BUGS \
a90 1
	ChangeLog \
d94 6
a99 1
	README \
@


14.26
log
@add Makefile.defs as an include
@
text
@d1 36
a36 1
# $Id: Makefile.am,v 14.25 2005/06/12 21:21:18 brlcad Exp $
d433 7
@


14.25
log
@put the date last on the install log line, makes reading/parsing a lil easier
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.24 2005/06/09 02:18:51 brlcad Exp $
d396 2
@


14.24
log
@remove noprod target until there is an include makefile
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.23 2005/06/07 23:38:37 brlcad Exp $
d340 1
a340 1
	    $(ECHO) "Installed BRL-CAD Release @@BRLCAD_VERSION@@ Build @@CONFIG_DATE@@ by ${USER} on `date` to $(DESTDIR)$(prefix)" >> install.$(host_triplet).log ; \
@


14.23
log
@add a noprod compilation target to remove the binaries and libraries
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.22 2005/04/13 22:25:34 brlcad Exp $
d202 1
a202 5
.PHONY : noprod benchmark bench regression regress test pkg dmg rpm deb zip tgz tbz

noprod:
	find $(top_builddir) -type d -execdir make clean-binPROGRAMS \;
	find $(top_builddir) -type d -execdir make clean-libLTLIBRARIES \;
@


14.22
log
@move brlcad.spec.in from the top level to misc/
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.21 2005/04/12 04:00:49 brlcad Exp $
d202 5
a206 1
.PHONY : benchmark bench regression regress test pkg dmg rpm deb zip tgz tbz
@


14.21
log
@add openUp as a dmg target dependency, automatically edit the ReadMe and Welcome rich text Installer documents to set their version automatically.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.20 2005/04/10 20:43:11 brlcad Exp $
a61 1
	brlcad.spec.in \
a66 1
	brlcad.spec \
d126 1
a126 1
	rpmbuild -ba $(PACKAGE).spec
d136 1
a136 1
	rpmbuild -ba $(PACKAGE).spec
@


14.20
log
@spell version right
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.19 2005/04/06 04:08:27 brlcad Exp $
d85 5
d107 6
d115 4
a118 1
$(PACKAGE_NAME)-$(VERSION).dmg: $(PACKAGE_NAME)-$(VERSION).pkg
@


14.19
log
@use top_srcdir so that the package scripts can be run when building from a different dir; fix make_dmg.sh, feed it a background image
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.18 2005/03/29 06:12:53 brlcad Exp $
d107 1
a107 1
	@@${SH} $(top_srcdir)/sh/make_dmg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERISION)" "$(top_srcdir)/misc/macosx/background.png"
@


14.18
log
@write out a detailed log entry on a make install to the install log file, record the release, user, date, and root
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.17 2005/03/29 04:44:35 brlcad Exp $
d102 1
a102 1
	@@${SH} sh/make_pkg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)" "misc/macosx/Resources"
d107 1
a107 1
	@@${SH} sh/make_dmg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERISION)" "$(PACKAGE_NAME)-$(MAJOR_VERISON).$(MINOR_VERSION).$(.PATCH_ERSION)"
d133 1
a133 1
	@@${SH} sh/make_deb.sh "$(PACKAGE_NAME)-$(VERSION)"
d149 1
a149 1
	@@${SH} sh/make_zip.sh "$(PACKAGE_NAME)-$(VERSION)"
d156 1
a156 1
	@@${SH} sh/make_tgz.sh "$(PACKAGE_NAME)-$(VERSION)"
d163 1
a163 1
	@@${SH} sh/make_bz2.sh "$(PACKAGE_NAME)-$(VERSION)"
d181 1
a181 1
	@@${SH} sh/make_tar.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)"
@


14.17
log
@simplify the instructions for running the tests
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.16 2005/03/29 04:41:31 brlcad Exp $
d322 8
a329 1
	@@touch install.$(host_triplet).log
@


14.16
log
@must cd and make at the same time
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.15 2005/03/29 04:15:45 brlcad Exp $
d352 1
a352 1
	  $(ECHO) "Run 'cd regress ; make regress' to run the BRL-CAD Test Suite" ;\
@


14.15
log
@add regression and test as regress synonyms, use the SH make variable instead of the automake variable, append a log suffix to the install log marker.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.14 2005/03/21 23:46:09 brlcad Exp $
d198 1
a198 2
	@@cd regress
	@@make regression
@


14.14
log
@make the install permissions warning find script work even when the install location is a symlink
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.13 2005/03/11 14:15:46 brlcad Exp $
d72 1
a72 1
	install.$(host_triplet) \
d86 1
a86 1
	@@if ! test -f "install.$(host_triplet)" ; then \
d102 1
a102 1
	@@@@SH@@ sh/make_pkg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)" "misc/macosx/Resources"
d107 1
a107 1
	@@@@SH@@ sh/make_dmg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERISION)" "$(PACKAGE_NAME)-$(MAJOR_VERISON).$(MINOR_VERSION).$(.PATCH_ERSION)"
d133 1
a133 1
	@@@@SH@@ sh/make_deb.sh "$(PACKAGE_NAME)-$(VERSION)"
d136 1
a136 1
	@@if ! test -f "install.$(host_triplet)" ; then \
d149 1
a149 1
	@@@@SH@@ sh/make_zip.sh "$(PACKAGE_NAME)-$(VERSION)"
d156 1
a156 1
	@@@@SH@@ sh/make_tgz.sh "$(PACKAGE_NAME)-$(VERSION)"
d163 1
a163 1
	@@@@SH@@ sh/make_bz2.sh "$(PACKAGE_NAME)-$(VERSION)"
d168 1
a168 1
	@@if ! test -f "install.$(host_triplet)" ; then \
d181 1
a181 1
	@@@@SH@@ sh/make_tar.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)"
d190 1
a190 1
.PHONY : benchmark bench pkg dmg rpm deb zip tgz tbz
d193 1
a193 1
	@@SH@@ $(top_srcdir)/bench/run.sh
d197 8
d323 1
a323 1
	touch install.$(host_triplet)
d353 1
a353 1
	  $(ECHO) "Run 'cd regress ; make regress' to run the BRL-CAD test Suite" ;\
@


14.13
log
@provide more arguments to the dmg script
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.12 2005/03/11 05:17:29 brlcad Exp $
d268 1
a268 1
	    $(ECHO) "    find $(DESTDIR)$(prefix) -type d -exec chmod go+x {} \;" ; \
d271 1
a271 1
	  	$(ECHO) "    find $(DESTDIR)$(bindir) -type d -exec chmod go+x {} \;" ; \
d276 1
a276 1
	  	$(ECHO) "    find $(DESTDIR)$(sbindir) -type d -exec chmod go+x {} \;" ; \
d281 1
a281 1
	  	$(ECHO) "    find $(DESTDIR)$(libexecdir) -type d -exec chmod go+x {} \;" ; \
d286 1
a286 1
	   	$(ECHO) "    find $(DESTDIR)$(prefix) -type d -exec chmod go+x {} \;" ; \
d291 1
a291 1
	   	$(ECHO) "    find $(DESTDIR)$(sysconfdir) -type d -exec chmod go+x {} \;" ; \
d296 1
a296 1
	   	$(ECHO) "    find $(DESTDIR)$(libdir) -type d -exec chmod go+x {} \;" ; \
d301 1
a301 1
	   	$(ECHO) "    find $(DESTDIR)$(mandir) -type d -exec chmod go+x {} \;" ; \
d306 1
a306 1
	   	$(ECHO) "    find $(DESTDIR)$(includedir) -type d -exec chmod go+x {} \;" ; \
@


14.12
log
@feed the script that resources dir
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.11 2005/03/01 07:41:25 brlcad Exp $
d107 1
a107 1
	@@@@SH@@ sh/make_dmg.sh "$(PACKAGE_NAME)-$(VERSION)"
@


14.11
log
@check for prefix and bindir initially for invalid permissions; create an install timestamp file that is used to warn the binary package makers if an install was never performed.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.10 2005/02/23 08:21:05 brlcad Exp $
d102 1
a102 1
	@@@@SH@@ sh/make_pkg.sh "$(PACKAGE_NAME)" "$(MAJOR_VERSION)" "$(MINOR_VERSION)" "$(PATCH_VERSION)" "$(DESTDIR)$(prefix)"
@


14.10
log
@add summary lines when the binary package target is built identifying the host triplet identifier
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.9 2005/02/23 06:24:28 brlcad Exp $
d72 1
d86 11
d104 1
a104 1
$(PACKAGE_NAME)-$(VERSION).dmg:
d136 11
d168 11
d243 1
d246 1
a246 1
	case `ls -ld $(DESTDIR)$(bindir)` in \
d251 7
d310 2
d314 2
a315 1
	fi
@


14.9
log
@quote the make_* script arguments so an empty string will still be passed at the right place
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.8 2005/02/22 08:11:10 brlcad Exp $
d127 2
d134 2
d141 2
d145 1
a145 1
	@@$(ECHO) "Building a uncompressed tape archive"
d148 2
@


14.8
log
@initial completed implementations of tgz, bz2, and tar targets
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.7 2005/02/19 16:08:11 brlcad Exp $
d90 1
a90 1
	@@@@SH@@ sh/make_pkg.sh $(PACKAGE_NAME) $(MAJOR_VERSION) $(MINOR_VERSION) $(PATCH_VERSION) $(DESTDIR)$(prefix)
d95 1
a95 1
	@@@@SH@@ sh/make_dmg.sh $(PACKAGE_NAME)-$(VERSION)
d121 1
a121 1
	@@@@SH@@ sh/make_deb.sh $(PACKAGE_NAME)-$(VERSION)
d126 1
a126 1
	@@@@SH@@ sh/make_zip.sh $(PACKAGE_NAME)-$(VERSION)
d131 1
a131 1
	@@@@SH@@ sh/make_tgz.sh $(PACKAGE_NAME)-$(VERSION)
d136 1
a136 1
	@@@@SH@@ sh/make_bz2.sh $(PACKAGE_NAME)-$(VERSION)
d141 1
a141 1
	@@@@SH@@ sh/make_tar.sh $(PACKAGE_NAME) $(MAJOR_VERSION) $(MINOR_VERSION) $(PATCH_VERSION) $(DESTDIR)$(prefix)
@


14.7
log
@make sure a dangerous umask will not prevent others from using an installed version by checking to make sure the exec mode is set.  output a warning and potential find rules that should repair the bad directory permissions
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.6 2005/02/17 23:11:31 lbutler Exp $
d95 1
a95 1
	@@@@SH@@ sh/make_dmg.sh $(PACKAGE_NAME)-$(VERSION) $(PACKAGE_NAME)-$(VERSION).pkg
d128 1
a128 1
 $(PACKAGE)-$(VERSION).bin.tar.gz:
d133 1
a133 1
 $(PACKAGE)-$(VERSION).bin.tar.bz2:
d141 1
a141 1
	@@@@SH@@ sh/make_tar.sh $(PACKAGE_NAME)-$(VERSION)
@


14.6
log
@added a reminder to run regress once the install is completed
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.5 2005/02/11 15:14:46 brlcad Exp $
d77 5
d143 4
a146 3
##############
# the rules  #
##############
d195 70
@


14.5
log
@generate a zip and bzip2 automatically when we make dist
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.4 2005/02/11 14:59:52 brlcad Exp $
d216 1
@


14.4
log
@traverse the m4 directory too; use ACLOCAL_AMFLAGS to include m4 dir
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.3 2005/01/31 06:36:19 brlcad Exp $
d3 1
a3 1
AUTOMAKE_OPTIONS = 1.6
@


14.3
log
@update the pkg target with the args that make_pkg.sh now requires
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.2 2005/01/30 04:41:44 brlcad Exp $
d4 1
d17 1
@


14.2
log
@swap @@ECHO@@ for $(ECHO).  add initial support for various package systems including pkg,dmg,rpm,deb,tar,tgz,tbz,&zip; package build rules tie into sh/make_*.sh scripts.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 14.1 2004/11/16 19:42:08 morrison Exp $
d83 1
a83 1
	@@@@SH@@ sh/make_pkg.sh $(PACKAGE_NAME)-$(VERSION)
@


14.1
log
@dawn of a new revision.  it shall be numbered 14 to match release 7.  begin the convergence by adding emacs/vi local variable footer blocks to encourage consistent formatting.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.24 2004/10/29 13:46:26 morrison Exp $
d75 1
d77 12
a88 3
##############
# the rules  #
##############
d91 3
a93 2
.PHONY : rpm
rpm: dist
d97 9
d107 28
d136 5
a140 1
packages: rpm
d147 39
d196 4
a199 4
	@@@@ECHO@@ "Done."
	@@@@ECHO@@
	@@@@ECHO@@ "BRL-CAD Release @@BRLCAD_VERSION@@, Build @@CONFIG_DATE@@"
	@@@@ECHO@@
d201 1
a201 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed compilation time: " ;\
d203 1
a203 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed time since configuration: " ;\
d205 3
a207 3
	  @@ECHO@@ "---" ;\
	  @@ECHO@@ "Run 'make install' to begin installation into $(prefix)" ;\
	  @@ECHO@@ "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
d209 1
a209 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed installation time: " ;\
d211 1
a211 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed time since configuration: " ;\
d213 3
a215 3
	  @@ECHO@@ "---" ;\
	  @@ECHO@@ "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
	  @@ECHO@@ ;\
d218 1
a218 1
	  length="`@@ECHO@@ $(prefix)@@BRLCAD_VERSION@@ | wc -c`" ;\
d225 4
a228 4
	  @@ECHO@@ "$$separator" ;\
	  @@ECHO@@ "$$line1" ;\
	  @@ECHO@@ "$$line2" ;\
	  @@ECHO@@ "$$separator" ;\
d230 1
a230 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed time: " ;\
d232 1
a232 1
	  @@ECHO@@ @@ECHO_N@@ "Elapsed time since configuration: " ;\
d234 2
a235 2
	  @@ECHO@@ "---" ;\
	  @@ECHO@@ "Run 'make benchmark' to run the BRL-CAD Benchmark Suite" ;\
d237 1
a237 1
	@@@@ECHO@@
@


11.24
log
@require automake 1.6
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.23 2004/10/15 19:53:41 butler Exp $
@


11.23
log
@added entries for the "regress" directory.
@
text
@d1 3
a3 1
# $Id: Makefile.am,v 11.22 2004/10/14 20:42:34 morrison Exp $
@


11.22
log
@make distclean doesn't want to remove the autom4te.cache dir because it's a dir and not a file after all.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.21 2004/10/07 14:52:48 morrison Exp $
d15 1
@


11.21
log
@dang superfluous tests.  add support for bsd make targets (assumes a single target).
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.20 2004/10/07 03:48:14 morrison Exp $
a62 1
	autom4te.cache \
@


11.20
log
@woohoo, even better.. no need to sed/cut/awk at all since we're feeding to expr anyways! (painfully obvious in hindsight)
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.19 2004/10/07 00:46:25 morrison Exp $
d107 1
a107 1
	@@if test "x$(MAKECMDGOALS)" = "xall-am" ; then \
d115 1
a115 1
	elif test "x$(MAKECMDGOALS)" = "xinstall-am" ; then \
d136 1
a136 1
	elif test "x$(MAKECMDGOALS)" = "x" ; then \
@


11.19
log
@work around the awk print 16965963 problem on some plats by using sed and cut instead
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.18 2004/10/06 14:31:03 morrison Exp $
d125 1
a125 1
	  length="`@@ECHO@@ $(prefix)@@BRLCAD_VERSION@@ | wc | sed 's/[ 	]*/ /g' | cut -f 4 -d ' '`" ;\
d127 4
a130 4
	  len=$$length ;\
	  while test $$len -gt 0  ; do \
	    @@ECHO@@ -n "***" ;\
	    len="`expr $$len - 3`" ;\
d132 1
a132 1
	  @@ECHO@@ ;\
d135 1
a135 5
	  while [ $$length -gt 0 ] ; do \
	    @@ECHO@@ @@ECHO_N@@ "***" ;\
	    length="`expr $$length - 3`" ;\
          done ;\
	  @@ECHO@@ ;\
@


11.18
log
@Major restructuring and fixes so that 'make distcheck' should now work and actually be close to correct.  i.e. the resultant generated tarball should contain contents similar to a CVS export.  This helps it generate a proper distribution and build, install, and uninstall cleanly off of that distribution.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.17 2004/09/24 14:51:28 morrison Exp $
d125 1
a125 1
	  length="`@@ECHO@@ $(prefix)@@BRLCAD_VERSION@@ | wc | awk '{print $$3}'`" ;\
@


11.17
log
@help make distcheck get a whole lot farther ..
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.16 2004/09/05 06:48:41 morrison Exp $
a61 1
	Makefile.in \
d68 4
a71 1
	libtool
@


11.16
log
@print out an even more informative summary.  in addition, customize the output based on the make target type so things like make install don't tell users to run make install generically.  make install outputs a nifty box for emphasis reminding about setting one's path.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.15 2004/07/27 20:46:52 morrison Exp $
d60 2
a61 2
MAINTAINERCLEANFILES = \
	@@CONFIG_CACHE@@ \
@


11.15
log
@report the release number in the build summary.  could be useful in a build log.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.14 2004/07/27 20:30:58 morrison Exp $
d91 9
d105 41
a145 7
	@@@@ECHO@@ @@ECHO_N@@ "Elapsed compilation time: "
	@@sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/brlcad_version.h | grep Compilation`
	@@@@ECHO@@ @@ECHO_N@@ "Elapsed time since configuration: "
	@@sh $(top_srcdir)/sh/elapsed.sh @@CONFIG_TIME@@
	@@@@ECHO@@ "---"
	@@@@ECHO@@ "Run 'make install' to begin installation into $(prefix)"
	@@@@ECHO@@ "Run 'make benchmark' to run the BRL-CAD Benchmark Suite"
@


11.14
log
@er, the build_date.h header was renamed to brlcad_version.h
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.13 2004/07/25 10:19:54 morrison Exp $
d92 1
d94 1
a94 1
	@@@@ECHO@@ "Done."
@


11.13
log
@our irix box is giving an incorrect echo_c, so remove it for now
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.12 2004/07/25 08:17:19 morrison Exp $
d96 1
a96 1
	@@sh $(top_srcdir)/sh/elapsed.sh `cat $(top_builddir)/include/build_date.h | grep Compilation`
@


11.12
log
@make the build work with the irix mipspro compiler.  output elapsed build times via sh/elapsed.sh script
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.11 2004/06/22 17:39:42 morrison Exp $
d95 1
a95 1
	@@@@ECHO@@ @@ECHO_N@@ "Elapsed compilation time: @@ECHO_C@@"
d97 1
a97 1
	@@@@ECHO@@ @@ECHO_N@@ "Elapsed time since configuration: @@ECHO_C@@"
@


11.11
log
@use the autoconf shell facility defines
@
text
@d1 1
a1 1
# $Id$
d57 2
a58 2
	$(PACKAGE).spec.in \
	ltconfig
d61 1
a65 1
	config.guess \
a67 1
	config.sub \
d69 1
a69 6
	depcomp \
	install-sh \
	libtool \
	ltmain.sh \
	missing \
	mkinstalldirs
d87 1
a87 1
	@@SH@@ $(srcdir)/bench/run.sh
d90 13
@


11.10
log
@reworked for the new source layout
@
text
@d85 1
a85 1
	cp $(PACKAGE)-$(VERSION).tar.gz ${HOME}/rpm/SOURCES/
d87 2
a88 2
	cp ${HOME}/rpm/RPMS/i386/$(PACKAGE)-$(VERSION)-*.i386.rpm .
	cp ${HOME}/rpm/SRPMS/$(PACKAGE)-$(VERSION)-*.src.rpm .
d93 1
a93 1
	sh $(srcdir)/bench/run.sh
@


11.9
log
@clean up the inclusion logic for building with only benchmark and/or only librtserver, and make building all work again too.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.8 2004/05/12 17:21:30 morrison Exp $
d3 5
a7 13
required_files = \
	h \
	libtcl8.4 \
	libbn \
	libbu \
	librt

bench_files = \
	libpkg \
	libfb \
	libwdb \
	liboptical \
	libsysv \
a8 1
	conv \
d10 1
a10 4
	fbserv \
	rt	

rts_files = librtserver
d12 1
a12 26
kitchensink_files = \
	libpng \
	libtk8.4 \
	libitcl \
	iwidgets4.0.1 \
	libz \
	libcursor \
	libdm \
	libpkg \
	libfb \
	libfft \
	liborle \
	librtserver \
	libtclcad \
	libtermio \
	libutahrle \
	libwdb \
	anim \
	awf \
	bench \
	brlman \
	burst \
	bwish \
	comgeom-g \
	conv \
	db \
d14 2
a15 34
	fb \
	fbed \
	fbserv \
	gtools \
	halftone \
	html \
	iges \
	irprep \
	jack \
	lgt \
	mged \
	mk \
	nirt \
	off \
	patch \
	pro-engineer \
	remrt \
	rt \
	sample_applications \
	sh \
	sig \
	tab \
	tclscripts \
	tools \
	unigraphics \
	util \
	vas4 \
	vdeck \
	vfont


#######################
# put it all together #
#######################
a17 8

if ONLY_RTS
SUBDIRS = \
	$(required_files) \
	$(bench_files) \
	$(rts_files)

else !ONLY_RTS
d19 2
a20 5
	$(required_files) \
	$(bench_files)

endif
# end ONLY_RTS
d26 1
a26 2
	$(required_files) \
	$(rts_files)
d30 3
a32 4
	$(required_files) \
	$(bench_files) \
	$(rts_files) \
	$(kitchensink_files)
d35 1
a35 1
# end ONLY_RTS
d38 1
a38 1
# end ONLY_BENCHMARK
d41 4
a44 3
####################
# dist maintenance #
####################
d46 13
a58 3
DIST_SUBDIRS = $(SUBDIRS)

EXTRA_DIST = $(PACKAGE).spec.in
a60 2
	COPYING \
	INSTALL \
d82 1
@


11.8
log
@added make benchmark to run the benchmark after a build
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.7 2004/05/12 04:26:29 morrison Exp $
a9 1
if ONLY_BENCHMARK
d14 1
a20 3
else
bench_files =
endif
a21 1
if ONLY_RTS
a22 12
else
rts_files = 
endif

if ONLY_BENCHMARK
kitchensink_files =

else
# else !ONLY_BENCHMARK

if ONLY_RTS
kitchensink_files =
a23 2
else
# else !ONLY_RTS
a34 1
	liboptical \
d80 19
d102 1
a102 2
endif
# end ONLY_BENCHMARK
d104 4
d109 1
d116 10
d149 5
@


11.7
log
@add initial benchmark-only build support
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.6 2004/05/11 12:17:12 morrison Exp $
d145 4
@


11.6
log
@ChangeLog is gone
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.5 2004/05/07 19:32:26 erikg Exp $
d3 1
a3 2
if ONLYRTS
SUBDIRS = \
d8 32
a39 2
	librt \
	librtserver
d41 2
a42 2
SUBDIRS = \
	h \
a43 1
	libtcl8.4 \
a47 2
	libbn \
	libbu \
a54 1
	librt \
a55 1
	libsysv \
d100 12
@


11.5
log
@an --enable-only-rts argument that limits the build to muves3 required
stuff (namely librtserver and everything it depends on...)
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 11.4 2004/04/06 18:46:07 morrison Exp $
d79 1
a79 1
EXTRA_DIST = ChangeLog $(PACKAGE).spec.in
@


11.4
log
@ws
@
text
@d1 1
a1 1
# $Id$
d3 9
d75 1
@


11.3
log
@begin the start of getting make dist to work -- added DIST_SUBDIRS and MAINTAINERCLEANFILES
@
text
@d35 1
a35 1
        db \
d70 1
a70 1
 
@


11.2
log
@build libtclcad
@
text
@d3 62
a64 62
SUBDIRS=\
	h\
	libpng\
	libtcl8.4\
	libtk8.4\
	libitcl\
	iwidgets4.0.1\
	libz\
	libbn\
	libbu\
	libcursor\
	libdm\
	libpkg\
	libfb\
	libfft\
	liboptical\
	liborle\
	librt\
	librtserver\
	libsysv\
	libtclcad\
	libtermio\
	libutahrle\
	libwdb\
	anim\
	awf\
	bench\
	brlman\
	burst\
	bwish\
	comgeom-g\
	conv\
        db\
	doc\
	fb\
	fbed\
	fbserv\
	gtools\
	halftone\
	html\
	iges\
	irprep\
	jack\
	lgt\
	mged\
	mk\
	nirt\
	off\
	patch\
	pro-engineer\
	remrt\
	rt\
	sample_applications\
	sh\
	sig\
	tab\
	tclscripts\
	tools\
	unigraphics\
	util\
	vas4\
	vdeck\
d67 3
a69 1
EXTRA_DIST=ChangeLog $(PACKAGE).spec.in
d71 19
@


11.1
log
@merge of AUTOCONF branch in to HEAD
@
text
@d23 1
@


1.1
log
@file Makefile.am was initially added on branch AUTOCONF.
@
text
@d1 76
@


1.1.2.1
log
@automake files
@
text
@a0 27
# $Id$
SUBDIRS=@@TCL@@ @@TK@@ @@ITCL@@\
	h\
	libbn\
	libbu\
	libdm\
	libfb\
	libfft\
	liboptical\
	liborle\
	libpkg\
	librt\
	libsysv\
	libtermio\
	libutahrle\
	libwdb\
	anim\
	bwish\
	fb\
	mged\
	rt\
	sh\
	sig\
	tclscripts\
	util\
	html\
	doc
@


1.1.2.2
log
@starting merged autoconf of libtcl84
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.1 2003/10/08 16:57:34 erikg Exp $
a3 1
	libtcl8.4\
@


1.1.2.3
log
@muchos autoconf fixes, libtcl and libtk are now built with the rest of the
system, instead of trying to use the pre-installed versions
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.2 2003/11/14 19:30:18 erikg Exp $
a4 1
	libtk8.4\
@


1.1.2.4
log
@fill.
added id tags where needed
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.3 2003/12/02 19:33:51 erikg Exp $
a19 2
	brlman\
	burst\
a20 1
	conv\
a21 2
	gtools\
	irprep\
a26 1
	tools\
@


1.1.2.5
log
@adding more automake stuff
removed some files that are now generated
@
text
@d1 2
a2 3
# $Id: Makefile.am,v 1.1.2.4 2003/12/04 16:00:11 erikg Exp $

SUBDIRS=\
a5 2
	libitcl3.2\
	iwidgets4.0.1\
a7 1
	libcursor\
a24 2
	fbed\
	fbserv\
@


1.1.2.6
log
@iwidgets and libz
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.5 2003/12/04 19:19:51 erikg Exp $
a8 1
	libz\
@


1.1.2.7
log
@bee ess dee five point one
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.6 2003/12/05 18:41:42 erikg Exp $
a9 1
	libpng\
@


1.1.2.8
log
@build dependancy ordering
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.7 2003/12/08 21:10:04 erikg Exp $
a14 1
	libpkg\
d19 1
@


1.1.2.9
log
@added vfont
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.8 2003/12/10 18:34:54 erikg Exp $
a4 1
	libpng\
d10 1
d15 1
a19 1
	libpkg\
a29 1
	doc\
a33 1
	html\
d42 2
a43 1
	vfont
@


1.1.2.10
log
@dependancy ordering
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.9 2003/12/15 20:01:33 erikg Exp $
a14 1
	libpkg\
d19 1
@


1.1.2.11
log
@cleanup/consolidation
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.10 2003/12/15 20:36:11 erikg Exp $
a36 1
	lgt\
a37 1
	nirt\
@


1.1.2.12
log
@normalization
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.11 2003/12/23 16:13:40 erikg Exp $
a25 1
	bench\
a28 1
	comgeom-g\
a34 1
	halftone\
a35 1
	iges\
a36 2
	jack\
	jove\
a38 1
	mk\
a39 4
	off\
	patch\
	pro-engineer\
	remrt\
a40 1
	sample_applications\
a42 1
	tab\
a45 2
	vas4\
	vdeck\
@


1.1.2.13
log
@more normalization
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.12 2003/12/23 21:30:40 erikg Exp $
a25 1
	awf\
a57 1
	unigraphics\
@


1.1.2.14
log
@beginnings of RPM fu.
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.13 2003/12/24 19:19:26 erikg Exp $
a63 12

EXTRA_DIST=ChangeLog $(PACKAGE).spec.in
 
.PHONY : rpm
rpm: dist
	cp $(PACKAGE)-$(VERSION).tar.gz /usr/src/redhat/SOURCES/
	rpm -ba $(PACKAGE).spec
	cp /usr/src/redhat/RPMS/i386/$(PACKAGE)-$(VERSION)-*.i386.rpm .
	cp /usr/src/redhat/SRPMS/$(PACKAGE)-$(VERSION)-*.src.rpm .
 
packages: rpm

@


1.1.2.15
log
@rpm fix
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.14 2003/12/31 18:37:14 erikg Exp $
d69 5
a73 5
	cp $(PACKAGE)-$(VERSION).tar.gz ${HOME}/rpm/SOURCES/
	rpmbuild -ba $(PACKAGE).spec
	cp ${HOME}/rpm/RPMS/i386/$(PACKAGE)-$(VERSION)-*.i386.rpm .
	cp ${HOME}/rpm/SRPMS/$(PACKAGE)-$(VERSION)-*.src.rpm .

@


1.1.2.16
log
@removing jove from the build cycle
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.15 2004/01/07 18:17:41 erikg Exp $
d43 1
@


1.1.2.17
log
@librtserver added to build system
@
text
@d1 1
a1 1
# $Id: Makefile.am,v 1.1.2.16 2004/01/07 21:05:12 erikg Exp $
a20 1
	librtserver\
@


1.1.2.18
log
@shift of libitcl3.2 -> libitcl
@
text
@d1 1
a1 1
# $Id$
d8 1
a8 1
	libitcl\
@


1.1.2.19
log
@build g files, include db dir and asc files in dist...
@
text
@a33 1
        db\
@


