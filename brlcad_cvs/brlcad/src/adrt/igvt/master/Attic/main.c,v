head	1.7;
access;
symbols;
locks; strict;
comment	@ * @;


1.7
date	2005.07.10.03.58.18;	author twingy;	state dead;
branches;
next	1.6;

1.6
date	2005.07.10.03.48.10;	author twingy;	state Exp;
branches;
next	1.5;

1.5
date	2005.07.06.21.31.54;	author twingy;	state Exp;
branches;
next	1.4;

1.4
date	2005.07.01.21.07.53;	author twingy;	state Exp;
branches;
next	1.3;

1.3
date	2005.07.01.15.13.01;	author twingy;	state Exp;
branches;
next	1.2;

1.2
date	2005.06.17.21.40.52;	author erikgreenwald;	state Exp;
branches;
next	1.1;

1.1
date	2005.06.17.15.09.24;	author lbutler;	state Exp;
branches;
next	;


desc
@@


1.7
log
@IGVT->ISST 90%
@
text
@/*
 * $Id: main.c,v 1.6 2005/07/10 03:48:10 twingy Exp $
 */

#ifdef HAVE_CONFIG_H
# include "brlcad_config.h"
#endif

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <unistd.h>
#include "ivat.h"
#include "master.h"
#include "tienet.h"


#ifdef HAVE_GETOPT_H
# include <getopt.h>
#endif

#ifdef HAVE_GETOPT_LONG
static struct option longopts[] =
{
	{ "exec",	required_argument,	NULL, 'e' },
	{ "help",	no_argument,		NULL, 'h' },
	{ "comp_host",	required_argument,	NULL, 'c' },
	{ "obs_port",	required_argument,	NULL, 'o' },
	{ "port",	required_argument,	NULL, 'p' },
	{ "version",	no_argument,		NULL, 'v' },
  	{ "list",	required_argument,	NULL, 'l' },
};
#endif

static char shortopts[] = "c:e:i:ho:p:vl:";


static void finish(int sig) {
  printf("Collected signal %d, aborting!\n", sig);
  exit(EXIT_FAILURE);
}


static void help() {
  printf("%s\n", IVAT_VER_DETAIL);
  printf("%s\n", "usage: ivat_master [options] [proj_env_file]\n\
  -h\t\tdisplay help.\n\
  -c\t\tconnect to component server.\n\
  -e\t\tscript to execute that starts slaves.\n\
  -l\t\tfile containing list of slaves to use as compute nodes.\n\
  -o\t\tset observer port number.\n\
  -p\t\tset master port number.\n\
  -v\t\tdisplay version info.\n");
}


int main(int argc, char **argv) {
  int port = 0, obs_port = 0, c = 0;
  char proj[64], exec[64], list[64], temp[64], comp_host[64];


  signal(SIGINT, finish);

  if(argc == 1) {
    help();
    return EXIT_FAILURE;
  }

  /* Initialize strings */
  list[0] = 0;
  exec[0] = 0;
  proj[0] = 0;
  comp_host[0] = 0;
  port = TN_MASTER_PORT;
  obs_port = IVAT_OBSERVER_PORT;

  /* Parse command line options */

  while((c = 
#ifdef HAVE_GETOPT_LONG
	getopt_long(argc, argv, shortopts, longopts, NULL)
#else
	getopt(argc, argv, shortopts)
#endif
	)!= -1)
  {
	  switch(c) {
            case 'c':
              strncpy(comp_host, optarg, 64);
              break;

            case 'h':
              help();
              return EXIT_SUCCESS;

            case 'o':
              obs_port = atoi(optarg);
              break;

            case 'p':
              port = atoi(optarg);
              break;

            case 'l':
              strncpy(list, optarg, 64);
              break;

            case 'e':
              strncpy(exec, optarg, 64);
              break;

            case 'v':
              printf("%s\n", IVAT_VER_DETAIL);
              return EXIT_SUCCESS;

            default:
              help();
              return EXIT_FAILURE;
	  }
  }
  argc -= optind;
  argv += optind;

  strcpy(proj, argv[0]);

  if(proj[0]) {
    ivat_master(port, obs_port, proj, list, exec, comp_host);
  } else {
    help();
    return EXIT_FAILURE;
  }

  return EXIT_SUCCESS;
}
@


1.6
log
@75% done IGVT -> IVAT conversion.
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.5 2005/07/06 21:31:54 twingy Exp $
@


1.5
log
@adding support to communicate with a component server, i.e fuzzy fault tree viewer.
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.4 2005/07/01 21:07:53 twingy Exp $
d14 1
a14 1
#include "igvt.h"
d46 2
a47 2
  printf("%s\n", IGVT_VER_DETAIL);
  printf("%s\n", "usage: igvt_master [options] [proj_env_file]\n\
d76 1
a76 1
  obs_port = IGVT_OBSERVER_PORT;
d114 1
a114 1
              printf("%s\n", IGVT_VER_DETAIL);
d128 1
a128 1
    igvt_master(port, obs_port, proj, list, exec, comp_host);
@


1.4
log
@Moved the g loader int adrt to a converter in brl-cad.  The converter creates
all the necessary files that adrt needs to use geometry.  Going to fix unpack
next so the program is usable again.
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.3 2005/07/01 15:13:01 twingy Exp $
d28 1
a28 1
	{ "interval",	required_argument,	NULL, 'i' },
d36 1
a36 1
static char shortopts[] = "e:i:ho:p:vl:";
d49 4
a53 4
  -o\t\tset observer port number.\n\
  -i\t\tinterval in minutes between each autosave.\n\
  -l\t\tfile containing list of slaves to use as compute nodes.\n\
  -e\t\tscript to execute that starts slaves.\n\
d59 2
a60 2
  int port = 0, obs_port = 0, c = 0, interval = 1;
  char proj[64], exec[64], list[64], temp[64];
d74 1
d89 31
a119 27
		  case 'h':
			  help();
			  return EXIT_SUCCESS;
		  case 'o':
			  obs_port = atoi(optarg);
			  break;
		  case 'p':
			  port = atoi(optarg);
			  break;
		  case 'i':
			  strncpy(temp, optarg, 4);
			  interval = atoi(temp);
			  if(interval < 0) interval = 0;
			  if(interval > 60) interval = 60;
			  break;
		  case 'l':
			  strncpy(list, optarg, 64);
			  break;
		  case 'e':
			  strncpy(exec, optarg, 64);
			  break;
		  case 'v':
			  printf("%s\n", IGVT_VER_DETAIL);
			  return EXIT_SUCCESS;
		default:
			  help();
			  return EXIT_FAILURE;
d128 1
a128 1
    igvt_master(port, obs_port, proj, list, exec, interval);
@


1.3
log
@The project directory now has a single project file that lists the file names
for properties, textures, frames, geometry, and geometry arguments.  The
application no longer requires the -g and -a options.  IGVT has been updated
to reflect these changes, RISE is next.
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.2 2005/06/17 21:40:52 erikgreenwald Exp $
d29 2
a30 2
	{ "obs_port",	required_argument,	NULL, 'O' },
	{ "port",	required_argument,	NULL, 'P' },
a32 1
  	{ "proj",	required_argument,	NULL, 'p' },
d36 1
a36 1
static char shortopts[] = "e:a:g:i:hO:P:vl:p:";
d47 8
a54 9
  printf("%s\n", "usage: igvt_master [options]\n\
  -v\t\tdisplay version\n\
  -h\t\tdisplay help\n\
  -P\t\tport number\n\
  -O\t\tobserver port number\n\
  -e ...\tfile to execute that starts slaves\n\
  -i ...\tinterval in minutes between each autosave dump\n\
  -l ...\tfile containing list of slave hostnames to distribute work to\n\
  -p ...\tproject file\n");
d88 4
a91 1
		  case 'O':
d94 1
a94 1
		  case 'P':
a96 3
		  case 'e':
			  strncpy(exec, optarg, 64);
			  break;
d106 2
a107 2
		  case 'p':
			  strncpy(proj, optarg, 64);
a108 3
		  case 'h':
			  help();
			  return EXIT_SUCCESS;
d120 2
@


1.2
log
@use brlcad_config.h instead of config.h
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.1 2005/06/17 15:09:24 lbutler Exp $
a26 2
	{ "geom",	required_argument,	NULL, 'g' },
	{ "args",	required_argument,	NULL, 'a' },
d56 1
a56 3
  -p ...\tproject directory\n\
  -g ...\tlocation of geometry file\n\
  -a ...\targuments to geometry file\n");
d62 1
a62 1
  char proj[64], exec[64], list[64], temp[64], geom[64], args[64];
a75 2
  geom[0] = 0;
  args[0] = 0;
a95 3
		  case 'a':
			  strncpy(args, optarg, 64);
			  break;
a98 3
		  case 'g':
			  strncpy(geom, optarg, 64);
			  break;
d126 1
a126 5
    if(!geom[0]) {
      printf("must supply additional argument: -g /path/to/geometry/file\n");
      return EXIT_FAILURE;
    }
    igvt_master(port, obs_port, proj, geom, args, list, exec, interval);
@


1.1
log
@Welcome ADRT
@
text
@d2 1
a2 1
 * $Id: main.c,v 1.6 2005/06/15 22:03:12 justin Exp $
d6 1
a6 1
# include "config.h"
@

