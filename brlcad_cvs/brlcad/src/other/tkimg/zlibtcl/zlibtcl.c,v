head	1.2;
access;
symbols
	rel-7-10-4:1.2
	STABLE:1.2.0.4
	rel-7-10-2:1.2
	rel-7-10-0:1.2
	rel-7-8-4:1.2
	rel-7-8-2:1.2
	rel-7-8-0:1.2
	trimnurbs-branch:1.2.0.2
	help:1.2
	temp_tag:1.2
	bobWinPort-20051223-freeze:1.1.2.4
	postmerge-20051223-bobWinPort:1.2
	bobWinPort:1.1.0.2;
locks; strict;
comment	@ * @;


1.2
date	2005.12.23.21.26.45;	author bob1961;	state Exp;
branches;
next	1.1;

1.1
date	2005.09.21.13.09.33;	author bob1961;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2005.09.21.13.09.33;	author bob1961;	state Exp;
branches;
next	1.1.2.2;

1.1.2.2
date	2005.09.26.12.18.03;	author bob1961;	state Exp;
branches;
next	1.1.2.3;

1.1.2.3
date	2005.09.26.12.36.28;	author bob1961;	state Exp;
branches;
next	1.1.2.4;

1.1.2.4
date	2005.11.17.17.32.05;	author bob1961;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Merge of bobWinPort
@
text
@/*
 * zlibtcl.c --
 *
 *  Generic interface to XML parsers.
 *
 * Copyright (c) 2002 Andreas Kupries <andreas_kupries@@users.sourceforge.net>
 *
 * Zveno Pty Ltd makes this software and associated documentation
 * available free of charge for any purpose.  You may make copies
 * of the software but you must include all of this notice on any copy.
 *
 * Zveno Pty Ltd does not warrant that this software is error free
 * or fit for any purpose.  Zveno Pty Ltd disclaims any liability for
 * all claims, expenses, losses, damages and costs any user may incur
 * as a result of using, copying or modifying the software.
 *
 * $Id: zlibtcl.c,v 1.1.2.4 2005/11/17 17:32:05 bob1961 Exp $
 *
 */

#include "zlibtcl.h"

#define TCL_DOES_STUBS \
    (TCL_MAJOR_VERSION > 8 || TCL_MAJOR_VERSION == 8 && (TCL_MINOR_VERSION > 1 || \
    (TCL_MINOR_VERSION == 1 && TCL_RELEASE_LEVEL == TCL_FINAL_RELEASE)))

/*
 * Prototypes for procedures defined later in this file:
 */

/*
 *----------------------------------------------------------------------------
 *
 * Z_Init --
 *
 *  Initialisation routine for loadable module
 *
 * Results:
 *  None.
 *
 * Side effects:
 *  Creates commands in the interpreter,
 *  loads xml package.
 *
 *----------------------------------------------------------------------------
 */

int
#ifdef _DEBUG
Z_d_Init (interp)
#else
Z_Init (interp)
#endif
      Tcl_Interp *interp; /* Interpreter to initialise. */
{
#if TCL_DOES_STUBS
  extern ZlibtclStubs zlibtclStubs;
#endif

#if 0
#ifdef USE_TCL_STUBS
  if (Tcl_InitStubs(interp, "8.1", 0) == NULL) {
    return TCL_ERROR;
  }
#endif
#endif

#if TCL_DOES_STUBS
  if (Tcl_PkgProvideEx(interp, ZLIBTCL_PACKAGE_NAME, ZLIBTCL_VERSION,
		       (ClientData) &zlibtclStubs) != TCL_OK) {
    return TCL_ERROR;
  }
#else
  if (Tcl_PkgProvide(interp, ZLIBTCL_PACKAGE_NAME, ZLIBTCL_VERSION) != TCL_OK) {
    return TCL_ERROR;
  }
#endif

  return TCL_OK;
}

/*
 *----------------------------------------------------------------------------
 *
 * Z_SafeInit --
 *
 *  Initialisation routine for loadable module in a safe interpreter.
 *
 * Results:
 *  None.
 *
 * Side effects:
 *  Creates commands in the interpreter,
 *  loads xml package.
 *
 *----------------------------------------------------------------------------
 */

int
#ifdef _DEBUG
Z_d_SafeInit (interp)
#else
Z_SafeInit (interp)
#endif
      Tcl_Interp *interp; /* Interpreter to initialise. */
{
#ifdef _DEBUG
    return Z_d_Init(interp);
#else
    return Z_Init(interp);
#endif
}

/*
 *----------------------------------------------------------------------------
 *
 * Z_XXX --
 *
 *  Wrappers around the zlib functionality.
 *
 * Results:
 *  Depends on function.
 *
 * Side effects:
 *  Depends on function.
 *
 *----------------------------------------------------------------------------
 */

/*
 * No wrappers are required. Due to intelligent definition of the stub
 * table using the function names of the libz sources the stub table
 * contains jumps to the actual functionality.
 */
@


1.1
log
@file zlibtcl.c was initially added on branch bobWinPort.
@
text
@d1 134
@


1.1.2.1
log
@Initial check-in
@
text
@a0 156
/*
 * zlibtcl.c --
 *
 *  Generic interface to XML parsers.
 *
 * Copyright (c) 2002 Andreas Kupries <andreas_kupries@@users.sourceforge.net>
 *
 * Zveno Pty Ltd makes this software and associated documentation
 * available free of charge for any purpose.  You may make copies
 * of the software but you must include all of this notice on any copy.
 *
 * Zveno Pty Ltd does not warrant that this software is error free
 * or fit for any purpose.  Zveno Pty Ltd disclaims any liability for
 * all claims, expenses, losses, damages and costs any user may incur
 * as a result of using, copying or modifying the software.
 *
 * $Id: zlibtcl.c,v 1.1.2.1 2005/09/13 17:47:40 bob1961 Exp $
 *
 */

#include "zlibtcl.h"

#define TCL_DOES_STUBS \
    (TCL_MAJOR_VERSION > 8 || TCL_MAJOR_VERSION == 8 && (TCL_MINOR_VERSION > 1 || \
    (TCL_MINOR_VERSION == 1 && TCL_RELEASE_LEVEL == TCL_FINAL_RELEASE)))

/*
 * Declarations for externally visible functions.
 */

#undef TCL_STORAGE_CLASS
#ifdef BUILD_zlibtcl
# define TCL_STORAGE_CLASS DLLEXPORT
#else
# ifdef USE_ZLIBTCL_STUBS
#  define TCL_STORAGE_CLASS
# else
#  define TCL_STORAGE_CLASS DLLIMPORT
# endif
#endif

#ifdef _DEBUG
EXTERN int Z_d_Init     _ANSI_ARGS_((Tcl_Interp *interp));
EXTERN int Z_d_SafeInit _ANSI_ARGS_((Tcl_Interp *interp));
#else
EXTERN int Z_Init     _ANSI_ARGS_((Tcl_Interp *interp));
EXTERN int Z_SafeInit _ANSI_ARGS_((Tcl_Interp *interp));
#endif

#undef  TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLIMPORT

/*
 * Prototypes for procedures defined later in this file:
 */

/*
 *----------------------------------------------------------------------------
 *
 * Z_Init --
 *
 *  Initialisation routine for loadable module
 *
 * Results:
 *  None.
 *
 * Side effects:
 *  Creates commands in the interpreter,
 *  loads xml package.
 *
 *----------------------------------------------------------------------------
 */

int
#ifdef _DEBUG
Z_d_Init (interp)
#else
Z_Init (interp)
#endif
      Tcl_Interp *interp; /* Interpreter to initialise. */
{
#if TCL_DOES_STUBS
  extern ZlibtclStubs zlibtclStubs;
#endif

#if 0
#ifdef USE_TCL_STUBS
  if (Tcl_InitStubs(interp, "8.1", 0) == NULL) {
    return TCL_ERROR;
  }
#endif
#endif

#if TCL_DOES_STUBS
  if (Tcl_PkgProvideEx(interp, PACKAGE_NAME, ZLIBTCL_VERSION,
		       (ClientData) &zlibtclStubs) != TCL_OK) {
    return TCL_ERROR;
  }
#else
  if (Tcl_PkgProvide(interp, PACKAGE_NAME, ZLIBTCL_VERSION) != TCL_OK) {
    return TCL_ERROR;
  }
#endif

  return TCL_OK;
}

/*
 *----------------------------------------------------------------------------
 *
 * Z_SafeInit --
 *
 *  Initialisation routine for loadable module in a safe interpreter.
 *
 * Results:
 *  None.
 *
 * Side effects:
 *  Creates commands in the interpreter,
 *  loads xml package.
 *
 *----------------------------------------------------------------------------
 */

int
#ifdef _DEBUG
Z_d_SafeInit (interp)
#else
Z_SafeInit (interp)
#endif
      Tcl_Interp *interp; /* Interpreter to initialise. */
{
    return Z_Init(interp);
}

/*
 *----------------------------------------------------------------------------
 *
 * Z_XXX --
 *
 *  Wrappers around the zlib functionality.
 *
 * Results:
 *  Depends on function.
 *
 * Side effects:
 *  Depends on function.
 *
 *----------------------------------------------------------------------------
 */

/*
 * No wrappers are required. Due to intelligent definition of the stub
 * table using the function names of the libz sources the stub table
 * contains jumps to the actual functionality.
 */
@


1.1.2.2
log
@Get zlibtcl's package name from ZLIBTCL_PACKAGE_NAME
@
text
@d17 1
a17 1
 * $Id: zlibtcl.c,v 1.1.2.1 2005/09/21 13:09:33 bob1961 Exp $
a26 1
#if 1
a51 1
#endif
d95 1
a95 1
  if (Tcl_PkgProvideEx(interp, ZLIBTCL_PACKAGE_NAME, ZLIBTCL_VERSION,
d100 1
a100 1
  if (Tcl_PkgProvide(interp, ZLIBTCL_PACKAGE_NAME, ZLIBTCL_VERSION) != TCL_OK) {
@


1.1.2.3
log
@Not exporting Z_Init
@
text
@d17 1
a17 1
 * $Id: zlibtcl.c,v 1.1.2.2 2005/09/26 12:18:03 bob1961 Exp $
d27 28
@


1.1.2.4
log
@Added seperate init routine for debug mode
@
text
@d17 1
a17 1
 * $Id: zlibtcl.c,v 1.1.2.3 2005/09/26 12:36:28 bob1961 Exp $
a106 3
#ifdef _DEBUG
    return Z_d_Init(interp);
#else
a107 1
#endif
@


