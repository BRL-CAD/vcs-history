head	14.1;
access;
symbols
	rel-7-10-4:14.1
	STABLE:14.1.0.10
	stable-branch:14.1
	rel-7-10-2:14.1
	rel-7-10-0:14.1
	rel-7-8-4:14.1
	rel-7-8-2:14.1
	rel-7-8-0:14.1
	trimnurbs-branch:14.1.0.8
	help:14.1
	temp_tag:14.1
	bobWinPort-20051223-freeze:14.1
	postmerge-20051223-bobWinPort:14.1
	premerge-20051223-bobWinPort:14.1
	rel-7-6-6:14.1
	rel-7-6-4:14.1
	rel-7-6-2:14.1
	rel-7-6-branch:14.1.0.6
	rel-7-6-0:14.1
	rel-7-4-2:14.1
	rel-7-4-branch:14.1.0.4
	bobWinPort:14.1.0.2
	rel-7-4-0:14.1
	rel-7-2-6:14.1
	rel-7-2-4:14.1
	rel-7-2-2:14.1
	rel-7-2-0:14.1
	rel-7-0-4:14.1
	rel-7-0-2:14.1
	rel-7-0-1:14.1
	opensource-post:14.1
	opensource-pre:1.1
	rel-7-0-branch:1.1.0.2
	rel-7-0:1.1;
locks; strict;
comment	@# @;


14.1
date	2004.11.16.19.42.15;	author morrison;	state Exp;
branches;
next	1.1;

1.1
date	2004.05.20.15.19.45;	author morrison;	state Exp;
branches;
next	;


desc
@@


14.1
log
@dawn of a new revision.  it shall be numbered 14 to match release 7.  begin the convergence by adding emacs/vi local variable footer blocks to encourage consistent formatting.
@
text
@|sgiselect( fd, r, w, time)
|{
|	static int exosfd;
|
|	if( exosfd == 0 )  {
|		exosfd = open( "/dev/EXOS/admin", 2 );
|		if( exosfd < 0 )  {
|			exosfd = 0;
|			return(-1);
|		}
|	}
|	ioctl( ?? );
|}
	.data
	.text
	.globl	_sgiselect
_sgiselect:
	linkw	a6,#-56
	tstl	exosfd
	bnes	isopen
	pea	0x2:w
	pea	.L17
	jsr	_open
	addql	#8,a7
	movl	d0,exosfd
	cmpl	#0xFFFFFFFF,d0
	bnes	isopen
	clrl	exosfd
	moveq	#-1,d0
	bras	out
isopen:
	movl	a6@@(8),a6@@(-24)		| fd
	movl	a6@@(12),d0
	movl	d0,a6@@(-16)		| r
	movl	a6@@(16),d0
	movl	d0,a6@@(-20)		| w
	movl	a6@@(20),a6@@(-12)	| time
	lea	a6@@(-4),a0
	movl	a0,d0
	movl	d0,a6@@(-8)
	pea	a6@@(-56)
	pea	0x3B:w
	movl	exosfd,a7@@-
	jsr	_ioctl
	addw	#0xC,a7
	movl	a6@@(-4),d0
out:
	unlk	a6
	rts

	.data
exosfd:
	.long	0x0
.L17:
	.ascii	"/dev/EXOS/admin"
	.byte	0x0

@


1.1
log
@Vast reorganization begins.  Sources moved from top-level directories into src/.
@
text
@@

