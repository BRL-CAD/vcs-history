head	11.18;
access;
symbols
	ansi-20040405-merged:11.15.2.2
	postmerge-20040405-ansi:11.17
	premerge-20040404-ansi:11.16
	postmerge-autoconf:11.16
	autoconf-freeze:11.15.10.1
	premerge-autoconf:11.16
	postmerge-20040315-windows:11.16
	premerge-20040315-windows:11.15
	windows-20040315-freeze:11.15.4.1
	autoconf-20031203:11.15
	autoconf-20031202:11.15
	autoconf-branch:11.15.0.10
	phong-branch:11.15.0.8
	photonmap-branch:11.15.0.6
	rel-6-1-DP:11.15
	windows-branch:11.15.0.4
	rel-6-0-2:11.13
	ansi-branch:11.15.0.2
	rel-6-0-1-branch:11.13.0.2
	hartley-6-0-post:11.14
	hartley-6-0-pre:11.13
	rel-6-0-1:11.13
	rel-6-0:11.12
	rel-5-4:11.9
	offsite-5-3-pre:11.9
	rel-5-3:11.9
	rel-5-2:11.9
	rel-5-1-branch:11.9.0.2
	rel-5-1:11.9
	rel-5-0:11.6
	rel-5-0-beta:11.6
	rel-4-5:11.5
	ctj-4-5-post:11.1
	ctj-4-5-pre:11.1
	rel-4-4:11.1
	rel-4-0:10.1;
locks; strict;
comment	@ * @;


11.18
date	2004.05.21.17.47.08;	author morrison;	state dead;
branches;
next	11.17;

11.17
date	2004.04.05.07.39.41;	author morrison;	state Exp;
branches;
next	11.16;

11.16
date	2004.03.16.21.24.36;	author morrison;	state Exp;
branches;
next	11.15;

11.15
date	2002.08.20.17.08.30;	author jra;	state Exp;
branches
	11.15.2.1
	11.15.4.1
	11.15.10.1;
next	11.14;

11.14
date	2002.08.15.20.55.44;	author hartley;	state Exp;
branches;
next	11.13;

11.13
date	2002.05.08.13.55.38;	author jra;	state Exp;
branches;
next	11.12;

11.12
date	2002.02.20.21.06.21;	author butler;	state Exp;
branches;
next	11.11;

11.11
date	2002.02.19.21.42.39;	author butler;	state Exp;
branches;
next	11.10;

11.10
date	2001.08.09.19.58.22;	author jra;	state Exp;
branches;
next	11.9;

11.9
date	2000.05.22.15.50.48;	author pjt;	state Exp;
branches;
next	11.8;

11.8
date	99.11.10.14.17.18;	author pjt;	state Exp;
branches;
next	11.7;

11.7
date	99.11.08.20.27.05;	author pjt;	state Exp;
branches;
next	11.6;

11.6
date	99.03.29.17.17.58;	author pjt;	state Exp;
branches;
next	11.5;

11.5
date	97.12.11.19.09.33;	author pjt;	state Exp;
branches;
next	11.4;

11.4
date	97.12.08.18.55.55;	author pjt;	state Exp;
branches;
next	11.3;

11.3
date	97.12.05.20.56.49;	author pjt;	state Exp;
branches;
next	11.2;

11.2
date	97.12.04.18.54.52;	author pjt;	state Exp;
branches;
next	11.1;

11.1
date	95.01.04.10.22.18;	author mike;	state Rel4_4;
branches;
next	10.4;

10.4
date	94.12.12.22.15.37;	author mike;	state Exp;
branches;
next	10.3;

10.3
date	94.08.24.14.06.33;	author gdurf;	state Exp;
branches;
next	10.2;

10.2
date	94.04.05.10.47.37;	author pjt;	state Exp;
branches;
next	10.1;

10.1
date	91.10.12.06.53.33;	author mike;	state Rel4_0;
branches;
next	1.10;

1.10
date	91.07.30.11.05.30;	author pjt;	state Exp;
branches;
next	1.9;

1.9
date	91.07.24.11.19.57;	author pjt;	state Exp;
branches;
next	1.8;

1.8
date	91.07.19.01.52.33;	author mike;	state Exp;
branches;
next	1.7;

1.7
date	91.07.18.14.46.50;	author pjt;	state Exp;
branches;
next	1.6;

1.6
date	91.06.18.12.31.19;	author pjt;	state Exp;
branches;
next	1.5;

1.5
date	91.02.21.16.10.56;	author mike;	state Exp;
branches;
next	1.4;

1.4
date	91.02.14.09.37.46;	author pjt;	state Exp;
branches;
next	1.3;

1.3
date	91.02.14.09.29.43;	author pjt;	state Exp;
branches;
next	1.2;

1.2
date	91.02.14.09.03.25;	author pjt;	state Exp;
branches;
next	1.1;

1.1
date	91.02.11.09.55.59;	author pjt;	state Exp;
branches;
next	;

11.15.2.1
date	2002.09.19.18.02.10;	author morrison;	state Exp;
branches;
next	11.15.2.2;

11.15.2.2
date	2004.03.17.21.22.08;	author morrison;	state Exp;
branches;
next	;

11.15.4.1
date	2002.09.26.23.04.14;	author morrison;	state Exp;
branches;
next	;

11.15.10.1
date	2004.03.18.18.10.31;	author erikg;	state Exp;
branches;
next	;


desc
@@


11.18
log
@moved to src/nirt/
@
text
@/*      NIRT.H          */

/* Needed for some struct definitions */
#include "./usrfmt.h"

/*	CONSTANTS	*/
#define	VAR_NULL	((struct VarTable *) 0) 
#define	CT_NULL		((com_table *) 0)
#define	SILENT_UNSET	0
#define	SILENT_YES	1
#define	SILENT_NO	-1
#define	NIRT_PROMPT	"nirt>  "
#define	TITLE_LEN	80 
#if !defined(PI)
#define	PI		3.141592654
#endif
#define	BACKOUT_DIST	1000.0
#define	OFF		0
#define	ON		1
#define	YES		1
#define	NO		0
#define	HIT		1     /* HIT the target  */
#define	MISS		0     /* MISS the target */
#define	END		2
#define	HORZ		0
#define	VERT		1
#define	DIST		2
#define	POS		1   
#define	NEG		0
#define	AIR		1
#define	NO_AIR		0
#define	READING_FILE	1
#define	READING_STRING	2
#define	deg2rad		0.01745329

/*	FLAG VALUES FOR overlap_claims	*/
#define	OVLP_RESOLVE		0
#define	OVLP_REBUILD_FASTGEN	1
#define	OVLP_REBUILD_ALL	2
#define	OVLP_RETAIN		3

/*	FLAG VALUES FOR nirt_debug	*/
#define	DEBUG_INTERACT	0x001
#define	DEBUG_SCRIPTS	0x002
#define	DEBUG_MAT	0x004
#define	DEBUG_BACKOUT	0x008
#define	DEBUG_HITS	0x010
#ifdef	DEBUG_FORMAT
#   define RT_DEBUG_FMT	DEBUG_FORMAT
#endif
#define DEBUG_FMT	"\020\5HITS\4BACKOUT\3MAT\2SCRIPTS\1INTERACT"

/*	STRING FOR USE WITH GETOPT(3)	*/
#define	OPT_STRING      "A:bB:Ee:f:MO:su:vx:X:?"

#define	made_it()	bu_log("Made it to %s:%d\n", __FILE__, __LINE__)

/*	MACROS WITH ARGUMENTS	*/
#ifndef WIN32
/* already defined */
#define	max(a,b)	(((a)>(b))?(a):(b))
#define	min(a,b)	(((a)<(b))?(a):(b))
#endif
#if !defined(abs)
# define	abs(a)	((a)>=0 ? (a):(-a))
#endif
#define	com_usage(c)	fprintf (stderr, "Usage:  %s %s\n", \
				c -> com_name, c -> com_args);

/*	DATA STRUCTURES		*/
typedef struct {
	char	*com_name;		/* for invoking	    	         */
	void	(*com_func)();          /* what to do?      	         */
	char	*com_desc;		/* Help description 	         */
	char	*com_args;		/* Command arguments for usage   */
} com_table; 

struct VarTable 
{
	double	azimuth;
	double	elevation;
	vect_t  direct;
	vect_t  target;
	vect_t  grid;
};

typedef struct attributes {
    int	attrib_use;
    int	attrib_cnt;
    char **attrib;
} attr_table;

extern attr_table a_tab;

extern struct rt_i	*rtip;
extern void		attrib_add(char *a);
extern void 		attrib_print(void);
extern void 		attrib_flush(void);
extern void		az_el();
extern void		dir_vect();
extern void	        grid_coor();
extern void		interact(int input_source, void *sPtr);
extern void	        target_coor();
extern void	        backout();
extern void		shoot();
extern void		sh_esc();
extern void	        quit();
extern void		show_menu();
extern void		format_output(char *buffer, com_table *ctp);
extern void		direct_output(char *buffer, com_table *ctp);
extern void		nirt_units();
extern void		do_overlap_claims();
extern void		use_air();
extern void		state_file(char *buffer, com_table *ctp);
extern void		dump_state(char *buffer, com_table *ctp);
extern void		load_state(char *buffer, com_table *ctp);
extern void		default_ospec(void);
extern void		print_item(char *buffer, com_table *ctp);
extern com_table	*get_comtab_ent(char *pattern, int pat_len);
extern void		read_mat(void);
extern void		ae2dir(void);
extern void		grid2targ(void);
extern void		targ2grid(void);
extern void		dir2ae(void);
extern void		set_diameter(struct rt_i *rtip);
extern void		report(int outcom_type);
extern int		check_conv_spec(outitem *oip);
extern void             do_rt_gettrees(struct rt_i *rtip, char **object_name, int nm_objects);
extern void		bot_minpieces();
extern int		need_prep;
@


11.17
log
@merge of ansi-6-0-branch into HEAD
@
text
@@


11.16
log
@merge of windows-6-0-branch into head
@
text
@d3 3
d102 1
a102 1
extern void		interact();
d109 2
a110 2
extern void		format_output();
extern void		direct_output();
d114 15
a128 15
extern void		state_file();
extern void		dump_state();
extern void		load_state();
extern void		default_ospec();
extern void		print_item();
extern com_table	*get_comtab_ent();
extern void		read_mat();
extern void		ae2dir();
extern void		grid2targ();
extern void		targ2grid();
extern void		dir2ae();
extern void		set_diameter();
extern void		report();
extern int		check_conv_spec();
extern void             do_rt_gettrees();
@


11.15
log
@Restoration of entire source tree to Pre-Hartley state
@
text
@d56 2
d60 1
@


11.15.10.1
log
@merge from head
@
text
@a55 2
#ifndef WIN32
/* already defined */
a57 1
#endif
@


11.15.4.1
log
@Modifications (on a 6.0 source distribution) for initial port to windows (merged with sources close to 6.0.2)
@
text
@a55 2
#ifndef WIN32
/* already defined */
a57 1
#endif
@


11.15.2.1
log
@Initial ANSIfication
@
text
@a2 3
/* Needed for some struct definitions */
#include "./usrfmt.h"

d96 1
a96 1
extern void		interact(int input_source, void *sPtr);
d103 2
a104 2
extern void		format_output(char *buffer, com_table *ctp);
extern void		direct_output(char *buffer, com_table *ctp);
d108 15
a122 15
extern void		state_file(char *buffer, com_table *ctp);
extern void		dump_state(char *buffer, com_table *ctp);
extern void		load_state(char *buffer, com_table *ctp);
extern void		default_ospec(void);
extern void		print_item(char *buffer, com_table *ctp);
extern com_table	*get_comtab_ent(char *pattern, int pat_len);
extern void		read_mat(void);
extern void		ae2dir(void);
extern void		grid2targ(void);
extern void		targ2grid(void);
extern void		dir2ae(void);
extern void		set_diameter(struct rt_i *rtip);
extern void		report(int outcom_type);
extern int		check_conv_spec(outitem *oip);
extern void             do_rt_gettrees(struct rt_i *rtip, char **object_name, int nm_objects);
@


11.15.2.2
log
@sync branch with HEAD
@
text
@a58 2
#ifndef WIN32
/* already defined */
a60 1
#endif
@


11.14
log
@Converted from K&R to ANSI C - RFH
@
text
@a2 3
/* Needed for some struct definitions */
#include "./usrfmt.h"

d96 1
a96 1
extern void		interact(int input_source, void *sPtr);
d103 2
a104 2
extern void		format_output(char *buffer, com_table *ctp);
extern void		direct_output(char *buffer, com_table *ctp);
d108 15
a122 15
extern void		state_file(char *buffer, com_table *ctp);
extern void		dump_state(char *buffer, com_table *ctp);
extern void		load_state(char *buffer, com_table *ctp);
extern void		default_ospec(void);
extern void		print_item(char *buffer, com_table *ctp);
extern com_table	*get_comtab_ent(char *pattern, int pat_len);
extern void		read_mat(void);
extern void		ae2dir(void);
extern void		grid2targ(void);
extern void		targ2grid(void);
extern void		dir2ae(void);
extern void		set_diameter(struct rt_i *rtip);
extern void		report(int outcom_type);
extern int		check_conv_spec(outitem *oip);
extern void             do_rt_gettrees(struct rt_i *rtip, char **object_name, int nm_objects);
@


11.13
log
@Added support for rt_bot_minpieces
@
text
@d3 3
d99 1
a99 1
extern void		interact();
d106 2
a107 2
extern void		format_output();
extern void		direct_output();
d111 15
a125 15
extern void		state_file();
extern void		dump_state();
extern void		load_state();
extern void		default_ospec();
extern void		print_item();
extern com_table	*get_comtab_ent();
extern void		read_mat();
extern void		ae2dir();
extern void		grid2targ();
extern void		targ2grid();
extern void		dir2ae();
extern void		set_diameter();
extern void		report();
extern int		check_conv_spec();
extern void             do_rt_gettrees();
@


11.12
log
@A nicer implementation that uses the string format for the "attributes" value
@
text
@d51 1
a51 1
#define	OPT_STRING      "A:bEe:f:MO:su:vx:X:?"
d123 1
@


11.11
log
@Added support for printing attributes
@
text
@d81 9
a89 4
extern struct rt_i		*rtip;
extern int		attrib_use;
extern int		attrib_cnt;
extern char		**attrib;
d122 2
a123 2
extern void                   do_rt_gettrees();
extern int need_prep;
@


11.10
log
@lint
@
text
@d51 1
a51 1
#define	OPT_STRING      "bEe:f:MO:su:vx:X:?"
d81 7
d117 2
@


11.9
log
@Added support for overlap claimants
@
text
@d102 8
@


11.8
log
@In order to silence the compile warnings,
no longer redefine DEBUG_FORMAT (defined by ../librt/debug.h).
Instead, pass RT_DEBUG_FMT for libdebug, and DEBUG_FMT for debug.
@
text
@d33 6
d51 1
a51 1
#define	OPT_STRING      "bEe:f:Msu:vx:X:?"
d94 1
@


11.7
log
@1. Added 'debug' command
2. Added DEBUG_HITS flag
@
text
@d39 4
a42 2
#define RT_DEBUG_FORMAT	DEBUG_FORMAT
#define DEBUG_FORMAT	"\020\5HITS\4BACKOUT\3MAT\2SCRIPTS\1INTERACT"
@


11.6
log
@Replaced separate calls of rt_gettree() for each object
with a single call of rt_gettrees() for all objects.
This runs faster and allows elimination of struct nirt_obj
@
text
@d38 3
@


11.5
log
@1. Implemented the -E option
2. Added the DEBUG_SCRIPTS flag
@
text
@a69 6
struct nirt_obj
{
    char		*obj_name;
    struct nirt_obj	*obj_next;
};

@


11.4
log
@1. Got rid of some sytactic sugar, like AND and OR macros, and
   some unused #defines
2. Implemented the -e option
@
text
@d35 3
a37 2
#define	DEBUG_MAT	0x002
#define	DEBUG_BACKOUT	0x004
d40 1
a40 1
#define	OPT_STRING      "be:f:Msu:vx:X:?"
d79 1
@


11.3
log
@1. Fixed backout().  It now fires a backing-out ray
2. Added -X option for nirt's own diagnostics
3. Added -f sfile option
@
text
@d4 7
a10 9
#define    VAR_NULL     ((struct VarTable *) 0) 
#define    CT_NULL	((com_table *) 0)
#define    SILENT_UNSET	0
#define    SILENT_YES	1
#define    SILENT_NO	-1
#define    NIRT_PROMPT   "nirt>  "
#define    EVER         ;;              /* syntactic sugar       */
#define    TITLE_LEN    80 
#define    MAX_RAND     2147483647      /* maximum random number */ 
d12 1
a12 1
#define    PI           3.141592654
d14 18
a31 23
#define    BACKOUT_DIST	1000.0
#define    OFF          0
#define    ON		1
#define    YES          1
#define    NO           0
#define    HIT          1     /* HIT the target  */
#define    MISS         0     /* MISS the target */
#define    END          2
#define    HORZ         0
#define    VERT         1
#define    DIST         2
#define    AND          &&
#define    OR           ||
#define    POS		1   
#define    NEG		0
#define		AIR	1
#define		NO_AIR	0
#define    deg2rad      0.01745329
#if	(defined(sgi) && defined(mips) && !defined(SGI4D_Rel2))
#define    RAND_NUM     (double)rand()/MAX_RAND  /* 0 < number < 1 */
#else
#define    RAND_NUM     (double)random()/MAX_RAND  /* 0 < number < 1 */
#endif
d34 3
a36 2
#define	DEBUG_MAT	0x001
#define	DEBUG_BACKOUT	0x002
d39 3
a41 1
#define         OPT_STRING      "bf:Msu:vx:X:?"
d44 2
a45 2
#define    max(a,b)             (((a)>(b))?(a):(b))
#define    min(a,b)             (((a)<(b))?(a):(b))
d47 1
a47 1
# define    abs(a)               ((a)>=0 ? (a):(-a))
d49 2
a50 2
#define    com_usage(c)         fprintf (stderr, "Usage:  %s %s\n", \
				    c -> com_name, c -> com_args);
@


11.2
log
@Implemented -b option
@
text
@d16 1
d40 4
d45 1
a45 1
#define         OPT_STRING      "bMsu:vx:?"
@


11.1
log
@Release_4.4
@
text
@d40 1
a40 1
#define         OPT_STRING      "Msu:vx:?"
@


10.4
log
@Linux has PI in <math.h>
@
text
@@


10.3
log
@Removed superfluous includes
@
text
@d13 1
d15 1
@


10.2
log
@implemented -v command-line option and enhanced silent_flag
@
text
@a2 3
#include   <machine.h>
#include   <vmath.h>

@


10.1
log
@Release_4.0
@
text
@d9 3
d41 1
a41 1
#define         OPT_STRING      "Msu:x:?"
@


1.10
log
@removed definition of getmem()
@
text
@@


1.9
log
@Implemented short (non-verbose) mode
@
text
@a45 1
#define    getmem(S)            (S*)malloc(sizeof(S))
@


1.8
log
@abs() is defined already on IBM.
@
text
@d38 1
a38 1
#define         OPT_STRING      "Mu:x:?"
@


1.7
log
@Added the backout command
@
text
@d43 3
a45 1
#define    abs(a)               ((a)>=0 ? (a):(-a))
@


1.6
log
@Added 'M' to OPT_STRING for getopt(3)
@
text
@d75 1
@


1.5
log
@Added -x option
@
text
@d38 1
a38 1
#define         OPT_STRING      "u:x:?"
@


1.4
log
@Apparently can't have char RCSid[] in the header files because
they get redeclared.
@
text
@d38 1
a38 1
#define         OPT_STRING      "u:?"
@


1.3
log
@Attempt to add $Header$ to file.
@
text
@a1 3
#ifndef lint
static char RCSid[] = "$Header$";
#endif
@


1.2
log
@Added definition of struct nirt_obj.  See revision 1.2 of nirt.c
for details.
@
text
@d2 3
@


1.1
log
@Initial revision
@
text
@d37 1
a37 1
/*	STRINGS FOR USE WITH GETOPT(3)	*/
a38 1
#define         USAGE_LINE      "Usage: 'nirt [options] model.g objects...'\n"
d63 6
@
